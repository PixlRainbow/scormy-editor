
/* Smart HTML Elements v4.6.0 (2019-Oct) 
Copyright (c) 2011-2019 jQWidgets. 
License: https://htmlelements.com/license/ */

Smart.Utilities.Assign("Grid.Export",class{exportData(a){const b=this,c=new Smart.Utilities.DataExporter({exportHeader:b.dataExport.header});if(c.expandChar=b.dataExport.expandChar,c.collapseChar=b.dataExport.collapseChar,c.pageOrientation=b.dataExport.pageOrientation,c.style=b.dataExport.style,c.filterBy=b.dataExport.filterBy,c.groupBy=b.dataExport.groupBy,c.header={columns:b.columns.toArray().slice(0),columngroups:b.columnGroups.slice(0)},!b.dataExport.style){const d=window.getComputedStyle(b),e=window.getComputedStyle(0<b.columns.length&&b.columns[0].element?b.columns[0].element:b.$.columnHeader),f=window.getComputedStyle(b.$.columnHeader),g=0===b.offsetWidth||0===b.offsetHeight;if(!g){const g=a=>{function b(a){return a=a.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),a?"#"+c(a[1])+c(a[2])+c(a[3]).toUpperCase():"#ffffff"}function c(a){return isNaN(a)?"00":h[(a-a%16)/16]+h[a%16]}const d=a.fontSize,e=a.borderRightColor,f=a.backgroundColor,g=a.color,h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return{borderColor:b(e),fontSize:d,fontFamily:"Helvetica",color:b(g),backgroundColor:b(f)}},h=g(d),i=g(e),j=g(f),k={height:b.$.columnHeader.offsetHeight+"px",border:"1px solid "+h.borderColor,fontFamily:j.fontFamily,fontSize:j.fontSize,color:j.color,backgroundColor:i.backgroundColor,fontWeight:"400"},l={border:"1px solid "+h.borderColor,fontFamily:h.fontFamily,fontSize:h.fontSize},m={height:b.rowMinHeight+"px"};for(let c=0;c<b.columns.length;c++){const d=b.columns[c];if(!d.allowExport)continue;if(!d.visible)continue;k[d.dataField]={textAlign:d.align,width:d.computedWidth+"px",format:d.cellsFormat||""};let e=d.cellsFormat||"";"date"===d.dataType?e="d":"dateTime"===d.dataType?e="D":"time"===d.dataType&&(e="t");const f={textAlign:d.cellsAlign,format:e};if(l[d.dataField]=f,b.dataExport.view&&-1!==["html","jpeg","pdf","png"].indexOf(a)&&(d.template||d.formatFunction))for(let a=0;a<b.rows.length;a++){const c=b.rows[a]["column_"+d.dataField];if(!c)continue;const e={};e.border=c.borderColor,e.background=c.background,e.color=c.color,f[a]=e}}0<b.appearance.alternationCount&&(m.alternationCount=b.appearance.alternationCount,m.alternationStart=b.appearance.alternationStart,m.alternationEnd=b.appearance.alternationEnd,m.alternationIndex0Color=h.color,m.alternationIndex0BackgroundColor=h.backgroundColor,m.alternationIndex1Color=h.color,m.alternationIndex1BackgroundColor="#F5F5F5"),c.style={border:"1px solid "+h.borderColor,borderCollapse:"collapse",header:k,columns:l,rows:m}}}const d=!b.rowHierarchy||b.grouping.enabled?b.rows.toArray():b.rowHierarchy;let e=[];if(b.dataExport.view)b._recyclingRows.forEach(a=>e.push(a.data));else{for(let a=0;a<d.length;a++){const b=d[a];b.visible&&(!1!==b.filtered||void 0===b.filtered)&&e.push(b.data)}d===b.rowHierarchy&&(e=b.dataSource.boundHierarchy,c.hierarchical=!0)}!b.dataExport.groupBy&&b.grouping.enabled&&b.dataSource&&b.dataSource.groupBy&&(c.groupBy=b.dataSource.groupBy&&b.dataSource.groupBy.toArray?b.dataSource.groupBy.toArray():null),b.checkLicense(!0),c.exportData(e,a,b.dataExport.fileName)}});