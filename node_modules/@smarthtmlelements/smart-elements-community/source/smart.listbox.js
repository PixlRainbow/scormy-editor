
/* Smart HTML Elements v4.6.0 (2019-Oct) 
Copyright (c) 2011-2019 jQWidgets. 
License: https://htmlelements.com/license/ */

Smart("smart-list-item",class extends Smart.ContentElement{static get properties(){return{alternationIndex:{value:-1,type:"int"},color:{value:"",type:"string"},displayMode:{allowedValues:["plain","checkBox","radioButton"],value:"plain",type:"string"},grouped:{value:!1,type:"boolean"},selected:{value:!1,type:"boolean"},value:{value:"",type:"string"},label:{value:"",type:"string"},details:{value:"",type:"string"},group:{value:"",type:"string"},hidden:{value:!1,type:"boolean"},readonly:{value:!1,type:"boolean"}}}get hasStyleObserver(){return!1}get enableShadowDOM(){return!1}get _focused(){const e=this;return void 0===e.__focused&&(e.__focused=!1),e.__focused}set _focused(e){const t=this;t.__focused=e,e?t.setAttribute("focus",""):t.removeAttribute("focus")}template(){return`<div id="container">
                   <span id='itemInput' class ='smart-input smart-hidden'></span>
                    <span class ="smart-overlay" id="overlay"></span>
                    <div id="itemContainer" class ="smart-content smart-list-item-container"><span class="smart-content-label" inner-h-t-m-l=\'[[innerHTML]]\'><content></content></span><span inner-h-t-m-l=\'[[details]]\' id="details" class="smart-content-details"></span></div>
                </div>`}appendChild(e){const t=this;if(!t.isCompleted||e.classList.contains("smart-ripple")){const e=Array.prototype.slice.call(arguments,2);return HTMLElement.prototype.appendChild.apply(t,e.concat(Array.prototype.slice.call(arguments)))}t.$.itemContainer.innerHTML="",e instanceof HTMLElement&&t.$.itemContainer.appendChild(e)}insertBefore(e,t){const i=this;if(!i.isCompleted){const e=Array.prototype.slice.call(arguments,2);return HTMLElement.prototype.insertBefore.apply(i,e.concat(Array.prototype.slice.call(arguments)))}t.parentNode.insertBefore(e,t)}removeChild(e){const t=this;if(!t.isCompleted||e.classList.contains("smart-ripple")){const e=Array.prototype.slice.call(arguments,2);return HTMLElement.prototype.removeChild.apply(t,e.concat(Array.prototype.slice.call(arguments)))}e instanceof HTMLElement&&t.$.itemContainer.removeChild(e)}attached(){const e=this;super.attached(),e.ownerListBox=e.getListBox()}static get listeners(){return{mouseenter:"_itemOnMouseEnter",mouseleave:"_itemOnMouseLeave"}}ready(){super.ready();const e=this;""===e.label?""!==e.innerHTML&&(e.label=e.innerHTML):e.innerHTML=e.label,e._setDisplayMode(e.displayMode),e._setItemColor(),e.$.container.noRipple=!0}propertyChangedHandler(e,t,i){const o=this;if(super.propertyChangedHandler(e,t,i),"hidden"===e)i?o.$.addClass("smart-hidden"):o.$.removeClass("smart-hidden");else if("color"===e)o._setItemColor();else if("displayMode"===e)o._setDisplayMode(i);else if("label"===e||"value"===e){const t=o.context;o.context=document,"label"===e&&(o.innerHTML=i);const l=o.getListBox();l._applyTemplate(o),l.onItemUpdated(o),o.context=t}else if("details"===e){const e=o.context;o.context=document,o.$.details.innerHTML=i;const t=o.getListBox();t.onItemUpdated(o),o.context=e}else if("innerHTML"===e){const e=o.getListBox();e.onItemUpdated(o)}}getListBox(){const e=this;let t=e.parentNode;for(;!1==t instanceof Smart.ListBox&&null!==t;)t=t.parentNode;return!t&&Smart.EnableShadowDOM?e.getRootNode().host:t}_itemOnMouseEnter(){const e=this;!e.disabled&&e.ownerListBox&&(Smart.ListBox.DragDrop.Dragging&&e.ownerListBox.allowDrop&&(Smart.ListBox.DragDrop.DropDetails={item:e,position:"bottom"}),e.ownerListBox.$.verticalScrollBar.thumbCapture||e.ownerListBox.$.horizontalScrollBar.thumbCapture||e.setAttribute("hover",""))}_itemOnMouseMove(e){const t=this;if(t.ownerListBox&&Smart.ListBox.DragDrop.Dragging&&t.ownerListBox.allowDrop&&!Smart.Utilities.Core.isMobile){const o=[].slice.call(t.ownerListBox.getElementsByClassName("smart-list-item-bottom-line-feedback"));for(let e=0;e<o.length;e++)o[e].$.removeClass("smart-list-item-line-feedback"),o[e].$.removeClass("smart-list-item-bottom-line-feedback");if(Smart.ListBox.DragDrop.DropDetails={item:t,position:"top"},!t.ownerListBox._areCSSVarsSupported){if(t.ownerListBox._indexOf(t)===t.ownerListBox._items.length-1||t.parentNode.lastElementChild===t){const i=t.getBoundingClientRect();e.pageY-window.pageYOffset>i.top+i.height/2-1&&(Smart.ListBox.DragDrop.DropDetails={item:t,position:"bottom"})}return}if(t.$.removeClass("smart-list-item-line-feedback"),t.$.removeClass("smart-list-item-bottom-line-feedback"),t.ownerListBox.sorted&&t.ownerListBox.autoSort)return;const i=t.ownerListBox._items.filter(e=>!e.hidden);if(i.indexOf(t)===i.length-1||t.parentNode.lastElementChild===t){const i=t.getBoundingClientRect();e.pageY-window.pageYOffset>i.top+i.height/2-1?(t.$.addClass("smart-list-item-bottom-line-feedback"),Smart.ListBox.DragDrop.DropDetails={item:t,position:"bottom"}):!arguments[1]&&t.$.addClass("smart-list-item-line-feedback")}else arguments[1]||t.$.addClass("smart-list-item-line-feedback")}}_itemOnMouseLeave(){const e=this;e.ownerListBox&&(Smart.ListBox.DragDrop.Dragging&&(e.$.removeClass("smart-list-item-line-feedback"),e.$.removeClass("smart-list-item-bottom-line-feedback")),e.removeAttribute("hover"))}_setDisplayMode(e){const t=this,i=t.getListBox();if(i){const o="checkBox"===i.selectionMode||"radioButton"===i.selectionMode?i.selectionMode:"plain";t.displayMode=e=o}return"plain"===e?void t.$itemInput.addClass("smart-hidden"):void t.$itemInput.removeClass("smart-hidden")}_setItemColor(){const e=this,t=e.querySelector(".smart-content-label"),i=/(^#[0-9A-F]{3}$)|(^#[0-9A-F]{6}$)|(^#[0-9A-F]{8}$)/i.test(e.color)?e.color:"";t.style.backgroundColor=i,t.style.color=e._getContrastColor(i)}_getContrastColor(e){if(!e)return"";let t=function(t,i,e){return[parseInt(t,16),parseInt(i,16),parseInt(e,16)]}(e.slice(1,3),e.slice(3,5),e.slice(5,7)),i=(.299*t[0]+.61*t[1]+.114*t[2])/255;return .65<parseFloat(i.toFixed(2))?"#000000":"#FFFFFF"}}),Smart("smart-list-items-group",class extends Smart.ContentElement{static get properties(){return{label:{value:"",type:"string"}}}get enableShadowDOM(){return!1}template(){return`<div id="container">
                 <span id="itemsLabel" class ="smart-list-items-group-label">[[label]]</span>
                 <div id="listItemsGroupContainer" inner-h-t-m-l=\'[[innerHTML]]\' class ="smart-list-items-group-container">
                    <content></content>
                 </div>
               </div>`}appendChild(e){const t=this;if(!t.isCompleted){const e=Array.prototype.slice.call(arguments,2);return HTMLElement.prototype.appendChild.apply(t,e.concat(Array.prototype.slice.call(arguments)))}e instanceof HTMLElement&&t.$.listItemsGroupContainer.appendChild(e)}removeChild(e){const t=this;if(!t.isCompleted){const e=Array.prototype.slice.call(arguments,2);return HTMLElement.prototype.removeChild.apply(t,e.concat(Array.prototype.slice.call(arguments)))}e instanceof HTMLElement&&t.$.listItemsGroupContainer.removeChild(e)}getListBox(){const e=this;let t=e.parentNode;for(;!1==t instanceof Smart.ListBox&&null!==t;)t=t.parentNode;return t}attached(){const e=this;super.attached(),e.ownerListBox||(e.ownerListBox=e.getListBox())}}),Smart("smart-list-box",class extends Smart.ScrollViewer{static get properties(){return{allowDrag:{value:!1,type:"boolean"},allowDrop:{value:!1,type:"boolean"},alternationStart:{value:0,type:"int"},alternationEnd:{value:0,type:"int"},alternationCount:{value:0,type:"int"},autoSort:{value:!0,type:"boolean"},dataSource:{value:null,type:"any?",reflectToAttribute:!1},dragFeedbackFormatFunction:{value:null,type:"function?"},dragOffset:{value:[10,10],type:"array"},displayLoadingIndicator:{value:!1,type:"boolean"},displayMember:{value:"",type:"string"},shadowDomMode:{allowedValues:["light","shadow"],value:"shadow",type:"string"},dropAction:{value:"move",type:"string",allowedValues:["copy","move","none"]},editable:{value:!1,type:"boolean"},filterable:{value:!1,type:"boolean"},filterCallback:{value:null,type:"function?"},filterMode:{value:"containsIgnoreCase",allowedValues:["contains","containsIgnoreCase","doesNotContain","doesNotContainIgnoreCase","equals","equalsIgnoreCase","startsWith","startsWithIgnoreCase","endsWith","endsWithIgnoreCase","custom"],type:"string"},filterInputPlaceholder:{value:"",type:"string"},grouped:{value:!1,type:"boolean"},groupMember:{value:"",type:"string"},itemTemplate:{value:null,type:"any"},itemHeight:{value:null,type:"number?"},incrementalSearchDelay:{value:700,type:"number?"},incrementalSearchMode:{value:"startsWithIgnoreCase",allowedValues:["contains","containsIgnoreCase","doesNotContain","doesNotContainIgnoreCase","equals","equalsIgnoreCase","startsWith","startsWithIgnoreCase","endsWith","endsWithIgnoreCase"],type:"string"},loadingIndicatorPlaceholder:{value:"Loading...",type:"string"},loadingIndicatorPosition:{value:"center",allowedValues:["bottom","center","top"],type:"string"},messages:{extend:!0,value:{en:{overridingProperties:"{{elementType}}: Overriding properties {{property1}} and {{property2}} applied. The \"{{property1}}\" property is used by default.",invalidIndex:"{{elementType}}: \"{{method}}\" method accepts an index of type number or an Array of numbers.",indexOutOfBound:"{{elementType}}: Out of bound index/indexes in \"{{method}}\" method.",invalidItem:"{{elementType}}: \"{{method}}\" method accepts an object or an array of objects as it's second parameter.",invalidSettings:"{{elementType}}: \"{{method}}\" method accepts a string or an object as it's second parameter."}},type:"object"},name:{value:"",type:"string"},placeholder:{value:"No Items",type:"string"},selectedIndexes:{value:[],type:"array"},selectedValues:{value:[],type:"array"},selectionMode:{value:"oneOrManyExtended",allowedValues:["none","oneOrManyExtended","zeroOrMany","oneOrMany","zeroOrOne","one","checkBox","radioButton"],type:"string"},selectionChangeAction:{value:"release",allowedValues:["press","release"],type:"string"},sorted:{value:!1,type:"boolean"},sortDirection:{value:"asc",type:"string"},topVisibleIndex:{value:-1,type:"int"},type:{value:"list",type:"string",defaultReflectToAttribute:!0,readonly:!0},valueMember:{value:"",type:"string"},virtualized:{value:!1,type:"boolean"}}}static get requires(){return{"Smart.ScrollBar":"smart.scrollbar.js"}}static get styleUrls(){return["smart.listbox.css","smart.scrollbar.css"]}static get listeners(){return{focus:"_focusHandler",blur:"_blurHandler","container.wheel":"_mouseWheelHandler","editInput.change":"_editInputEventHandler","editInput.blur":"_editInputEventHandler","editInput.keydown":"_editInputEventHandler","horizontalScrollBar.change":"_horizontalScrollbarHandler","itemsInnerContainer.down":"_downHandler","itemsInnerContainer.dblclick":"_dblclickEventHandler","itemsInnerContainer.move":"_itemsContainerMoveHandler","itemsContainer.mouseleave":"_mouseLeaveHandler","document.up":"_upHandler","document.move":"_moveHandler",keydown:"_keyDownHandler",keyup:"_keyUpHandler",resize:"_resizeHandler",selectstart:"_selectStartHandler",styleChanged:"_styleChangedHandler",swipeleft:"_swipeLeftHandler",swiperight:"_swipeRightHandler","verticalScrollBar.change":"_verticalScrollbarHandler"}}template(){return`<div id="container" class="smart-container">
                 <div class="smart-list-box-filter-input-container smart-hidden" id="filterInputContainer">
                     <input id="filterInput" disabled="[[disabled]]" placeholder='[[filterInputPlaceholder]]'>
                 </div>
                 <div id="itemsContainer" class="smart-list-items-container">
                      <div id="placeholder" class ="smart-placeholder">[[placeholder]]</div>
                      <div id="itemsInnerContainer" inner-h-t-m-l=\'[[innerHTML]]\' class ="smart-list-items-inner-container">
                          <content></content>
                      </div>
                      <input type="text" id="editInput" class= "smart-hidden"/>
                 </div>
                 <smart-scroll-bar wait id="verticalScrollBar" disabled="[[disabled]]" orientation="vertical"></smart-scroll-bar>
                 <smart-scroll-bar wait id="horizontalScrollBar" disabled="[[disabled]]" ></smart-scroll-bar>
                 <div id="loadingIndicatorContainer" class ="smart-loader-container">
                    <span id="loadingIndicator" class="smart-loader"></span>
                    <span id="loadingIndicatorPlaceHolder" class ="smart-loader-label smart-hidden">[[loadingIndicatorPlaceholder]]</span>
                 </div>
                <input id="hiddenInput" type="hidden" name="[[name]]">
                </div>`}_mouseLeaveHandler(){const e=this,t=[].slice.call(e.getElementsByClassName("smart-list-item-bottom-line-feedback"));for(let e=0;e<t.length;e++)t[e].$.removeClass("smart-list-item-line-feedback"),t[e].$.removeClass("smart-list-item-bottom-line-feedback")}_downHandler(e){const t=this;if(t.disabled||t.displayLoadingIndicator||t.readonly)return;let i=e.originalEvent.target,o=null;if(i instanceof Smart.ListItem&&!i.disabled&&!i.hidden&&!(i instanceof Smart.ListItemsGroup))o=i.dataItem;else for(;i.parentElement;){if(i instanceof Smart.ListItem&&!i.disabled&&!i.hidden&&!(i instanceof Smart.ListItemsGroup)){o=i.dataItem;break}i=i.parentElement}Smart.ListBox.DragDrop.StartTime=new Date,Smart.ListBox.DragDrop.StartPosition={left:e.pageX,top:e.pageY};o&&(e.stopPropagation(),t.hasRippleAnimation&&!o.readonly&&!o.disabled&&Smart.Utilities.Animation.Ripple.animate(i.$.overlay,e.pageX,e.pageY),!Smart.Utilities.Core.isMobile&&"press"===t.selectionChangeAction&&(t._focus(o),t.select(o)),!Smart.ListBox.DragDrop.Feedback&&t.allowDrag&&(Smart.ListBox.DragDrop.DraggedFrom=t,Smart.ListBox.DragDrop.Feedback=document.createElement("span"),t.dragFeedbackFormatFunction?Smart.ListBox.DragDrop.Feedback.innerHTML=t.dragFeedbackFormatFunction(o):Smart.ListBox.DragDrop.Feedback.appendChild(o.offsetHeight?o.cloneNode(!0):t._createItem(o)),Smart.ListBox.DragDrop.Item=o,Smart.Utilities.Extend(Smart.ListBox.DragDrop.Feedback).addClass("smart-popup smart-list-item smart-list-item-feedback")))}_dblclickEventHandler(e){const t=this;if(t.editable){const i=e.target.closest("smart-list-item");return!(i instanceof Smart.ListItem)||i.disabled||i.readonly?void t.$editInput.addClass("smart-hidden"):void(t.$.editInput.owner=i,t.$.editInput.value=i.label,t.$.editInput.style.height=i.offsetHeight+"px",t.$.editInput.style.top=i.offsetTop+"px",t.$editInput.hasClass("smart-hidden")&&t.$editInput.removeClass("smart-hidden"),t.$.editInput.focus())}}_editInputEventHandler(e){const t=this;if("blur"===e.type||"keydown"===e.type&&"Escape"===e.key)return t.$editInput.hasClass("smart-hidden")?void 0:t.$editInput.addClass("smart-hidden"),void t.focus();if(!("keydown"===e.type||t.$editInput.hasClass("smart-hidden"))){const i=e.target;if(e.stopPropagation(),i.owner.label!==i.value&&(i.owner.label=i.value,t.itemTemplate&&t._applyTemplate(i.owner),t.dataSource)){const e=i.owner.dataIndex,o=t.dataSource[e];o&&(t.displayMember?o[t.displayMember]=i.value:o.label=i.value)}t.$editInput.addClass("smart-hidden"),t.$.fireEvent("itemLabelChange",{selected:i.owner.selected,disabled:i.owner.disabled,index:t._indexOf(i.owner),label:i.owner.label,value:i.owner.value})}}_pointerUpHandler(e){const t=this;let i=e.originalEvent,o=i.target;(t.shadowRoot||t.isInShadowDOM)&&(o=i.composedPath()[0]);const l=i=>{const l=i.ownerListBox;l.disabled||l!==t||l.displayLoadingIndicator||"none"===l.selectionMode||i.grouped||i.readonly||(l._focus(i),l.select(i),e.preventDefault(),Smart.ListBox.DragDrop.StartPosition=null,t.$.fireEvent("itemClick",{selected:o.selected,disabled:o.disabled,index:t._indexOf(o),label:o.label,value:o.value}))};if(i.target instanceof Smart.ListItem&&!i.target.disabled&&!(i.target instanceof Smart.ListItemsGroup))return void l(o.dataItem);for(;o.parentElement;){if(o instanceof Smart.ListItem&&!o.disabled&&!(o instanceof Smart.ListItemsGroup))return void l(o.dataItem);o=o.parentElement}if(this.shadowRoot&&"shadow"===this.shadowDomMode){const e=i.composedPath();for(let t=0;t<e.length;t++){const i=e[t];i instanceof Smart.ListItem&&!i.disabled&&l(i.dataItem)}}}_upHandler(e){var t=Math.abs;const i=this;if(!(i.disabled||i.readonly||!Smart.ListBox.DragDrop.StartPosition)){if(Smart.Utilities.Core.isMobile&&!Smart.ListBox.DragDrop.Dragging){const o=t(e.pageX-Smart.ListBox.DragDrop.StartPosition.left),l=t(e.pageY-Smart.ListBox.DragDrop.StartPosition.top);let s=0<=o&&3>=o&&0<=l&&3>=l;if(Smart.Utilities.Core.isMobile&&300<=new Date-Smart.ListBox.DragDrop.StartTime&&(s=!1,Smart.ListBox.DragDrop.StartTime=null),s){const t=e.originalEvent.target.closest("smart-list-box");t?t._pointerUpHandler(e):i._pointerUpHandler(e),Smart.ListBox.DragDrop.StartPosition=null}else{let t=e.originalEvent.target;if(e.target instanceof Smart.ListItem&&!t.readonly&&!e.target.disabled&&!(e.target instanceof Smart.ListItemsGroup))e.preventDefault(),e.stopPropagation();else for(;t.parentElement;){if(t instanceof Smart.ListItem&&!t.readonly&&!t.disabled&&!(t instanceof Smart.ListItemsGroup)){e.preventDefault(),e.stopPropagation();break}t=t.parentElement}}}else if(!Smart.Utilities.Core.isMobile&&!Smart.ListBox.DragDrop.Dragging&&"release"===i.selectionChangeAction){const t=(i.shadowRoot||i.isInShadowDOM?e.originalEvent.composedPath()[0]:e.originalEvent.target).closest("smart-list-box");t?t._pointerUpHandler(e):i._pointerUpHandler(e)}if(Smart.ListBox.DragDrop.Feedback){Smart.ListBox.DragDrop.Feedback.parentNode&&Smart.ListBox.DragDrop.Feedback.parentNode.removeChild(Smart.ListBox.DragDrop.Feedback),Smart.ListBox.DragDrop.Feedback=null;let t;if(Smart.Utilities.Core.isMobile&&Smart.ListBox.DragDrop.Dragging)for(let i=0;i<Smart.ListBox.DragDrop.ListBoxes.length;i++){const o=Smart.ListBox.DragDrop.ListBoxes[i],l=o.getBoundingClientRect();if(o.allowDrop&&!o.closest(".smart-visibility-hidden")&&l.left<=e.pageX&&e.pageX<=l.left+l.width&&l.top<=e.pageY&&e.pageY<=l.top+l.height){t=o;const s=o._items.filter(e=>!e.hidden);for(let t=0;t<s.length;t++){const i=s[t],n=i.getBoundingClientRect();if((s.indexOf(i)===s.length-1||i.parentNode.lastElementChild===i)&&e.pageY>=l.top+i.offsetTop-o.scrollTop+n.height/2&&e.pageY<=l.top-o.scrollTop+i.offsetTop+n.height){Smart.ListBox.DragDrop.DropDetails={item:i,position:"bottom"};break}if(e.pageY>=l.top+i.offsetTop-o.scrollTop&&e.pageY<=l.top+i.offsetTop+n.height-o.scrollTop){Smart.ListBox.DragDrop.DropDetails={item:i,position:"top"};break}}}}if(Smart.ListBox.DragDrop.Dragging){if(Smart.ListBox.DragDrop.DropDetails){let i=Smart.ListBox.DragDrop.DropDetails.item,o=Smart.ListBox.DragDrop.Item;const l=o.ownerListBox;if(t=!t&&e.originalEvent.target.closest?e.originalEvent.target.closest("smart-list-box"):t,document.body.classList.remove("smart-dragging"),i.$.removeClass("smart-list-item-line-feedback"),i.$.removeClass("smart-list-item-bottom-line-feedback"),t&&i.ownerListBox!==t&&0<t.items.length&&(i=t.items[t.items.length-1]),!(Smart.ListBox.DragDrop.Item!==i&&(t===i.ownerListBox||Smart.Utilities.Core.isMobile)))t&&0===t._items.length&&"none"!==t.dropAction&&("move"===t.dropAction?Smart.ListBox.DragDrop.Item.ownerListBox.removeChild(Smart.ListBox.DragDrop.Item):"copy"===t.dropAction&&(o=o.cloneNode(!0)),t.appendChild(o));else if("none"!==o.ownerListBox.dropAction){i.ownerListBox!==o.ownerListBox&&"move"===o.ownerListBox.dropAction&&Smart.ListBox.DragDrop.Item.ownerListBox.removeChild(Smart.ListBox.DragDrop.Item),"copy"===o.ownerListBox.dropAction&&(o=o.cloneNode(!0)),Smart.ListBox.DragDrop.Item.group=i.group;const e=i.ownerListBox;"checkBox"!==e.selectionMode&&"radioButton"!==e.selectionMode&&e.clearSelection(),"top"===Smart.ListBox.DragDrop.DropDetails.position?e.insertBefore(o,i):i.parentNode.lastElementChild===i?e.appendChild(o):e.appendChild(o,i),e.ensureVisible(o),"checkBox"===e.selectionMode||"radioButton"===e.selectionMode?(e._focus(o),e._refreshSelection()):(e.clearSelection(),e.select(o))}o.selected&&t!==l&&l._refreshSelection();const s=Smart.ListBox.DragDrop.Item,n=s.ownerListBox;s.displayMode="checkBox"===n.selectionMode||"radioButton"===n.selectionMode?n.selectionMode:"plain",n.$.fireEvent("dragEnd",{item:s,target:i,data:Smart.ListBox.DragDrop,previousContainer:l,container:t,originalEvent:e}),n._focus(s)}else{const t=Smart.ListBox.DragDrop.Item,i=t.ownerListBox;t.displayMode="checkBox"===i.selectionMode||"radioButton"===i.selectionMode?i.selectionMode:"plain",i.$.fireEvent("dragEnd",{item:t,target:null,data:Smart.ListBox.DragDrop,previousContainer:i,container:i,originalEvent:e}),i._focus(t)}e.preventDefault()}delete Smart.ListBox.DragDrop.DraggedFrom,Smart.ListBox.DragDrop.Dragging=!1,Smart.ListBox.DragDrop.Item=null,Smart.ListBox.DragDrop.DropDetails=null}for(let e=0;e<Smart.ListBox.DragDrop.ListBoxes.length;e++){const t=Smart.ListBox.DragDrop.ListBoxes[e];t._dragInterval&&clearInterval(t._dragInterval)}}}_itemsContainerMoveHandler(e){const t=this;if(Smart.ListBox.DragDrop.Dragging)return t._applyItemFeedback(e),t._moveHandler(e),e.originalEvent.preventDefault(),e.originalEvent.stopPropagation(),!1}_applyItemFeedback(e){const t=this,i=e.originalEvent.target,o=i.closest?i.closest("smart-list-item"):i;return Smart.Utilities.Core.isMobile?void(Smart.ListBox.DragDrop.DropDetails={item:Smart.ListBox.DragDrop.Item,position:"bottom"}):0===t.items.length?void 0:o?void o._itemOnMouseMove(e):void t.items[t.items.length-1]._itemOnMouseMove(e,!0)}_moveHandler(e){var t=Math.abs;const i=this;if(Smart.ListBox.DragDrop.Feedback&&Smart.ListBox.DragDrop.DraggedFrom===i){const o=i.dragOffset;if(!Smart.ListBox.DragDrop.Dragging){const i=t(e.pageX-Smart.ListBox.DragDrop.StartPosition.left),l=t(e.pageY-Smart.ListBox.DragDrop.StartPosition.top),s=new Date-Smart.ListBox.DragDrop.StartTime;let n=5<=i&&15>=i||5<=l&&15>=l;if(Smart.Utilities.Core.isMobile&&(300>s||1e3<s)&&(n=!1),n){Smart.ListBox.DragDrop.Dragging=!0,Smart.ListBox.DragDrop.Feedback.style.left=o[0]+e.pageX+"px",Smart.ListBox.DragDrop.Feedback.style.top=o[1]+e.pageY+"px",document.body.appendChild(Smart.ListBox.DragDrop.Feedback),e.preventDefault(),e.stopPropagation(),e.originalEvent.preventDefault(),e.originalEvent.stopPropagation();const t=Smart.ListBox.DragDrop.Item,i=t.ownerListBox;i.$.fireEvent("dragStart",{item:t,data:Smart.ListBox.DragDrop,container:i,previousContainer:i,originalEvent:e.originalEvent}),document.body.classList.add("smart-dragging")}}else{Smart.ListBox.DragDrop.Feedback.style.left=o[0]+e.pageX+"px",Smart.ListBox.DragDrop.Feedback.style.top=o[1]+e.pageY+"px",i.$.fireEvent("dragging",{item:Smart.ListBox.DragDrop.Item,data:Smart.ListBox.DragDrop,originalEvent:e.originalEvent});for(let t=0;t<Smart.ListBox.DragDrop.ListBoxes.length;t++){const i=Smart.ListBox.DragDrop.ListBoxes[t];i._dragInterval&&clearInterval(i._dragInterval),i._dragInterval=setInterval(function(){const t=i.getBoundingClientRect();t.left<=e.clientX&&t.left+t.width>=e.clientX&&(e.clientY>=t.top&&e.clientY<=t.top+20?i.scrollTop-=2:e.clientY>=t.top+t.height-20&&e.clientY<=t.top+t.height&&(i.scrollTop+=2))},1)}return e.preventDefault(),e.stopPropagation(),e.originalEvent.preventDefault(),e.originalEvent.stopPropagation(),!1}}}_focusHandler(){const e=this;e._focused=!0,e.setAttribute("focus","")}_blurHandler(){const e=this;e._focused=!1,e.removeAttribute("focus")}appendChild(e){const t=this;if(!t.isCompleted){const e=Array.prototype.slice.call(arguments,2);return HTMLElement.prototype.appendChild.apply(t,e.concat(Array.prototype.slice.call(arguments)))}t.isVirtualized?(-1<t._items.indexOf(e)&&t._items.splice(t._items.indexOf(e),1),t._items.push(e)):(e.dataItem=e,t.shadowRoot&&"light"===t.shadowDomMode?t.appendChild(e):t.$.itemsInnerContainer.appendChild(e),-1<t._items.indexOf(e)&&t._items.splice(t._items.indexOf(e),1),t._items.push(e)),t._refreshItems(),t._refreshSelection()}insertBefore(e,t){const i=this;if(!i.isCompleted){const e=Array.prototype.slice.call(arguments,2);return HTMLElement.prototype.insertBefore.apply(i,e.concat(Array.prototype.slice.call(arguments)))}i.isVirtualized?(-1<i._items.indexOf(e)&&i._items.splice(i._items.indexOf(e),1),i._items.splice(i._indexOf(t),0,e)):(e.dataItem=e,t.parentNode.insertBefore(e,t),-1<i._items.indexOf(e)&&i._items.splice(i._items.indexOf(e),1),i._items.splice(i._indexOf(t),0,e)),i._refreshItems(),i._refreshSelection()}removeChild(e){const t=this;if(!t.isCompleted){const e=Array.prototype.slice.call(arguments,2);return HTMLElement.prototype.removeChild.apply(t,e.concat(Array.prototype.slice.call(arguments)))}if(t.isVirtualized)t._items.splice(t._indexOf(e),1);else if(e.parentNode){const i=t.selectedIndexes.slice(0),o=t.selectedValues.slice(0),l=i.indexOf(e.dataIndex);e.parentNode.removeChild(e),-1<l&&(i.splice(l,1),o.splice(l,1),t.selectedIndexes=i,t.selectedValues=o)}t._refreshItems()}propertyChangedHandler(e,t,o){super.propertyChangedHandler(e,t,o);const l=this;switch(e){case"innerHTML":l.clearSelection(),l._dataBind(),l.innerHTML=l.content=Smart.Utilities.Core.html(l.$.content);break;case"dataSource":case"valueMember":case"groupMember":case"displayMember":{l.clearSelection(),l._dataBind();break}case"disabled":case"unfocusable":l._setFocusable();break;case"displayLoadingIndicator":{l._setLoadingIndicatorVisibility();break}case"filterable":{l._refreshFilter(),l._refreshLayout();break}case"grouped":{if(o?l._group():l._ungroup(),!("radioButton"===l.selectionMode))l._refreshSelection();else if(0<l.selectedValues.length){const e=l.selectedValues;l.clearSelection(),l.select(e[0])}l._refreshLayout();break}case"itemTemplate":{if(null===o||""===o)return l._items.map(e=>e.innerHTML=e.label),delete l._bindingDetails,void l._refreshLayout();const e=l.querySelectorAll("smart-list-item"),t=function(){l._handleItemTemplate(o)&&(l._items.map(e=>l._applyTemplate(e)),l._refreshLayout()),l.ownerElement&&l.ownerElement._setDropDownSize&&l.ownerElement._setDropDownSize(),l.$.fireEvent("bindingComplete")};0===e.length?t():l._ensureItemsReady(e,t);break}case"selectedIndexes":case"selectedValues":{let s=l.selectedIndexes.slice(0),i=l.selectedValues.slice(0);if(!l._items||0===l._items.length)return l.selectedIndexes=[],l.selectedValues=[],void(l.$.hiddenInput.value=l.selectedValues.toString());if(l._propertyChanging=!0,"selectedIndexes"===e){s=t.slice(0),l.clearSelection();for(let e=0;e<o.length;e++){const t=o[e],i=l._items[t];i&&("oneOrManyExtended"===l.selectionMode||"oneOrMany"===l.selectionMode?(0<l.selectedIndexes.length&&0==e&&l.clearSelection(),l._select(i)):l.select(i))}}else{i=t.slice(0),l.selectedValues=[],l.clearSelection();for(let e=0;e<o.length;e++){const t=o[e],i=l.getItem(t);i&&("oneOrManyExtended"===l.selectionMode?l._select(i):l.select(i))}}if(0<l.selectedIndexes.length&&l._focus(l._items[l.selectedIndexes[0]]),l._propertyChanging=!1,JSON.stringify(i)!==JSON.stringify(l.selectedValues.slice(0))){let e=[],t=[];for(let e=0;e<s.length;e++)0>l.selectedIndexes.indexOf(s[e])&&t.push(l._items[s[e]]);for(let t=0;t<l.selectedIndexes.length;t++)0>s.indexOf(l.selectedIndexes[t])&&e.push(l._items[l.selectedIndexes[t]]);let i={addedItems:e,removedItems:t};if(0<l.selectedIndexes.length){const e=l._items[l.selectedIndexes[l.selectedIndexes.length-1]];e!==void 0&&(i.selected=e.selected,i.disabled=e.disabled,i.index=l._indexOf(e),i.label=e.label,i.value=e.value)}else i.selected=!1,i.disabled=!1,i.index=-1,i.label="",i.value="";l.$.fireEvent("change",i)}break}case"selectionMode":{const e="checkBox"===l.selectionMode||"radioButton"===l.selectionMode?l.selectionMode:"plain",t=l.selectedIndexes.slice(0),i=l.selectedValues.slice(0);l._propertyChanging=!0;const o=l.selectedValues;l.selectedValues=[],l.clearSelection();for(let e=0;e<o.length;e++){const t=o[e],i=l.getItem(t);i&&("oneOrManyExtended"===l.selectionMode?l._select(i):l.select(i))}if(l._items.forEach(t=>t.displayMode=e),l._recycle(),l._propertyChanging=!1,JSON.stringify(i)!==JSON.stringify(l.selectedValues.slice(0))){let e=[],o=[];for(let e=0;e<t.length;e++)0>l.selectedIndexes.indexOf(t[e])&&o.push(l._items[t[e]]);for(let o=0;o<l.selectedIndexes.length;o++)0>t.indexOf(l.selectedIndexes[o])&&e.push(l._items[l.selectedIndexes[o]]);let i={addedItems:e,removedItems:o};if(0<t.length){const e=l._items[t[t.length-1]];e&&(i.selected=e.selected,i.disabled=e.disabled,i.index=l._indexOf(e),i.label=e.label,i.value=e.value)}l.$.fireEvent("change",i)}break}case"topVisibleIndex":l._setTopVisibleIndex(o);break;case"autoSort":l._canSort=o;break;case"sortDirection":case"sorted":{l._canSort=!0,o?l._sort():l._unsort();const e=l.selectedValues;l.selectedValues=[],l._refreshSelection();for(let t=0;t<e.length;t++){const i=e[t],o=l.getItem(i);o&&("oneOrManyExtended"===l.selectionMode?l._select(o):l.select(o))}l._refreshLayout(),l._canSort=l.autoSort;break}}}_refreshSelection(){const e=this;if(e._items&&0!==e._items.length){const t=e.selectedValues;e.selectedIndexes=[],e.selectedValues=[];for(let o=0;o<e._items.length;o++){const i=e._items[o];i.selected=!1,-1<t.indexOf(i.value)&&e.select(i)}e._recycle()}}clearSelection(){const e=this;if(!e._items||0===e._items.length)return;let t=[];for(let o=0;o<e._items.length;o++)e._items[o].selected&&t.push(e._items[o]);e._items.map(e=>e.selected=!1);const i=e.selectedValues.slice(0),o=e.selectedIndexes.slice(0);if(e.selectedIndexes=[],e.selectedValues=[],e.$.hiddenInput.value=e.selectedValues.toString(),e._recycle(),e.context!==e){let i={addedItems:[],removedItems:t};if(0<o.length){const t=e._items[o[o.length-1]];t&&(i.selected=t.selected,i.disabled=t.disabled,i.index=e._indexOf(t),i.label=t.label,i.value=t.value)}e.$.fireEvent("change",i)}}ensureVisible(e){const t=this;if(e)return!("string"==typeof e&&(e=t.getItem(e),!e))&&(t.isVirtualized||t.$.itemsContainer.scrollTop===t.scrollTop||(t.scrollTop=t.$.itemsContainer.scrollTop),e.top+e.height>=t.scrollTop+t.offsetHeight&&(t.scrollTop+=e.height,!t.isVirtualized&&(t.$.itemsContainer.scrollTop=t.scrollTop)),(e.top<=t.scrollTop||e.top>=t.scrollTop+t.$.itemsContainer.offsetHeight)&&(t.scrollTop=e.top,!t.isVirtualized&&(t.$.itemsContainer.scrollTop=t.scrollTop)),0===t._indexOf(e)||1===t._indexOf(e)&&1<t._items.length&&t._items[0].grouped?(t.scrollTop=0,!t.isVirtualized&&(t.$.itemsContainer.scrollTop=t.scrollTop)):t._indexOf(e)===t._items.length-1&&(t.scrollTop=t.scrollHeight,!t.isVirtualized&&(t.$.itemsContainer.scrollTop=t.scrollTop)),!0)}get items(){const e=this;return e._filteredItems?e._filteredItems:e._items}ready(){super.ready();const e=this;if(e.shadowRoot&&"light"===e.shadowDomMode){const t=document.createDocumentFragment();[].slice.call(e.$.itemsInnerContainer.children).map(e=>t.appendChild(e)),e.appendChild(t),e.$.itemsInnerContainer.appendChild(document.createElement("slot"))}e._areCSSVarsSupported=Smart.Utilities.Core.CSSVariablesSupport(),e.isUpdating=0,e._scrollView&&(e._scrollView=new Smart.Utilities.Scroll(e,e.$.horizontalScrollBar,e.$.verticalScrollBar),e._scrollView.hScrollBar.$.addClass("smart-hidden"),e._scrollView.vScrollBar.$.addClass("smart-hidden"));const t=e._scrollView.vScrollBar,i=e._scrollView.hScrollBar;t.hasStyleObserver=!1,i.hasStyleObserver=!1,t.hasResizeObserver=!1,i.hasResizeObserver=!1,t.wait=!1,i.wait=!1,e._setFocusable()}render(){const e=this;e._keysPressed={},e._incrementalSearchQuery="",e._incrementalSearchItems=[],e._canSort=!0,e._previousEntry="",e._setLoadingIndicatorVisibility(),e._refreshFilter(),e._initializeInnerHTML(),e._dataBind(),e.enableShadowDOM&&HTMLElement.prototype.appendChild.apply(e,[e.$.hiddenInput]),super.render()}attached(){const e=this;super.attached(),Smart.ListBox.DragDrop||(Smart.ListBox.DragDrop={ListBoxes:[]}),Smart.ListBox.DragDrop.ListBoxes.push(e),e._scrollView||(e._scrollView=new Smart.Utilities.Scroll(e,e.$.horizontalScrollBar,e.$.verticalScrollBar)),0<e.selectedIndexes.length&&e._items&&e.ensureVisible(e._items[e.selectedIndexes[0]])}detached(){const e=this;if(super.detached(),e._scrollView&&(e._scrollView.unlisten(),delete e._scrollView),Smart.ListBox.DragDrop&&Smart.ListBox.DragDrop.ListBoxes){const t=Smart.ListBox.DragDrop.ListBoxes.indexOf(e);Smart.ListBox.DragDrop.ListBoxes.splice(t,1)}}_createItem(e,t,i){const o=this,l="checkBox"===o.selectionMode||"radioButton"===o.selectionMode?o.selectionMode:"plain",s=i?{}:document.createElement("smart-list-item");s.ownerListBox=o,"number"==typeof e&&(e=""+e);const n=function(t,i){return void 0===e[t]?e[i]:""+e[t]};let r="string"==typeof e?e:n(o.displayMember,"label"),a="string"==typeof e?e:n(o.valueMember,"value"),d=n(o.groupMember,"group");return void 0===r&&(void 0===t?r="":r=""+t),s.label=s.innerHTML=""+r,void 0===a&&(void 0===t?a=r:a=""+t),e.color&&(s.color=e.color),s.value=""+a,s.displayMode=l,s.selected=!!e.selected&&e.selected,s.disabled=!!e.disabled&&e.disabled,s.dataItem=s,void 0!==t&&(s.dataIndex=t),o._alternateItem(s),e.title&&(s.title=e.title),d&&(s.group=""+d),s}_alternateItem(e){const t=this,i=t.alternationStart,o=0<t.alternationEnd?t.alternationEnd:1/0;0>=t.alternationCount||(t._alternationIndexCounter===void 0&&(t._alternationIndexCounter=0),e.dataIndex>=i&&e.dataIndex<=o&&(e.alternationIndex=t._alternationIndexCounter++,t._alternationIndexCounter===t.alternationCount&&(t._alternationIndexCounter=0)))}_beginUpdate(){const e=this;e.isUpdating++}_isUpdating(){const e=this;return 0<e.isUpdating}_endUpdate(){const e=this;e.isUpdating--}get _scrollHeight(){const e=this;let t=0;if(e.isVirtualized){if(e.__scrollHeight)return e.__scrollHeight;if(0===e._items.length)return 0;e.isUpdating++;const o=e._createItem(e.dataSource[0]);e.$.itemsInnerContainer.appendChild(o);for(let l=0;l<e._items.length;l++){const i=e._items[l];if(i.hidden){i.height=0,i.top=t;continue}e.itemHeight?(32>e.itemHeight&&(e.itemHeight=32),i.height=e.itemHeight):(o.label=i.label,i.height=o.offsetHeight),i.top=t,t+=i.height}e.$.itemsInnerContainer.removeChild(o),e.__scrollHeight=t-e.$.itemsInnerContainer.offsetHeight,e.filterable&&(e.__scrollHeight+=e.$.filterInput.offsetHeight),t=e.__scrollHeight,e.isUpdating--}else{for(let o=0;o<e._items.length;o++){const i=e._items[o];if(i.hidden){i.height=0,i.top=t;continue}e.itemHeight?"auto"!==e.itemHeight&&(i.height=e.itemHeight,i.style.height=i.height+"px"):i.height=i.offsetHeight,i.top=i.offsetTop,t+=i.height}t=e.$.itemsInnerContainer.scrollHeight-e.$.itemsInnerContainer.offsetHeight,e.filterable&&0<t&&(t+=e.$.filterInput.offsetHeight),e.__scrollHeight=t}return t}_initializeRecyclingItems(){const e=this;if(!e.dataSource||e.dataSource&&0===e.dataSource.length||!e.isVirtualized)return;let t=0,o=e.offsetHeight;e.$.itemsInnerContainer.innerHTML="",e._recyclingItems=[];const i=function(){for(let l=0;l<e.dataSource.length;l++){const i=e.dataSource[l],s=e._createItem(i);if(e.itemHeight&&"auto"!==e.itemHeight&&(s.style.height=e.itemHeight+"px"),e.$.itemsInnerContainer.appendChild(s),t+=s.offsetHeight,s.dataItem=e._items[l],e._recyclingItems.push(s),t>1.5*o)break}};i();for(let e=0;t<1.5*o&&5>++e;)i()}_dataBind(){const e=this;if(e._scrollView||(e._scrollView=new Smart.Utilities.Scroll(e,e.$.horizontalScrollBar,e.$.verticalScrollBar)),"function"==typeof e.dataSource&&(e._items=[]),"string"==typeof e.dataSource&&(e.dataSource=JSON.parse(e.dataSource)),null!==e.dataSource&&Array.isArray(e.dataSource)){e.isUpdating++;const t=t=>{e._items=[],e._groups=[];const o=e.dataSource;for(let l=0;l<o.length;l++){const i=o[l],s=e._createItem(i,l,!t);e._items[l]=s,t&&t.appendChild(s)}};if(e.isVirtualized)t(),e._initializeRecyclingItems();else{const i=document.createDocumentFragment();e.$.itemsInnerContainer.innerHTML="",t(i),e.$.itemsInnerContainer.appendChild(i)}e.isUpdating--}const t=e.shadowRoot?e.shadowRoot.querySelectorAll("smart-list-item"):e.querySelectorAll("smart-list-item"),i=function(){e.isUpdating++,e.dataSource||(e._initializeHtmlListItems(),e._initializeHtmlListGroups()),e.grouped&&e._group(),e.sorted&&e._sort(),e._refreshLayout(),e._initializeSelection(),e.isInitialized=!0,e._canSort=e.autoSort,e.isUpdating--,e.itemTemplate&&e._handleItemTemplate(e.itemTemplate)&&(e._items.map(t=>e._applyTemplate(t)),e._refreshLayout()),e.__onCompleted&&(e._onCompleted=e.__onCompleted,e.__onCompleted=null,e._onCompleted()),-1<e.topVisibleIndex&&e._setTopVisibleIndex(e.topVisibleIndex),e.$.fireEvent("bindingComplete"),e._updateTopVisibleIndex(),0===e._items.length&&e.clearItems()};0===t.length?i():(e._onCompleted&&(e.__onCompleted=e._onCompleted,e._onCompleted=null),e._ensureItemsReady(t,i))}_ensureItemsReady(e,t){const o=this,i=function(){const i=function(t){for(let o=0;o<e.length;o++)e[o].context="node"===t?e[o]:document};i("node"),t(),i()};if(0===e.length)i();else{o._nodesReadyListeners=0;for(let t=0;t<e.length;t++){const l=e[t],s=function(){o._nodesReadyListeners--,0===o._nodesReadyListeners&&(i(),delete o._nodesReadyListeners)}.bind(o);l.isCompleted||(o._nodesReadyListeners++,l._onCompleted=s)}0===o._nodesReadyListeners&&i()}}_initializeInnerHTML(){const e=this;0<=e.$.itemsInnerContainer.innerHTML.indexOf("<option")?e.$.itemsInnerContainer.innerHTML=e.$.itemsInnerContainer.innerHTML.replace(/<optgroup/ig,"<smart-list-items-group").replace(/<\/optgroup/ig,"</smart-list-items-group").replace(/<option/ig,"<smart-list-item").replace(/<\/option/ig,"</smart-list-item"):0<=e.$.itemsInnerContainer.innerHTML.indexOf("<ul")&&(e.$.itemsInnerContainer.innerHTML=e.$.itemsInnerContainer.innerHTML.replace(/<ul/ig,"<smart-list-items-group").replace(/<\/ul/ig,"</smart-list-items-group").replace(/<li/ig,"<smart-list-item").replace(/<\/li/ig,"</smart-list-item"))}_initializeHtmlListItems(){const e=this,t=e.shadowRoot&&"shadow"===e.shadowDomMode?e.shadowRoot.querySelectorAll("smart-list-item"):e.querySelectorAll("smart-list-item"),o="checkBox"===e.selectionMode||"radioButton"===e.selectionMode?e.selectionMode:"plain",l=function(e,t,i){return void 0===e[t]?e[i]:""+e[t]};e._items=[];let s=0;for(let n=0;n<t.length;n++){const i=t[n];i.dataIndex=n,i.label=i.innerHTML,i.dataItem=i,i.top||(i.top=s),i.height||(i.height=i.offsetHeight),s+=i.height,i.value||(i.value=""+n);const r=l(i,e.displayMember,"label"),a=l(i,e.valueMember,"value"),d=l(i,e.groupMember,"group");i.label!==r&&(i.label=r),i.value!==a&&(i.value=a),i.group!==d&&(i.group=d);const c=i.context;i.context=document,i.displayMode=o,i.context=c,e._alternateItem(i),i.selected&&(e.selectedIndexes.push(n),e.selectedValues.push(i.value)),e._items.push(i)}e.itemTemplate&&e._handleItemTemplate(e.itemTemplate)&&e._items.map(t=>e._applyTemplate(t))}_group(){const e=this;e.isUpdating++;let t=[],o=[];e._canSort&&e._unsort();for(let o=0;o<e._items.length;o++){const i=e._items[o];let l=i.group?i.group.trim():i.innerHTML.charAt(0)||i.label.charAt(0);l+=" ",t[l]?t[l].items.push(i):t[t.length++]=t[l]={items:[i],label:l}}if(!e.isVirtualized){for(;e.$.itemsInnerContainer.firstChild;)e.$.itemsInnerContainer.removeChild(e.$.itemsInnerContainer.firstChild);const l=document.createDocumentFragment();e._groups=[];for(let s=0;s<t.length;s++){const i=t[s],n=document.createElement("smart-list-items-group");n.label=i.label,n.dataIndex=s;for(let e=0;e<t[s].items.length;e++){const t=i.items[e];o.push(t),t.group=i.label,n.appendChild(t)}e._groups.push(n),l.appendChild(n)}e._items=o;const i=/Trident|Edge/.test(navigator.userAgent);i?setTimeout(function(){e.$.itemsInnerContainer.appendChild(l)},50):e.$.itemsInnerContainer.appendChild(l)}else{e._groups=[];for(let e=0;e<t.length;e++){const i=t[e];i.dataIndex=e,i.grouped=!0,i.hidden=!1,i.displayMode="plain",o.push(i);for(let l=0;l<t[e].items.length;l++){const e=i.items[l];e.group=i,o.push(e)}}e._groups=t,e._items=o}e.sorted&&e._sort(),e.isUpdating--}_ungroup(){const e=this;e.isUpdating++,e._groups=[],e._canSort&&e._unsort();let t=[];if(!e.isVirtualized){const o=document.createDocumentFragment();for(let l=0;l<e._items.length;l++){const i=e._items[l];o.appendChild(i),t.push(i)}0<t.length&&(e.$.itemsInnerContainer.innerHTML="",e.$.itemsInnerContainer.appendChild(o))}else for(let o=0;o<e._items.length;o++){const i=e._items[o];i.grouped||t.push(i)}e._items=t,e.sorted&&e._sort(),e.isUpdating--}_initializeHtmlListGroups(){const e=this,t=e.$.itemsInnerContainer.querySelectorAll("smart-list-items-group");e._groups=[];for(let o=0;o<t.length;o++){const i=t[o];i.dataIndex=o,e._groups.push(i)}}_initializeSelection(){const e=this,t=e.selectedIndexes.slice(0),o=e.selectedValues.slice(0);e.clearSelection(),"oneOrManyExtended"===e.selectionMode&&(e._keysPressed.Control=!0);for(let l=0;l<e._items.length;l++){const i=e._items[l];(0<=t.indexOf(l)||0<=o.indexOf(i.value||i.label))&&(e._focusedItem&&(e._focusedItem._focused=!1),e._focusedItem=null,e.select(i))}"oneOrManyExtended"===e.selectionMode&&(e._keysPressed.Control=!1)}onItemUpdated(){const e=this;!e.isInitialized||e._isUpdating()||(e.isUpdating++,e._refreshLayout(),e.isUpdating--)}_refreshItems(){const e=this;if(e.isInitialized&&!e._isUpdating()){if(e.isUpdating++,e.grouped?e._ungroup():e.sorted&&e._canSort&&e._unsort(),!e.isVirtualized){e._items=[];const t=e.shadowRoot?e.shadowRoot.querySelectorAll("smart-list-item"):e.querySelectorAll("smart-list-item");for(let o=0;o<t.length;o++)t[o].dataIndex=o,e._alternateItem(t[o]),e._items.push(t[o])}e.grouped?e._group():e.sorted&&e._sort(),e._refreshLayout(),e.isUpdating--}}_applyIncrementalSearch(e){const t=this;if(!(null===t.incrementalSearchDelay||isNaN(t.incrementalSearchDelay)))return-1<["Shift","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Control","Home","End","PageUp","PageDown"].indexOf(e)?void 0:(0!==t._incrementalSearchQuery.indexOf(e)&&(t._incrementalSearchQuery+=e),t._incrementalSearchTimer&&clearTimeout(t._incrementalSearchTimer),t._incrementalSearch(),void(t._incrementalSearchTimer=setTimeout(function(){t._incrementalSearchQuery=""},t.incrementalSearchDelay)))}select(e){const t=this;if(!("string"==typeof e&&(e=t.getItem(e),!e))&&!("number"==typeof e&&(e=t.getItem(e),!e))&&!(e.grouped||e.readonly)){if("none"===t.selectionMode)return t.selectedIndexes=[],void(t.selectedValues=[]);switch(!t._focusedItem!==e&&"none"!==t.selectionMode&&(t._focusedItem&&(t._focusedItem._focused=!1),t._focusedItem=e,e._focused=!0),t.selectionMode){case"one":return(1!==t.selectedIndexes.length||t.selectedIndexes[0]!==t._indexOf(e))&&(t._previouslySelectedIndexes=t.selectedIndexes,1<=t.selectedIndexes.length&&t.clearSelection(),t._select(e),delete t._previouslySelectedIndexes,!0);case"zeroOrOne":return 1===t.selectedIndexes.length&&t.selectedIndexes[0]===t._indexOf(e)?(t.unselect(e),!0):(t._previouslySelectedIndexes=t.selectedIndexes,1<=t.selectedIndexes.length&&t.clearSelection(),t._select(e),delete t._previouslySelectedIndexes,!0);case"radioButton":if(t._previouslySelectedIndexes=t.selectedIndexes,0<t.$.itemsInnerContainer.querySelectorAll("smart-list-items-group").length){const i=e.parentNode;if(!e.selected){for(let e in i.children){const o=i.children[e];o.selected&&t.unselect(o)}t._select(e)}return delete t._previouslySelectedIndexes,!0}if(t.isVirtualized&&0<t._groups.length){const i=e.group;if(!e.selected){for(let e in i.items){const o=i.items[e];o.selected&&t.unselect(o)}t._select(e)}return delete t._previouslySelectedIndexes,!0}return e.selected||(1<=t.selectedIndexes.length&&t.clearSelection(),t._select(e)),delete t._previouslySelectedIndexes,!0;case"oneOrMany":return e.selected?1<t.selectedIndexes.length&&t.unselect(e):t._select(e),!0;case"zeroOrMany":case"checkBox":return e.selected?t.unselect(e):t._select(e),!0;case"oneOrManyExtended":{const o=t.selectedValues;if(t._keysPressed.Control)return 1<t.selectedIndexes.length?e.selected?(t.unselect(e),t._focus(t._items[t.selectedIndexes[0]])):t._select(e):t._select(e),!0;if(t._keysPressed.Shift){const i=t._items[t.selectedIndexes[0]];let l;t.clearSelection();const s=0<=o.indexOf(i.value)||i.selected;if(t._select(i,s),t._indexOf(i)>t._indexOf(e))for(l=t._indexOf(i)-1;l>=t._indexOf(e);){const e=t._items[l],i=0<=o.indexOf(e.value)||e.selected;t._select(e,i),l--}else for(l=t._indexOf(i)+1;l<=t._indexOf(e);){const e=t._items[l],i=0<=o.indexOf(e.value)||e.selected;t._select(e,i),l++}const n=[];for(let e=0;e<o.length;e++)n.push(t.getItem(o[e]));if(0<n.length&&!t._propertyChanging){let l=[];for(let e=0;e<t.selectedValues.length;e++){const i=t.selectedValues[e];0>o.indexOf(i)&&l.push(t.getItem(i))}t.$.fireEvent("change",{addedItems:l,removedItems:n,selected:e.selected,disabled:e.disabled,index:t._indexOf(e),label:e.label,value:e.value})}return!0}for(let l=0;l<o.length;l++){const i=o[l],s=t.getItem(i);e!==s&&t.unselect(s)}return t.clearSelection(),t._select(e,0<=o.indexOf(e.value)),!0}}return!1}}_applyTemplate(e,t){const o=this;if(null===o.itemTemplate)return;if("function"==typeof o.itemTemplate)return void o.itemTemplate(e,{label:e.label,value:e.value,index:o._items.indexOf(e)});if(!o._bindingDetails||0===o._bindingDetails.length)return;const i=o._bindingDetails.length;let l,s,n=document.importNode(o._template.content,!0);for(let r=0;r<i;r++){l=n.childNodes[o._bindingDetails[r].childNodeIndex],s=o._bindingDetails[r].bindingString.length;for(let t=0;t<s;t++){const i=o._bindingDetails[r].bindingString[t],s=0<=i.indexOf("label")?e.label:e.value;l.innerHTML=l.innerHTML.replace(i,s)}}e.innerHTML="";for(let o=0;o<n.childNodes.length;o++)n.childNodes[o].outerHTML&&(e.innerHTML+=n.childNodes[o].outerHTML);!1===t||(o._scrollHeightTimer&&(clearInterval(o._scrollHeightTimer),o._scrollHeightCounter=0),o._scrollHeightTimer=setInterval(function(){(o._lastScrollHeight!==o.$.itemsInnerContainer.scrollHeight||10===o._scrollHeightCounter)&&(o._refreshLayout(),clearInterval(o._scrollHeightTimer)),o._lastScrollHeight=o.$.itemsInnerContainer.scrollHeight,o._scrollHeightCounter++},50))}_filterItems(e,t,i){const o=this,l=o.$.filterInput.value;let s,n;const r=function(){if(0===n.length)return o._filteredItems=[],void(t&&t());s=o._queryItems(l,o.filterMode);for(let e=0;e<n.length;e++)n[e].hidden=!0,n[e].$.addClass("smart-hidden");for(let e=0;e<s.length;e++){const t=s[e];t.hidden=!1,t.$.removeClass("smart-hidden")}if(o.grouped&&o.isVirtualized)for(let e=0;e<o._groups.length;e++){const t=o._groups[e],i=t.items;let l=!0;for(let e=0;e<i.length;e++)i[e].hidden||(l=!1);l&&(t.hidden=!0)}if(o.grouped&&!o.isVirtualized)for(let e=0;e<o._groups.length;e++){const t=o._groups[e],i=[].concat(...t.querySelectorAll("smart-list-item"));let l=!0;for(let e=0;e<i.length;e++)i[e].$.hasClass("smart-hidden")||(l=!1);l?t.$.addClass("smart-hidden"):t.$.removeClass("smart-hidden")}o._filteredItems=s,o._refreshLayout(),t&&t();e||o._refreshSelection()};if("function"!=typeof o.dataSource){if(n=o._items,0===n.length)return;r()}else if(l||i){const e=o.dataSource(l,function(e){(l||i)&&o.isAttached&&(o._updateListBoxAfterQuery=function(){s=n=o._items,r()},o.clearItems(),o.insert(0,e))});if(e){if(!l&&!i)return;o._updateListBoxAfterQuery=function(){s=n=o._items,r()},o.clearItems(),o.insert(0,e)}}else o.clearItems(),s=n=o._items,r()}_getNextItem(e){const t=this,i=t._items,o=t._items.length;for(let t=Math.max(e+1,0);t<o;){const e=i[t];if(!e.disabled&&!e.hidden&&!e.grouped&&!e.readonly)return e;t++}return i[e]}_getPreviousItem(e){const t=this,i=t._items;for(let t=Math.max(e-1,0);-1<t;){const e=i[t];if(!e.disabled&&!e.hidden&&!e.grouped&&!e.readonly)return e;t--}return i[e]}get _scrollWidth(){const e=this,t=e._items;return e.__scrollWidth?e.__scrollWidth:(e.__scrollWidth=(()=>{const e=this;let i,o="";for(let e=0;e<t.length;e++){if(t[e].hidden)continue;const i=t[e].label;i.length>o.length&&(o=i)}const l=e._createItem({label:o});e.$.itemsContainer.appendChild(l),l.label=o,l.style.width="auto",l.isCompleted&&(l.$.itemContainer.style.width="auto");const s=getComputedStyle(l),n=parseInt(s.paddingLeft)+parseInt(s.paddingRight);return i=(l.$.itemContainer||l).offsetWidth+n,l.parentNode.removeChild(l),i})(),e.__scrollWidth)}update(e,t){const i=this,o=i._items[e];if(o){if("string"==typeof t)o.label=t,void 0===o.value&&(o.value=t);else for(let e in t)"selected"==e&&o[e]!==t[e]?i.select(o):o[e]=t[e],"group"==e&&i._refreshItems();(i.sorted||i.grouped||i.isVirtualized)&&(i._refreshItems(),i._refreshSelection())}else i.error(i.localize("indexOutOfBound",{elementType:i.nodeName.toLowerCase(),method:"update"}))}insert(e,t){const o=this;let l=[];if(e||(e=0),Array.isArray(t)){o.isUpdating++;for(let s=0;s<t.length;s++){const i=t[s],n=o._createItem(i);l.push(n),e>=o._items.length||0===o._items.length?o.appendChild(n):o.insertBefore(n,o._items[e])}o.isUpdating--}else{const i=o._createItem(t);l.push(i),e>=o._items.length||0===o._items.length?o.appendChild(i):o.insertBefore(i,o._items[e])}0<l.length&&(l.map(e=>o._applyTemplate(e)),o._ensureItemsReady(l,function(){o._refreshItems(),0===o._items.length||(o._updateListBoxAfterQuery&&(o._updateListBoxAfterQuery(),delete o._updateListBoxAfterQuery),o._refreshSelection(),o.$.fireEvent("bindingComplete"))}))}remove(e){const t=this,i=t._items[e];i?(t.isVirtualized?t._items.splice(e,1):i.parentNode.removeChild(i),i.selected&&t.unselect(i),t._refreshItems(),t._refreshSelection(),0===t.selectedIndexes.length&&0<t._items.length&&("oneOrMany"===t.selectionMode||"one"===t.selectionMode||"oneOrManyExtended"===t.selectionMode)&&t.select(t._items[0])):t.error(t.localize("indexOutOfBound",{elementType:t.nodeName.toLowerCase(),method:"remove"}))}_queryItems(e,t){const o=this,l=[],s=function(i,l){if(i.grouped)return i;switch(t){case"startsWith":if(0===i.label.indexOf(l))return i;break;case"startsWithIgnoreCase":if(0===i.label.toLowerCase().indexOf(l.toLowerCase()))return i;break;case"doesNotContain":if(0>i.label.indexOf(l))return i;break;case"doesNotContainIgnoreCase":if(0>i.label.toLowerCase().indexOf(l.toLowerCase()))return i;break;case"contains":if(-1<i.label.indexOf(l))return i;break;case"containsIgnoreCase":if(-1<i.label.toLowerCase().indexOf(l.toLowerCase()))return i;break;case"equals":if(0===i.label.localeCompare(l))return i;break;case"equalsIgnoreCase":if(0===i.label.toLowerCase().localeCompare(l.toLowerCase()))return i;break;case"endsWith":if(i.label.endsWith(l))return i;break;case"endsWithIgnoreCase":if(i.label.toLowerCase().endsWith(l.toLowerCase()))return i;break;case"custom":if(o.filterCallback(i,e))return i;}return null};if(0===e.length)return o._items;for(let n=0;n<o._items.length;n++){const t=s(o._items[n],e);t&&l.push(t)}return l}_select(e,t){const o=this,i=o.selectedIndexes.indexOf(o._indexOf(e)),l=o.selectedIndexes.slice(0),s=o.selectedValues.slice(0);if(e.selected=!0,-1===i)l.push(o._indexOf(e)),s.push(e.value||e.label);else return o._recycle(),!1;if(o.selectedIndexes=l,o.selectedValues=s,o._recycle(),o.$.hiddenInput.value=s.toString(),o.isCompleted&&!t&&o.isInitialized&&!o._propertyChanging){let t=[];if(o._previouslySelectedIndexes){for(let e=0;e<o._previouslySelectedIndexes.length;e++)0>o.selectedIndexes.indexOf(o._previouslySelectedIndexes[e])&&t.push(o._items[o._previouslySelectedIndexes[e]]);delete o._previouslySelectedIndexes}return o.$.fireEvent("change",{addedItems:[e],removedItems:t,selected:e.selected,disabled:e.disabled,index:o._indexOf(e),label:e.label,value:e.value}),!0}}_setTopVisibleIndex(e){const t=this;return"number"==typeof e&&(t.topVisibleIndex=Math.max(0,e),e=t._items[t.topVisibleIndex]),!!e&&void(e.top!==t.scrollTop&&(t.scrollTop=e.top,!t.isVirtualized&&(t.$.itemsContainer.scrollTop=t.scrollTop),t.scrollHeight===t.scrollTop&&t._updateTopVisibleIndex()))}_updateTopVisibleIndex(){const e=this,t=e.scrollTop+e._scrollView.verticalScrollBar.offsetHeight-e.offsetHeight;let o;if(e.scrollTop<e.scrollHeight/2){for(let l=0;l<e._items.length;l++)if(e._items[l].top>t){o=e._items[l];break}}else for(let l=e._items.length-1;0<=l&&!(e._items[l].top<t);l--)o=e._items[l];o&&(e.topVisibleIndex=o.dataIndex)}unselect(e){const t=this;if(!e)return;if("string"==typeof e&&(e=t.getItem(e),!e))return;if("none"===t.selectionMode)return void t.clearSelection();const i=t.selectedIndexes.indexOf(t._indexOf(e)),o=t.selectedIndexes.slice(0),l=t.selectedValues.slice(0);if(e.selected=!1,0<=i)o.splice(i,1),l.splice(i,1);else return!1;return(t.selectedIndexes=o,t.selectedValues=l,t.$.hiddenInput.value=l.toString(),t.isCompleted&&!t._propertyChanging)?(t.$.fireEvent("change",{addedItems:[],removedItems:[e],selected:e.selected,disabled:e.disabled,index:t._indexOf(e),label:e.label,value:e.value}),t._recycle(),!0):void 0}_handleItemTemplate(e){if(null===e||!e)return;if("function"==typeof e)return e;const t=this;if(!("content"in document.createElement("template")))return t.error(t.localize("htmlTemplateNotSuported",{elementType:t.nodeName.toLowerCase()})),void(t.itemTemplate=null);if(e=document.getElementById(e),null===e||!("content"in e))return t.error(t.localize("invalidTemplate",{elementType:t.nodeName.toLowerCase(),property:"itemTemplate"})),void(t.itemTemplate=null);const o=e.content,l=o.childNodes.length,s=/{{\w+}}/g;let n,r;t._bindingDetails=[],t._template=e;for(let a=0;a<l;a++){for(r=[];n=s.exec(o.childNodes[a].innerHTML);)r.push(n[0]);0<r.length&&t._bindingDetails.push({childNodeIndex:a,bindingString:r})}return!0}_handleKeyStrokes(e){const t=this,i="radioButton"===t.selectionMode||"checkBox"===t.selectionMode||"zeroOrMany"===t.selectionMode||"oneOrMany"===t.selectionMode||"zeroOrOne"===t.selectionMode;let o=t._items;if(t.filterable&&0<t.$.filterInput.value.length&&(o=t._filteredItems),!(t.disabled||t.readonly)){switch(e){case"ArrowLeft":case"ArrowUp":t._handleArrowKeys(!0);break;case"ArrowRight":case"ArrowDown":t._handleArrowKeys(!1);break;case" ":{if(1>t.selectedIndexes.length&&!t._focusedItem)return;const e=t._focusedItem?t._focusedItem:t._items[t.selectedIndexes[t.selectedIndexes.length-1]],i=e=>{e.selected&&"radioButton"!==t.selectionMode?t.unselect(e):t.select(e)};if("oneOrMany"===t.selectionMode)return void(e.selected&&1<t.selectedIndexes.length?i(e):!e.selected&&i(e));i(e);break}case"Home":{if(0===o.length)return;i?t._focus(o[0]):(!t._keysPressed.Shift&&t.clearSelection(),t.select(o[0]),t._focus(o[0])),t.scrollTop=0;break}case"End":{if(0===o.length)return;i?t._focus(o[o.length-1]):(!t._keysPressed.Shift&&t.clearSelection(),t.select(o[o.length-1]),t._focus(o[o.length-1])),t.scrollTop=t.scrollHeight;break}case"PageUp":{t._pageUpKeyHandler(o);break}case"PageDown":{t._pageDownKeyHandler(o);break}}t._recycle()}}_horizontalScrollbarHandler(e){const t=this;e.stopPropagation(),t.isVirtualized?t._recycle():t.$.itemsContainer.scrollLeft=e.detail.value}_unsort(){const e=this;e.isUpdating++;const t=function(e,t){let i=e.dataIndex,o=t.dataIndex;return i<o?-1:i>o?1:0};if(!e.isVirtualized){if(0<e._groups.length){e._groups.sort(t);let o=[];for(let l=0;l<e._groups.length;l++){const i=e._groups[l],s=[].concat(...i.querySelectorAll("smart-list-item"));s.sort(t),o=o.concat(s)}e._items=o}else e._items.sort(t);e._applySortOrder()}else if(0<e._groups.length){e._groups.sort(t);let o=[];for(let l=0;l<e._groups.length;l++){const i=e._groups[l],s=[].concat(...i.items);s.sort(t),o.push(i),o=o.concat(s)}e._items=o}else e._items.sort(t);e.isUpdating--}_applySortOrder(){const e=this,t=function(e){for(let t=0;t<e.length;t++){const i=e[t],o=i.parentNode;o&&o.appendChild(i)}};t(e._items),t(e._groups)}_sort(){const e=this;if(e._canSort){e.isUpdating++;const t=function(t,i){let o=t.label,l=i.label;if("asc"===e.sortDirection){if(o<l)return-1;if(o>l)return 1}else{if(o<l)return 1;if(o>l)return-1}return 0};if(e._groups.sort(t),!e.isVirtualized){if(0<e._groups.length){let o=[];for(let l=0;l<e._groups.length;l++){const i=e._groups[l],s=[].concat(...i.querySelectorAll("smart-list-item"));s.sort(t),o=o.concat(s)}e._items=o}else e._items.sort(t);e._applySortOrder()}else if(0<e._groups.length){let o=[];for(let l=0;l<e._groups.length;l++){const i=e._groups[l],s=[].concat(...i.items);o.push(i),s.sort(t),o=o.concat(s)}e._items=o}else e._items.sort(t);e.isUpdating--}}getItem(e){const t=this;for(let o=0;o<t._items.length;o++)if(t._items[o].value===e)return t._items[o];return null}_focus(e){const t=this;!e||"none"===t.selectionMode||t.disabled||t.readonly||(t._focusedItem&&(t._focusedItem._focused=!1),t._focusedItem=e,t._focusedItem._focused=!0)}_keyDownHandler(e){const t=this,i=(t.shadowRoot||t.getRootNode()).activeElement||document.activeElement;let o=e.key;if(!(t.disabled||t.readonly)&&!(t.filterable&&t.$.filterInput===i)&&t._focused&&!(0===t._items.length||t.disabled||t.displayLoadingIndicator)){if(t.editable){if("F2"===o)return void t._dblclickEventHandler({target:t._focusedItem});if(t.$.editInput===i)return}if("none"!==t.selectionMode){if(e.stopPropagation(),"Down"===o||"Right"===o||"Left"===o||"Up"===o?o="Arrow"+o:void 0,t.filterable)switch(o){case"ArrowLeft":case"ArrowRight":return;case"ArrowUp":case"ArrowDown":e.preventDefault();}if(t._applyIncrementalSearch(o),!(0>["Shift","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Control"," ","Home","End","PageUp","PageDown"].indexOf(o))){if(e.preventDefault(),!t._focusedItem&&0<t._items.length)return void("one"===t.selectionMode||"oneOrMany"===t.selectionMode||"oneOrManyExtended"===t.selectionMode?t.select(t._items[0]):t._focus(t._items[0]));switch(t.selectionMode){case"one":if("Shift"===o||"Control"===o||" "===o)return;t._handleKeyStrokes(o);break;case"oneOrMany":case"zeroOrOne":case"zeroOrMany":case"radioButton":case"checkBox":if("Shift"===o||"Control"===o)return;t._handleKeyStrokes(o);break;case"oneOrManyExtended":if(" "===o)return;t._keysPressed[o]="keydown"===e.type,t._handleKeyStrokes(o);}}}}}_keyUpHandler(e){const t=this,i=(t.shadowRoot||t.getRootNode()).activeElement||document.activeElement;if(!(t.editable&&t.$.editInput===i)){if(t.filterable&&t.$.filterInput===i)return t._filterTimer&&clearTimeout(t._filterTimer),void(t._filterTimer=setTimeout(function(){const e=t.context;t.context=t,t._filterItems(),t.scrollTop=t.$.itemsContainer.scrollTop=0,t.scrollLeft=t.$.itemsContainer.scrollLeft=0,t.context=e},300));if(t._focused){if(t._focusedItem&&t._focusedItem.hidden&&0<t._filteredItems.length){let e=t._filteredItems[0];e.grouped&&1<t._filteredItems.length&&(e=t._filteredItems[1]),t._focus(e),t._recycle()}e.stopPropagation(),e.preventDefault(),t.disabled||0>["Shift","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Control"," ","PageUp","PageDown"].indexOf(e.key)||(t._keysPressed[e.key]=!1)}}}_mouseWheelHandler(e){const t=this;(t.computedHorizontalScrollBarVisibility||t.computedVerticalScrollBarVisibility)&&(t.disabled||!t.computedVerticalScrollBarVisibility||(e.stopPropagation(),e.preventDefault(),t.scrollTo(t.scrollTop+t._getScrollCoefficient(e,t.offsetHeight))))}_pageDownKeyHandler(e){const t=this;if(0===e.length)return;let i=t._items[t.selectedIndexes[t.selectedIndexes.length-1]];("checkBox"===t.selectionMode||"radioButton"===t.selectionMode||"zeroOrMany"===t.selectionMode||"oneOrMany"===t.selectionMode||"zeroOrOne"===t.selectionMode)&&t._focusedItem&&(i=t._focusedItem);let o;const l=t._indexOf(i);let s=i.top+t.$.itemsContainer.offsetHeight-i.height;for(let t=l;t<e.length;t++)if(e[t].top>=s){o=e[t];break}o||(o=e[e.length-1]),"checkBox"===t.selectionMode||"radioButton"===t.selectionMode||"zeroOrMany"===t.selectionMode||"oneOrMany"===t.selectionMode||"zeroOrOne"===t.selectionMode?t._focus(o):!o.selected&&(!t._keysPressed.Shift&&t.clearSelection(),t.select(o),t._focus(o)),(o.height+o.top>t.$.itemsContainer.scrollTop+t.$.itemsContainer.offsetHeight||o.top<t.$.itemsContainer.scrollTop)&&(t.scrollTop=o.top-t.$.itemsContainer.offsetHeight+o.height)}_pageUpKeyHandler(e){const t=this;if(0===e.length)return;let i=t._items[t.selectedIndexes[t.selectedIndexes.length-1]];("checkBox"===t.selectionMode||"radioButton"===t.selectionMode||"zeroOrMany"===t.selectionMode||"oneOrMany"===t.selectionMode||"zeroOrOne"===t.selectionMode)&&t._focusedItem&&(i=t._focusedItem);const o=i.top-t.$.itemsContainer.offsetHeight,l=t._indexOf(i);let s;for(let t=l;0<t;t--)if(e[t].top<=o){s=e[t];break}s||(s=e[0]),"checkBox"===t.selectionMode||"radioButton"===t.selectionMode||"zeroOrMany"===t.selectionMode||"oneOrMany"===t.selectionMode||"zeroOrOne"===t.selectionMode?t._focus(s):!s.selected&&(!t._keysPressed.Shift&&t.clearSelection(),t.select(s),t._focus(s)),t.scrollTop=s.top;const n=t._indexOf(s);0===n&&(t.scrollTop=0)}clearItems(){const e=this;e.$.itemsInnerContainer.innerHTML="",e.clearSelection(),e._items=[],e.$placeholder.removeClass("smart-hidden")}_resizeHandler(e){const t=this;e.target!==t||t._isUpdatingScrollBars||(t._isUpdatingScrollBars=!0,t._initializeRecyclingItems(),t._refreshLayout(),t._isUpdatingScrollBars=!1)}_indexOf(e){const t=this;if(!e)return-1;let i=t._items.indexOf(e);return-1===i&&(i=t._items.indexOf(t.getItem(e.value))),i}_incrementalSearch(){const e=this,t="radioButton"!==e.selectionMode&&"checkBox"!==e.selectionMode&&"zeroOrMany"!==e.selectionMode&&"oneOrMany"!==e.selectionMode&&"zeroOrOne"!==e.selectionMode;let o,l=0;switch(e.incrementalSearchMode){case"containsIgnoreCase":case"equalsIgnoreCase":case"startsWithIgnoreCase":case"endsWithIgnoreCase":o=e._incrementalSearchQuery.toLowerCase();break;default:o=e._incrementalSearchQuery;}const s=function(i){i.grouped||i.readonly||(t?(0<e.selectedIndexes.length&&e.clearSelection(),e._focus(i),e.select(i)):e._focus(i),(i.height+i.top>e.$.itemsContainer.scrollTop+e.$.itemsContainer.offsetHeight||i.top<e.scrollTop)&&(e.scrollTop=i.top),0===e._indexOf(i)&&(e.scrollTop=0),e._indexOf(i)===e._items.length-1&&(e.scrollTop=e.scrollHeight))};0!==e._previousEntry.localeCompare(o)&&(e._incrementalSearchItems=e._queryItems(e._incrementalSearchQuery,e.incrementalSearchMode),delete e._itemPosition),e._previousEntry=o;const n=e._incrementalSearchItems.length;if(0!==n){if(1===n)return void s(e._incrementalSearchItems[0]);for(void 0===e._itemPosition?t&&e.clearSelection():e._itemPosition<n-1?l=e._itemPosition:(l=0,t?(e._incrementalSearchItems[e._itemPosition].selected=!1,e.selectedIndexes=[],e.selectedValues=[]):e._incrementalSearchItems[e._itemPosition]._focused=!1),l;l<n;l++){if(e._incrementalSearchItems[l].selected&&t){e._incrementalSearchItems[l].selected=!1,e.selectedIndexes=[],e.selectedValues=[];continue}if(!t&&e._incrementalSearchItems[l]._focused){e._incrementalSearchItems[l]._focused=!1;continue}return s(e._incrementalSearchItems[l]),void(e._itemPosition=l)}}}_selectStartHandler(e){const t=this,i=(t.shadowRoot||t.getRootNode()).activeElement;t.$.filterInput===i||t.$.editInput===i||e.preventDefault()}_handleArrowKeys(e){const t=this,i="radioButton"!==t.selectionMode&&"checkBox"!==t.selectionMode&&"zeroOrMany"!==t.selectionMode&&"oneOrMany"!==t.selectionMode&&"zeroOrOne"!==t.selectionMode;if(t.disabled||t.readonly)return;let o;if(t._focusedItem&&!t._keysPressed.Shift)o=t._indexOf(t._focusedItem),t._focusedItem._focused=!1;else if(0!==t.selectedIndexes.length)o=t.selectedIndexes[t.selectedIndexes.length-1];else return;const l=e?t._getPreviousItem(o):t._getNextItem(o);t._focus(l),i&&(t._keysPressed.Shift?t.select(l):t._items[o]!==l&&(t.clearSelection(),t.select(l))),t.ensureVisible(l)}_refreshFilter(){const e=this;return e.filterable?(e.$.filterInput.disabled=!!(e.disabled||e.displayLoadingIndicator),e.$filterInputContainer.removeClass("smart-hidden"),void e.$itemsContainer.addClass("filter")):void(e.$.filterInput.disabled=!0,e.$filterInputContainer.addClass("smart-hidden"),e.$itemsContainer.removeClass("filter"))}_setFocusable(){const e=this;return e.disabled||e.unfocusable?void e.removeAttribute("tabindex"):void(e.tabIndex=0<e.tabIndex?e.tabIndex:0)}_setLoadingIndicatorVisibility(){const e=this;return e.displayLoadingIndicator?void(e.$loadingIndicatorContainer.hasClass("smart-visibility-hidden")?e.$loadingIndicatorContainer.removeClass("smart-visibility-hidden"):e.$loadingIndicatorContainer.removeClass("smart-hidden")):void(e._areCSSVarsSupported?e.$loadingIndicatorContainer.addClass("smart-hidden"):e.$loadingIndicatorContainer.addClass("smart-visibility-hidden"))}_refreshLayout(){var e=Math.max;const t=this,i=t._items;if(t.__scrollHeight=null,t.__scrollWidth=null,t._height=null,t._scrollView||(t._scrollView=new Smart.Utilities.Scroll(t,t.$.horizontalScrollBar,t.$.verticalScrollBar)),t.$itemsContainer.removeClass("hscroll"),t.$itemsContainer.removeClass("vscroll"),!i||null===i||0===i.length)return t.scrollWidth=0,t.scrollHeight=0,t.$filterInputContainer.removeClass("vscroll"),t.$placeholder.removeClass("smart-hidden"),void(t.isVirtualized&&t._recycle());t.$placeholder.addClass("smart-hidden");const o=2*(parseInt(getComputedStyle(t.$.itemsInnerContainer).getPropertyValue("--smart-list-item-horizontal-offset"))||0);let l=t._scrollWidth-t.$.itemsContainer.offsetWidth-o,s=t._scrollHeight;if(t._refreshHorizontalScrollBarVisibility(l),t._refreshVerticalScrollBarVisibility(s),t.$.itemsInnerContainer.style.width="hidden"===t.horizontalScrollBarVisibility?t.$.itemsContainer.offsetWidth-o:e(t.$.itemsContainer.offsetWidth-o,-o+t.__scrollWidth)+"px",t.computedVerticalScrollBarVisibility)return l=t._scrollWidth-t.$.itemsContainer.offsetWidth-t._scrollView.vScrollBar.offsetWidth,t._refreshHorizontalScrollBarVisibility(l),"hidden"!==t.horizontalScrollBarVisibility&&(t.$.itemsInnerContainer.style.width=e(t.$.itemsContainer.offsetWidth-o,-o+t.__scrollWidth-t._scrollView.vScrollBar.offsetWidth)+"px"),t.computedHorizontalScrollBarVisibility&&("visible"===t.horizontalScrollBarVisibility&&0===t.scrollWidth?"visible"===t.horizontalScrollBarVisibility&&(t.__scrollHeight+=t._scrollView.hScrollBar.offsetHeight):t.__scrollHeight+=t._scrollView.hScrollBar.offsetHeight,t.scrollHeight=t.__scrollHeight),void(t.isVirtualized&&t._recycle());l=t._scrollWidth-t.$.itemsContainer.offsetWidth-o,t._refreshHorizontalScrollBarVisibility(l),t.computedHorizontalScrollBarVisibility&&(t.scrollHeight=t._scrollHeight,t._refreshVerticalScrollBarVisibility(t.scrollHeight),t._scrollView.vScrollBar.$.hasClass("bottom-corner")&&t._scrollView.vScrollBar.refresh()),t.isVirtualized&&t._recycle();const n=/Trident|Edge/.test(navigator.userAgent);!t.isRefreshing&&n&&setTimeout(function(){t.isRefreshing=!0,t._refreshLayout(),t.isRefreshing=!1},50)}_styleChangedHandler(){const e=this;e._refreshLayout()}_swipeLeftHandler(){}_swipeRightHandler(){}_refreshHorizontalScrollBarVisibility(e){const t=this;t.scrollWidth=e,t.computedHorizontalScrollBarVisibility?(t.scrollLeft=t.$.itemsContainer.scrollLeft,t.$itemsContainer.addClass("hscroll")):t.$itemsContainer.removeClass("hscroll")}_refreshVerticalScrollBarVisibility(e){const t=this;t.scrollHeight=e,t.computedVerticalScrollBarVisibility?(t.$itemsContainer.addClass("vscroll"),t.$filterInputContainer.addClass("vscroll")):(t.$itemsContainer.removeClass("vscroll"),t.$filterInputContainer.removeClass("vscroll"))}_validateTemplate(e,t){if(null!==t&&t){const i=this;return"content"in document.createElement("template")?(t=document.getElementById(t),null!==t&&"content"in t?t:(i.error(i.localize("invalidTemplate",{elementType:i.nodeName.toLowerCase(),property:e})),void(i[e]=null))):(i.error(i.localize("htmlTemplateNotSuported",{elementType:i.nodeName.toLowerCase()})),void(i[e]=null))}}_getItemIndexByPosition(e){const t=this,i=t.filterable&&0<t.$.filterInput.value.length?t._filteredItems:t._items,o=(i=>{let o=0,l=i.length-1;if(0>=e)return 0;const s=i[i.length-1];if(s.top<=e)return i.length-1;for(;!0;){const s=Math.floor((o+l)/2),n=i[s];if(t._isItemInPosition(n,e))return s;n.top<e?o=s+1:n.top>e&&(l=s-1)}})(i);return o}_isItemInPosition(e,t){const i=e.top,o=e.top+e.height;return i<=t&&o>t}get isVirtualized(){const e=this;return e.virtualized&&e.dataSource&&0<e.dataSource.length}_recycle(){const e=this;if(!e._recyclingItems)return;let t=e._height;e._height||(t=e._height=e.$.itemsContainer.offsetHeight);let o=0;const i=e.scrollTop,l=e._getItemIndexByPosition(i),s=e.filterable&&0<e.$.filterInput.value.length?e._filteredItems:e._items,n=s[l];let r=n?n.top:0;if(e.$.itemsInnerContainer.style.left=-e.scrollLeft+"px",e.$.itemsInnerContainer.style.top=-i+r+"px",e.isUpdating++,0<=l)for(let n=l;n<s.length;n++){const l=s[n];if(0!==l.height){if(r+l.height>=i&&r<=i+t){const t=e._recyclingItems[o++];if(!t)break;t.context=document,t.dataItem=l,t.label=l.label,t.value=l.value,t.selected=l.selected,t._focused=l._focused,t.hidden=l.hidden,t.grouped=l.grouped,t.readonly=l.readonly,t.style.height=l.height+"px",e._alternateItem(t),t.title=l.title?l.title:"",t.displayMode=l.grouped?"plain":l.displayMode,0<e.scrollWidth&&(t.style.width=e.$.itemsInnerContainer.offsetWidth+e.scrollWidth+"px"),e.itemTemplate&&e._handleItemTemplate(e.itemTemplate)&&e._applyTemplate(t,!1)}else break;r+=l.height}}if(o<e._recyclingItems.length)for(let t=o;t<e._recyclingItems.length;t++){const t=e._recyclingItems[o++],i=t.context;t.context=document,t.hidden=!0,t.context=i}e.isUpdating--}_verticalScrollbarHandler(e){const t=this,i=e.detail.value;return e.stopPropagation(),t.isVirtualized?t._recycle():t.$.itemsContainer.scrollTop=i,t._updateTopVisibleIndex(),e.context.max===e.context.value?void t.$.fireEvent("scrollBottomReached"):void(e.context.min===e.context.value&&t.$.fireEvent("scrollTopReached"))}});