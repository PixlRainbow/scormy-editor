
/* Smart HTML Elements v4.6.0 (2019-Oct) 
Copyright (c) 2011-2019 jQWidgets. 
License: https://htmlelements.com/license/ */

Smart("smart-drop-down-list",class extends Smart.ContentElement{static get properties(){return{autoCloseDelay:{value:100,type:"number"},dataSource:{value:null,type:"any",reflectToAttribute:!1},displayLoadingIndicator:{value:!1,type:"boolean"},displayMember:{value:"",type:"string"},displayMode:{allowedValues:["outlined","filled","underlined"],value:"outlined",type:"string"},dropDownAppendTo:{value:null,type:"any"},dropDownButtonPosition:{allowedValues:["none","left","right","top","bottom"],value:"right",type:"string"},dropDownMinHeight:{value:"",type:"any",validator:"_propertyValidator"},dropDownHeight:{value:"",type:"any",validator:"_propertyValidator"},dropDownMaxHeight:{value:"",type:"any",validator:"_propertyValidator"},dropDownOpenMode:{allowedValues:["none","default","dropDownButton","auto"],value:"default",type:"string"},dropDownOverlay:{value:!1,type:"boolean"},dropDownPlaceholder:{value:"No Items",type:"string"},dropDownPosition:{allowedValues:["auto","top","bottom","overlay-top","overlay-center","overlay-bottom","center-bottom","center-top"],value:"auto",type:"string"},dropDownMinWidth:{value:"",type:"any",validator:"_propertyValidator"},dropDownWidth:{value:"",type:"any",validator:"_propertyValidator"},dropDownMaxWidth:{value:"",type:"any",validator:"_propertyValidator"},filterable:{value:!1,type:"boolean"},filterInputPlaceholder:{value:"",type:"string"},filterCallback:{value:null,type:"function?"},filterMode:{value:"startsWithIgnoreCase",allowedValues:["contains","containsIgnoreCase","doesNotContain","doesNotContainIgnoreCase","equals","equalsIgnoreCase","startsWith","startsWithIgnoreCase","endsWith","endsWithIgnoreCase","custom"],type:"string"},grouped:{value:!1,type:"boolean"},groupMember:{value:"",type:"string"},hint:{value:"",type:"string"},horizontalScrollBarVisibility:{type:"string",value:"auto",allowedValues:["auto","disabled","hidden","visible"]},incrementalSearchDelay:{value:700,type:"number?"},incrementalSearchMode:{value:"startsWithIgnoreCase",allowedValues:["contains","containsIgnoreCase","doesNotContain","doesNotContainIgnoreCase","equals","equalsIgnoreCase","startsWith","startsWithIgnoreCase","endsWith","endsWithIgnoreCase"],type:"string"},inputMember:{value:"label",type:"string"},itemTemplate:{value:null,type:"any"},itemHeight:{value:null,type:"number?"},label:{value:"",type:"string"},loadingIndicatorPlaceholder:{value:"Loading...",type:"string"},loadingIndicatorPosition:{value:"center",allowedValues:["bottom","center","top"],type:"string"},messages:{extend:!0,value:{en:{invalidNode:"{{elementType}}: Invalid parameter \"{{node}}\" when calling {{method}}."}},type:"object"},name:{value:"",type:"string"},opened:{value:!1,type:"boolean"},placeholder:{value:"",type:"string"},resizeMode:{value:"none",allowedValues:["none","horizontal","vertical","both"],type:"string"},resizeIndicator:{value:!1,type:"boolean"},selectionDisplayMode:{value:"plain",allowedValues:["plain","placeholder","tokens"],type:"string"},selectionMode:{value:"one",allowedValues:["none","oneOrManyExtended","zeroOrMany","oneOrMany","zeroOrOne","one","checkBox","radioButton"],type:"string"},selectedIndexes:{value:[],type:"array"},selectedValues:{value:[],type:"array"},sorted:{value:!1,type:"boolean"},tokenTemplate:{value:null,type:"any"},type:{value:"list",type:"string",defaultReflectToAttribute:!0,readonly:!0},valueMember:{value:"",type:"string"},virtualized:{value:!1,type:"boolean"},verticalScrollBarVisibility:{type:"string",value:"auto",allowedValues:["auto","disabled","hidden","visible"]}}}static get listeners(){return{"actionButton.down":"_buttonsDownHandler","actionButton.mouseenter":"_buttonsMouseEventsHandler","actionButton.mouseleave":"_buttonsMouseEventsHandler","actionButton.focus":"_buttonsFocusHandler","actionButton.blur":"_buttonsFocusHandler","document.selectstart":"_selectStartHandler","document.dragstart":"_dragStartHandler","document.down":"_documentDownHandler","document.up":"_documentUpHandler","document.move":"_documentMoveHandler","dropDownButton.down":"_buttonsDownHandler","dropDownButton.mouseenter":"_buttonsMouseEventsHandler","dropDownButton.mouseleave":"_buttonsMouseEventsHandler",keydown:"_keyDownHandler",keyup:"_keyUpHandler",focus:"_focusEventHandler",blur:"_blurEventHandler","dropDownButton.focus":"_buttonsFocusHandler","dropDownButton.blur":"_buttonsFocusHandler","dropDownContainer.transitionend":"_dropDownTransitionendHandler","listBox.change":"_listBoxChangeHandler","listBox.itemClick":"_listBoxItemClickHandler","listBox.keydown":"_listBoxKeyDownHandler","listBox.bindingComplete":"_bindingCompleteHandler",mouseenter:"_mouseEnterHandler",mouseleave:"_mouseLeaveHandler",resize:"_resizeHandler","resizeBar.move":"_resizeBarMoveHandler",styleChanged:"_styleChangedHandler",wheel:"_mouseWheelHandler"}}template(){return`<div id="container">
                    <span class="smart-label" id="label">[[label]]</span>
                    <div id="content" class="smart-content">
                        <div class="smart-buttons-container" id="buttonsContainer">
                            <span id="actionButton" class="smart-input smart-action-button"></span>
                            <span id="dropDownButton" class="smart-drop-down-button">
                                <span id="arrow"></span>
                            </span>
                        </div>
                        <div id="dropDownContainer" class="smart-drop-down smart-drop-down-container smart-visibility-hidden">
                            <smart-list-box id="listBox" unfocusable
                                    animation="[[animation]]"
                                    data-source="[[dataSource]]"
                                    disabled="[[disabled]]"
                                    display-loading-indicator="[[displayLoadingIndicator]]"
                                    display-member="[[displayMember]]"
                                    filterable="[[filterable]]"
                                    filter-callback="[[filterCallback]]"
                                    filter-mode="[[filterMode]]"
                                    filter-input-placeholder="[[filterInputPlaceholder]]"
                                    grouped="[[grouped]]"
                                    group-member="[[groupMember]]"
                                    item-height="[[itemHeight]]"
                                    item-template="[[itemTemplate]]"
                                    incremental-search-delay="[[incrementalSearchDelay]]"
                                    incremental-search-mode="[[incrementalSearchMode]]"
                                    loading-indicator-placeholder="[[loadingIndicatorPlaceholder]]"
                                    loading-indicator-position="[[loadingIndicatorPosition]]"
                                    name="[[name]]"
                                    placeholder="[[dropDownPlaceholder]]"
                                    readonly="[[readonly]]"
                                    selected-indexes="{{selectedIndexes}}"
                                    selection-mode="[[selectionMode]]"
                                    selected-values="{{selectedValues}}"
                                    sorted="[[sorted]]"
                                    theme="[[theme]]"
                                    value-member="[[valueMember]]"
                                    horizontal-scroll-bar-visibility="[[horizontalScrollBarVisibility]]"
                                    vertical-scroll-bar-visibility="[[verticalScrollBarVisibility]]"
                                    virtualized="[[virtualized]]">
                                <content></content>
                            </smart-list-box>
                            <div id="resizeBar" class="smart-drop-down-resize-bar">
                                <div></div>
                            </div>
                         </div>
                    </div>
                    <span class="smart-hint" id="hint">[[hint]]</span>
                </div>`}static get styleUrls(){return["smart.dropdownlist.css","smart.dropdown.css"]}propertyChangedHandler(a,b,c){super.propertyChangedHandler(a,b,c);const d=this;switch(a){case"animation":d.$.dropDownContainer.setAttribute("animation",d.animation);break;case"disabled":d._setFocusable(),d.close(),d._positionDetection.handleAutoPositioning();break;case"dataSource":case"displayMember":case"inputMember":d.$.actionButton&&(d.$.actionButton.innerHTML=d.placeholder),d._setDropDownSize(),d._positionDetection.checkBrowserBounds("vertically"),d._positionDetection.positionDropDown(),d._positionDetection.checkBrowserBounds("horizontally");break;case"dropDownAppendTo":d._positionDetection.dropDownAppendToChangedHandler();break;case"dropDownOpenMode":d._setFocusable(),d.$dropDownContainer.addClass("smart-visibility-hidden"),d.$.dropDownButton.removeAttribute("selected"),d.removeAttribute("drop-down-button-focus"),d.removeAttribute("action-button-focus"),d.opened=!1;break;case"dropDownOverlay":c||d._positionDetection.removeOverlay();break;case"dropDownPosition":d._positionDetection.dropDownPositionChangedHandler();break;case"dropDownMinWidth":case"dropDownWidth":case"dropDownMaxWidth":case"dropDownHeight":case"dropDownMinHeight":case"dropDownMaxHeight":d._setDropDownSize();break;case"opened":if(d.disabled||d.readonly)return;c?d.open():d.close();break;case"placeholder":d._applySelection();break;case"readonly":d.close();break;case"resizeIndicator":c?d.$.dropDownContainer.setAttribute("resize-indicator",""):d.$.dropDownContainer.removeAttribute("resize-indicator");break;case"resizeMode":d.$.dropDownContainer.setAttribute("resize-mode",d.resizeMode);break;case"selectedValues":case"selectedIndexes":0===c.length?d.$.actionButton.innerHTML=d.placeholder:d._applySelection();break;case"selectionDisplayMode":d._applySelection();break;case"tokenTemplate":d._tokenTemplate=d._validateTemplate(d.tokenTemplate),d._applySelection();break;case"unfocusable":d._setFocusable();}}appendChild(a){const b=this;if(!b.isCompleted||a instanceof HTMLElement&&a.classList.contains("smart-resize-trigger-container")){const a=Array.prototype.slice.call(arguments,2);return HTMLElement.prototype.appendChild.apply(b,a.concat(Array.prototype.slice.call(arguments)))}return a?void(b.$.listBox.appendChild(a),b._dropDownSize&&"auto"===b._dropDownSize.height&&b._setDropDownSize()):void b.error(b.localize("invalidNode",{elementType:b.nodeName.toLowerCase(),method:"appendChild",node:"node"}))}attached(){const a=this;super.attached();a.isCompleted&&a.$.dropDownContainer&&(a._positionDetection.dropDownAttached("_setDropDownSize"),a._positionDetection.checkBrowserBounds())}detached(){const a=this;super.detached();a.$.dropDownContainer&&(a.close(),a._positionDetection&&a._positionDetection.dropDownDetached())}clearItems(){const a=this;a.$.listBox&&(a.$.listBox.clearItems(),a.$.actionButton.innerHTML=a.placeholder)}clearSelection(){const a=this;a.$.listBox&&(a.$.listBox.clearSelection(),a.$.actionButton.innerHTML=a.placeholder)}close(){const a=this;if(!a.$dropDownContainer.hasClass("smart-visibility-hidden")){const b=a.$.fireEvent("closing").defaultPrevented;b||(a.$dropDownContainer.addClass("smart-visibility-hidden"),a.$.fireEvent("close"),a.$.dropDownButton&&a.$.dropDownButton.removeAttribute("selected"),a.opened=!1,a._preventDropDownClose=!1,a._positionDetection.removeOverlay(!0),a._edgeMacFF&&!a.hasAnimation&&a.$.dropDownContainer&&(a.$.dropDownContainer.style.top=a.$.dropDownContainer.style.left="",a.$dropDownContainer.addClass("not-in-view")))}}cloneNode(){const a=this;if(a.$.listBox){let b=HTMLElement.prototype.cloneNode.apply(a,Array.prototype.slice.call(arguments,0,1));return b.dataSource=a.dataSource,b}}ensureVisible(a){const b=this;b.$.listBox&&b.$.listBox.ensureVisible(a)}getItem(a){const b=this;return b.$.listBox?b.$.listBox.getItem(a):void 0}get items(){const a=this;return a.$&&a.$.listBox?a.$.listBox.items:void 0}get _focusedItem(){const a=this;return a.$&&a.$.listBox?a.$.listBox._focusedItem:void 0}insert(a,b){const c=this;c.$.listBox&&(c.$.listBox.insert(a,b),c._applySelection(),c._dropDownSize&&"auto"===c._dropDownSize.height&&c._setDropDownSize())}insertBefore(a,b){const c=this;if(!c.isCompleted){const a=Array.prototype.slice.call(arguments,2);return HTMLElement.prototype.insertBefore.apply(c,a.concat(Array.prototype.slice.call(arguments)))}return a&&b?void(!c.$.listBox||(c.$.listBox.insertBefore(a,b),c._dropDownSize&&"auto"===c._dropDownSize.height&&c._setDropDownSize())):void c.error(c.localize("invalidNode",{elementType:c.nodeName.toLowerCase(),method:"insertBefore",node:"newNode/referenceNode"}))}open(){const a=this,b=function(){for(let b=0;b<a.items.length;b++)if(!a.items[b].disabled)return a.items[b]};if(!a.disabled&&a.offsetHeight&&a.$dropDownContainer.hasClass("smart-visibility-hidden")){if(a.$dropDownContainer.hasClass("not-in-view")&&a.$dropDownContainer.removeClass("not-in-view"),a.$.dropDownContainer.style.transition=null,a.dropDownAppendTo&&0<a.dropDownAppendTo.length){const b=a.getBoundingClientRect();if(a.$.container.contains(a.$.dropDownContainer)){let b=0;const c=setInterval(function(){const d=a.getBoundingClientRect();b++,d.top===a._positionTop&&10>b||(a.open(),clearInterval(c),a._positionTop=d.top)},100);return}b.top!==a._positionTop&&(a._positionTop=b.top)}const c=a.$.fireEvent("opening").defaultPrevented;c||(a._shadowDOMStylesDelay&&(a._setDropDownSize(),delete a._shadowDOMStylesDelay),a.opened=!0,a._positionDetection.placeOverlay(),a._positionDetection.checkBrowserBounds("vertically"),a._positionDetection.positionDropDown(),a._positionDetection.checkBrowserBounds("horizontally"),a.$dropDownContainer.removeClass("smart-visibility-hidden"),a.$.fireEvent("open"),a.$.dropDownButton&&("dropDownButton"===a.dropDownOpenMode?a.$.dropDownButton.setAttribute("selected",""):a.$.dropDownButton.removeAttribute("selected")),(a.$.listBox&&!a._focusedItem||a._focusedItem&&!a._focusedItem._focused)&&(0<a.selectedIndexes.length?a._focus(a.items[a.selectedIndexes[0]]):a._focus(b)),a.$.input&&!Smart.Utilities.Core.isMobile&&a.$.input.focus())}}ready(){super.ready()}render(){const a=this;a.$.dropDownContainer&&(a._positionDetection=new Smart.Utilities.PositionDetection(a,a.$.dropDownContainer,a.$.container,"close"),a._positionDetection.getDropDownParent(!0),a._positionDetection.setDropDownPosition(),a._calculateDropDownSize(),a.$.dropDownContainer.setAttribute("resize-mode",a.resizeMode),a.resizeIndicator&&a.$.dropDownContainer.setAttribute("resize-indicator",""),a._positionDetection.handleAutoPositioning()),a.opened&&a.open(),a._positionTop=a.getBoundingClientRect().top,a._edgeMacFF=Smart.Utilities.Core.Browser.Edge||Smart.Utilities.Core.Browser.Firefox&&-1!==navigator.platform.toLowerCase().indexOf("mac"),a._edgeMacFF&&a.hasAnimation&&a.$.dropDownContainer&&a.$dropDownContainer.addClass("not-in-view"),a._createElement(),super.render()}remove(a){const b=this;b.$.listBox&&(b.$.listBox.remove(a),b._applySelection(),b._dropDownSize&&"auto"===b._dropDownSize.height&&b._setDropDownSize())}removeChild(a){const b=this;if(!b.isCompleted||a instanceof HTMLElement&&a.classList.contains("smart-resize-trigger-container")){const a=Array.prototype.slice.call(arguments,2);return HTMLElement.prototype.removeChild.apply(b,a.concat(Array.prototype.slice.call(arguments)))}return a&&a instanceof Smart.ListItem?void(b.$.listBox.removeChild(a),b._dropDownSize&&"auto"===b._dropDownSize.height&&b._setDropDownSize()):void b.error(b.localize("invalidNode",{elementType:b.nodeName.toLowerCase(),method:"removeChild",node:"node"}))}select(a){const b=this;b.$.listBox&&b.$.listBox.select(a)}_setFocusable(){const a=this;if(a.disabled||a.unfocusable)return a.removeAttribute("tabindex"),a.$.actionButton.removeAttribute("tabindex"),void a.$.dropDownButton.removeAttribute("tabindex");let b=0<a.tabIndex?a.tabIndex:0;"dropDownButton"===a.dropDownOpenMode?(a.removeAttribute("tabindex"),a.$.actionButton.setAttribute("tabindex",b),a.$.dropDownButton.setAttribute("tabindex",b)):(a.$.actionButton.removeAttribute("tabindex"),a.$.dropDownButton.removeAttribute("tabindex"),a.tabIndex=b)}static get requires(){return{"Smart.ListBox":"smart.listbox.js"}}unselect(a){const b=this;b.$.listBox&&b.$.listBox.unselect(a)}update(a,b){const c=this;c.$.listBox&&(c.$.listBox.update(a,b),c._applySelection())}_resizeBarMoveHandler(a){"touchmove"===a.originalEvent.type&&a.originalEvent.preventDefault()}_createToken(){const a=this;let b;const c=document.createDocumentFragment(),d=a.selectedIndexes[a.selectedIndexes.length-1];b="plain"===a.selectionDisplayMode&&("one"===a.selectionMode||"zeroOrOne"===a.selectionMode||"radioButton"===a.selectionMode)?"":"tokens"===a.selectionDisplayMode?1===a.selectedIndexes.length&&-1<["oneOrManyExtended","oneOrMany","one","radioButton"].indexOf(a.selectionMode)?"":"&#10006":1===a.selectedIndexes.length?"":",";const e=a.selectedIndexes,f=a.$.listBox._items;for(let g=0;g<e.length;g++){const h=e[g];f[h]&&c.appendChild(a._applyTokenTemplate(f[h][a.inputMember],"tokens"!==a.selectionDisplayMode&&h===d?"":b))}return c}_applySelection(){const a=this;return"placeholder"===a.selectionDisplayMode||0===a.selectedIndexes.length?void(a.$.actionButton.innerHTML=a.placeholder):void(!a.$.listBox._items||0===a.$.listBox._items.length||(a.$.actionButton.innerHTML="",a.$.actionButton.appendChild(a._createToken())))}_applyTokenTemplate(a,b){const c=this,d=document.createElement("span"),e=function(){return"<span class='smart-drop-down-list-selection-label'>"+a+"</span><span class='smart-drop-down-list-unselect-button'>"+b+"</span>"};if(d.classList.add("smart-token"),c._tokenTemplate){let a=document.importNode(c._tokenTemplate.content,!0);const b=a.childNodes.length,f=/{{\w+}}/g;let g;for(let c=0;c<b;c++)g=f.exec(a.childNodes[c].innerHTML),g&&(a.childNodes[c].innerHTML=a.childNodes[c].innerHTML.replace(g[0],e())),a.childNodes[c].outerHTML&&(d.innerHTML+=a.childNodes[c].outerHTML)}else"function"==typeof c.tokenTemplate?c.tokenTemplate(d,{label:a,iconSeparator:b}):d.innerHTML=e();return d}_bindingCompleteHandler(){const a=this;a.$.listBox&&requestAnimationFrame(()=>{a._setDropDownSize(),a._positionDetection.checkBrowserBounds()})}_buttonsDownHandler(a){const b=this;if(!b.disabled){if(b.hasRippleAnimation)if(!b.$.buttonsContainer||"dropDownButton"===b.dropDownOpenMode)Smart.Utilities.Animation.Ripple.animate(a.target,a.pageX,a.pageY);else{const c=b.$.buttonsContainer;c.firstElementChild.noRipple=!0,Smart.Utilities.Animation.Ripple.animate(c,a.pageX,a.pageY),c.firstElementChild.noRipple=!1}b._preventsSelectStart=!0,"dropDownButton"===b.dropDownOpenMode&&a.target===b.$.actionButton&&b.$.actionButton.setAttribute("active",""),b.opened&&(b._preventDropDownClose=!0)}}_buttonsMouseEventsHandler(a){const b=this;b.disabled||("mouseenter"===a.type?(b.setAttribute("hover",""),a.target.setAttribute("hover","")):(b.removeAttribute("hover"),a.target.removeAttribute("hover")))}_calculateDropDownSize(){const a=this;a._dropDownSize={};const b=window.getComputedStyle(a.$.dropDownContainer),c=parseFloat(b.getPropertyValue("border-top-width").trim()),d=parseFloat(b.getPropertyValue("border-bottom-width").trim()),e=parseFloat(b.getPropertyValue("margin-top").trim()),f=parseFloat(b.getPropertyValue("margin-bottom").trim()),g=parseFloat(b.getPropertyValue("padding-top").trim()),h=parseFloat(b.getPropertyValue("padding-bottom").trim());Smart.Utilities.Core.CSSVariablesSupport()&&(a._dropDownSize.width=b.getPropertyValue("--smart-drop-down-list-drop-down-width").trim(),a._dropDownSize.height=b.getPropertyValue("--smart-drop-down-list-drop-down-height").trim()),(!a._dropDownSize.width||-1<a._dropDownSize.width.indexOf("initial"))&&(a._dropDownSize.width=a.offsetWidth),a._dropDownSize.height||(a._dropDownSize.height="auto"),a._dropDownSize.minHeight=parseFloat(b.getPropertyValue("min-height").trim()),a._dropDownSize.maxHeight=parseFloat(b.getPropertyValue("max-height").trim()),a._dropDownSize.borderWidth=(isNaN(c)?0:c)+(isNaN(d)?0:d),a._dropDownSize.paddingWidth=(isNaN(g)?0:g)+(isNaN(h)?0:h),a._dropDownSize.marginWidth=(isNaN(e)?0:e)+(isNaN(f)?0:f)}_createElement(){const a=this;a._tokenTemplate=a._validateTemplate(a.tokenTemplate),a._applySelection(),a._setDropDownSize(),a._setFocusable(),a.$.arrow.noRipple=!0,a._shadowDOMStylesDelay=a.shadowRoot}_documentDownHandler(a){const b=this;if(b.disabled||b.readonly)return;let c=a.originalEvent.target;if(c===b._overlay&&(b._overlayDown=!0),b.shadowRoot){c=a.originalEvent.composedPath()[0];for(let a=c.getRootNode().host;a;)a.closest(".smart-drop-down-container")===b.$.dropDownContainer&&(b._isDropDownClicked=!0),a=a.getRootNode().host}else b.isInShadowDOM&&(c=a.originalEvent.composedPath()[0]),b._isDropDownClicked=c.closest(".smart-drop-down-container")===b.$.dropDownContainer;if(b._buttonClicked=c.closest(".smart-action-button")||c.closest(".smart-drop-down-button"),b.$.listBox){let d=c.closest("smart-list-item");b.$.listBox.contains(d)||(d=void 0),b.hasRippleAnimation&&d&&Smart.Utilities.Animation.Ripple.animate(d,a.pageX,a.pageY),(d||c===b.$.listBox.$.filterInput||c.closest(".smart-token"))&&(b._preventDropDownClose=!0)}if(b._isDropDownClicked&&(b._preventDropDownClose=!0),c===b.$.resizeBar&&"none"!==b.resizeMode){b._resizeDetails||(b._resizeDetails={});const c=b.$.dropDownContainer.getBoundingClientRect();b._resizeDetails.started=!0,b._resizeDetails.x=a.pageX,b._resizeDetails.y=a.pageY,b._resizeDetails.width=b.$.dropDownContainer.offsetWidth,b._resizeDetails.height=b.$.dropDownContainer.offsetHeight,b._resizeDetails.offsetXL=a.clientX-c.left,b._resizeDetails.offsetXR=c.left+b.$.dropDownContainer.offsetWidth-a.clientX,b._resizeDetails.offsetY=c.top+b.$.dropDownContainer.offsetHeight-a.clientY,b._resizeDetails.offsetYtop=a.clientY-c.top,b._preventDropDownClose=!0}}_documentMoveHandler(a){function b(){if(l=a.pageY-f._resizeDetails.y,"bottom"===k)f._resizeDetails.height=d(h.clientHeight-i.top-6,e(0,f._resizeDetails.height+l)),f._resizeDetails.y=e(i.top+h.scrollTop-f._resizeDetails.offsetY,d(h.clientHeight+h.scrollTop-1.5*f._resizeDetails.offsetY,a.pageY));else{if(f._resizeDetails.height=d(f._dropDownSize.maxHeight,e(0,d(j.top,f._resizeDetails.height-l))),l=e(0,i.top+(i.height-e(f._dropDownSize.minHeight,f._resizeDetails.height))),f.dropDownAppendTo&&0<f.dropDownAppendTo.length){const a=Math.abs(parseFloat(getComputedStyle(f.$.dropDownContainer).getPropertyValue("margin-bottom")))||0;f.$.dropDownContainer.style.top=f.dropDownAppendTo&&0<f.dropDownAppendTo.length?a+l+"px":""}const b=j.top+h.scrollTop+f._resizeDetails.offsetYtop;f._resizeDetails.y=e(f._resizeDetails.offsetYtop,d(b,e(b-f._dropDownSize.maxHeight,a.pageY)))}f.$.dropDownContainer.style.height=f._resizeDetails.height+"px"}function c(){l=a.pageX-f._resizeDetails.x,f._resizeDetails.width=d(h.clientWidth-i.left-6,e(0,f._resizeDetails.width+l)),f.$.dropDownContainer.style.width=f._resizeDetails.width+"px",f._resizeDetails.x=e(i.left+h.scrollLeft-f._resizeDetails.offsetXR,d(h.clientWidth+h.scrollLeft-1.5*f._resizeDetails.offsetXR,a.pageX))}var d=Math.min,e=Math.max;const f=this,g=f.shadowRoot||f.isInShadowDOM?a.originalEvent.composedPath()[0]:a.originalEvent.target;if("auto"===f.dropDownOpenMode&&null!==f.dropDownAppendTo&&(f.contains(g)||f.$.dropDownContainer.contains(g)?f._isElementHovered=!0:(f._isElementHovered=!1,f._autoClose())),!f._resizeDetails||f._resizeDetails&&!f._resizeDetails.started)return;f.setAttribute("resizing",""),f._resizeDetails.resizeEventFired||(f.$.fireEvent("resizeStart",{position:{left:a.pageX,top:a.pageY}}),f._resizeDetails.resizeEventFired=!0);const h=document.documentElement,i=f.$.dropDownContainer.getBoundingClientRect(),j=f.getBoundingClientRect(),k=f.$.dropDownContainer.hasAttribute("top")?"top":"bottom";let l;switch(f.resizeMode){case"vertical":b();break;case"horizontal":c();break;case"both":c(),b();}}_documentUpHandler(a){const b=this;if(b.$.actionButton.removeAttribute("active"),b._resizeDetails&&b._resizeDetails.started)return b._resizeDetails.started=b._resizeDetails.resizeEventFired=!1,b.removeAttribute("resizing"),b._preventDropDownClose=!1,b.focus(),void b.$.fireEvent("resizeEnd",{position:{left:a.pageX,top:a.pageY}});if(b.disabled||b._isDropDownClicked||b.readonly)return void delete b._isDropDownClicked;if(b._overlayDown)return b.close(),void delete b._overlayDown;let c=a.originalEvent.target,d=c.closest?c.closest("smart-drop-down-list"):void 0;if((b.enableShadowDOM||b.isInShadowDOM)&&(c=a.originalEvent.composedPath()[0],d=c.getRootNode().host),b._preventsSelectStart=!1,"undefined"!=typeof c&&c!==b.$.resizeBar){if("tokens"===b.selectionDisplayMode&&c.classList.contains("smart-drop-down-list-selection-label")&&d===b){"none"!==b.dropDownOpenMode&&b.open();let a=b.$.listBox._items.filter(a=>a[b.inputMember].toString()===c.textContent)[0];return b.$.listBox._scrollView.scrollTop=a.offsetTop,void b._focus(a)}if("tokens"===b.selectionDisplayMode&&c.classList.contains("smart-drop-down-list-unselect-button")&&d===b)return 1===b.selectedIndexes.length&&0>["zeroOrMany","zeroOrOne","checkBox"].indexOf(b.selectionMode)?void 0:void b.unselect(b.$.listBox._items.filter(a=>a[b.inputMember].toString()===c.previousElementSibling.textContent)[0]);const a=c.closest(".smart-action-button");if(b._buttonClicked&&("dropDownButton"===b.dropDownOpenMode&&a&&b._buttonClicked===b.$.actionButton?b.$.fireEvent("actionButtonClick"):(c.closest(".smart-drop-down-button")===b._buttonClicked||a===b._buttonClicked)&&b.$.fireEvent("dropDownButtonClick")),b._buttonClicked=void 0,a===b.$.actionButton||c.closest(".smart-drop-down-button")===b.$.dropDownButton)return"dropDownButton"===b.dropDownOpenMode&&a===b.$.actionButton?void b.close():void(b.$dropDownContainer.hasClass("smart-visibility-hidden")&&"none"!==b.dropDownOpenMode?b.open():b.close());c=b._getUpEventTarget(c),void 0===c||("dropDownContainer"!==c&&"item"!==c||"item"===c&&"checkBox"!==b.selectionMode&&0>b.selectionMode.indexOf("Many"))&&b.close()}}_dragStartHandler(a){const b=this;b._resizeDetails&&b._resizeDetails.started&&a.preventDefault()}_dropDownTransitionendHandler(){const a=this;a._edgeMacFF&&!a.opened&&a.hasAnimation&&(a.$.dropDownContainer.style.top=a.$.dropDownContainer.style.left="",a.$dropDownContainer.addClass("not-in-view"))}_focus(a){this.$.listBox._focus(a)}_blurEventHandler(){const a=this;a.$.dropDownButton&&(a.removeAttribute("focus"),a.$.dropDownButton.removeAttribute("focus")),a.$.actionButton&&(a.removeAttribute("focus"),a.$.actionButton.removeAttribute("focus")),a.nodeName&&"Smart-DROP-DOWN-LIST"===a.nodeName&&!a._preventDropDownClose&&a.close()}_focusEventHandler(){const a=this;a.$.dropDownButton&&(a.setAttribute("focus",""),a.$.dropDownButton.setAttribute("focus","")),a.$.actionButton&&(a.setAttribute("focus",""),a.$.actionButton.setAttribute("focus","")),a.removeAttribute("drop-down-button-focus"),a.removeAttribute("action-button-focus")}_buttonsFocusHandler(a){const b=this;a.target===b.$.dropDownButton?"focus"===a.type?b.setAttribute("drop-down-button-focus",""):(b.removeAttribute("drop-down-button-focus"),b.nodeName&&"Smart-DROP-DOWN-LIST"===b.nodeName&&!b._preventDropDownClose&&b.close()):"focus"===a.type?b.setAttribute("action-button-focus",""):b.removeAttribute("action-button-focus")}_getUpEventTarget(a){const b=this;let c=a;for(c=void 0===c.parentElement?c.getRootNode().host:c.parentElement;c;){if(c===b.$.dropDownContainer){c="dropDownContainer";break}c=c.parentElement===void 0?c.getRootNode().host:c.parentElement}return c}_keyDownHandler(a){const b=this,c=b.enableShadowDOM?b.shadowRoot.activeElement||document.activeElement:document.activeElement,d=b.enableShadowDOM?a.composedPath()[0]:a.target;if(!(b.$.listBox&&d===b.$.listBox.$.filterInput||c!==b&&c!==b.$.dropDownButton&&c!==b.$.actionButton))switch(a.key){case"Enter":case" ":d.setAttribute("active",""),a.preventDefault(),d!==b.$.actionButton&&(b._keyPressed=!0,b.opened?(b._focusedItem&&b.select(b._focusedItem),("Enter"===a.key&&0>["none"].indexOf(b.selectionMode)||" "===a.key&&-1<["none","one","radioButton"].indexOf(b.selectionMode))&&b.close()):!b.opened&&!b.readonly&&"none"!==b.dropDownOpenMode&&b.open());break;case"End":case"Home":case"PageUp":case"PageDown":case"ArrowUp":case"ArrowDown":if(b.readonly)return;if(a.altKey)return b._keyPressed=!1,void(b.$dropDownContainer.hasClass("smart-visibility-hidden")?b.open():b.close());a.preventDefault(),b.$.listBox._handleKeyStrokes(a.key);break;case"Escape":a.preventDefault(),b.close();break;default:if(b.readonly)return;"oneOrManyExtended"===b.selectionMode&&(b.$.listBox._keysPressed[a.key]=!0),b.$.listBox._applyIncrementalSearch(a.key);}}_keyUpHandler(a){const b=this,c=b.enableShadowDOM?a.composedPath()[0]:a.target;b.$.listBox&&c===b.$.listBox.$.filterInput||(("Enter"===a.key||" "===a.key)&&(c.removeAttribute("active"),!b.$dropDownContainer.hasClass("smart-visibility-hidden")&&(b._keyPressed=!1)),b.$.listBox&&"oneOrManyExtended"===b.selectionMode&&(b.$.listBox._keysPressed[a.key]=!1))}_listBoxChangeHandler(a){const b=this;if((b.dropDownAppendTo&&0<b.dropDownAppendTo.length||b.enableShadowDOM)&&b.$.fireEvent("change",a.detail),"list"===b.autoComplete&&a.detail){const c=b.$.listBox._items[a.detail.index];b._lastSelectedItem=c&&c.selected?c:void 0}b._applySelection(b.selectionMode,a.detail)}_listBoxItemClickHandler(a){const b=this;(b.dropDownAppendTo&&0<b.dropDownAppendTo.length||b.enableShadowDOM)&&b.$.fireEvent(a.type,a.detail),"checkBox"!==b.selectionMode&&0>b.selectionMode.indexOf("Many")&&b.close(),"smart-combo-box"!==b.nodeName.toLowerCase()||Smart.Utilities.Core.isMobile||b.$.input.focus(),delete b._isDropDownClicked}_listBoxKeyDownHandler(a){const b=this;return"Enter"===a.key?(b.close(),"dropDownButton"===b.dropDownOpenMode?b.$.dropDownButton.focus():b.focus(),void a.stopPropagation()):"Escape"===a.key?void b.close():void 0}_mouseEnterHandler(){const a=this;a._isElementHovered=!0,!(-1<a.tagName.indexOf("Smart-DROP-DOWN-"))||"auto"!==a.dropDownOpenMode||a.disabled||a.readonly||a.open()}_mouseLeaveHandler(){const a=this;a.removeAttribute("hover"),a._isElementHovered=!1,"auto"!==a.dropDownOpenMode||a.disabled||a.readonly||a._autoClose()}_mouseWheelHandler(a){const b=this;b.disabled||b.readonly||b.items&&0===b.items.length||b.$dropDownContainer&&!b.$dropDownContainer.hasClass("smart-visibility-hidden")||b.$.listBox&&(a.preventDefault(),b.$.listBox._handleKeyStrokes(0<a.deltaY?"ArrowDown":"ArrowUp"))}_autoClose(){const a=this;a._autoCloseTimeout=setTimeout(function(){a._isElementHovered||a.close(),clearTimeout(a._autoCloseTimeout)}.bind(a),a.autoCloseDelay)}_propertyValidator(a,b){return"number"!=typeof b&&"string"!=typeof b?a:b}_resizeHandler(){const a=this;"none"===a.resizeMode&&(a._calculateDropDownSize(),a._setDropDownSize())}_selectStartHandler(a){this._preventsSelectStart&&a.preventDefault()}_setDropDownSize(){const a=this;if(a._dropDownSize||a._calculateDropDownSize(),["dropDownMinWidth","dropDownMinHeight","dropDownMaxWidth","dropDownMaxHeight"].forEach(b=>{a.$.dropDownContainer.style[b.replace("dropDown","").replace(/^./,"m")]=a[b]?a[b]+(a[b].toString().endsWith("%")?"%":"px"):null}),!a.dropDownWidth)a.$.dropDownContainer.style.width="auto"===a._dropDownSize.width?"auto":(parseFloat(a._dropDownSize.width)||0)+"px";else if("auto"!==a.dropDownWidth)a.$.dropDownContainer.style.width=("initial"===a.dropDownWidth?a.offsetWidth:parseFloat(a.dropDownWidth))+"px";else if(a.$.dropDownContainer.style.width="auto",a.$.listBox){let b=2+2*parseInt(window.getComputedStyle(a.$.listBox.$.itemsContainer).getPropertyValue("--smart-list-item-horizontal-offset"));a.$.dropDownContainer.style.width=b+a.$.listBox._scrollWidth+"px"}if(a.dropDownHeight&&"auto"!==a.dropDownHeight)a.$.dropDownContainer.style.height=parseFloat(a.dropDownHeight)+(-1<(a.dropDownHeight+"").indexOf("%")?"%":"px");else if(a.$.listBox&&("auto"===a._dropDownSize.height||"auto"===a.dropDownHeight)){a.$.dropDownContainer.style.height="";let b=2*parseInt(window.getComputedStyle(a.$.listBox.$.itemsContainer).getPropertyValue("--smart-list-item-vertical-offset"));isNaN(b)&&(b=6);let c=b;0<a.$.listBox.items.length&&a.$.listBox.items.map(a=>c+=a.height||a.offsetHeight),c=c+a._dropDownSize.paddingWidth+a._dropDownSize.borderWidth,a.$.dropDownContainer.style.height=c+"px"}else a.$.dropDownContainer.style.height=a._dropDownSize.height;a.$.listBox&&a.$.listBox._refreshLayout()}_styleChangedHandler(a){const b=this;if(b.dropDownAppendTo&&0<b.dropDownAppendTo.length){const c=a.detail.styleProperties,d=["font-size","font-family","font-style","font-weight"];for(let a=0;a<d.length;a++)c[d[a]]&&(b.$.dropDownContainer.style[d[a]]=c[d[a]].value)}"auto"===b._dropDownSize.height&&b._setDropDownSize()}_validateTemplate(a){const b=this;if(a)return"function"==typeof a?void 0:"content"in document.createElement("template")?(a instanceof HTMLTemplateElement||(a=document.getElementById(a)),null!==a&&"content"in a?a:void b.error(b.localize("invalidTemplate",{elementType:b.nodeName.toLowerCase(),property:"tokenTemplate"}))):void b.error(b.localize("htmlTemplateNotSuported",{elementType:b.nodeName.toLowerCase()}))}});