
/* Smart HTML Elements v4.6.0 (2019-Oct) 
Copyright (c) 2011-2019 jQWidgets. 
License: https://htmlelements.com/license/ */

Smart("smart-chart",class extends Smart.BaseElement{static get properties(){return{animationDuration:{value:300,type:"number"},backgroundColor:{value:null,type:"string?"},backgroundImage:{value:"",type:"string"},borderLineColor:{value:null,type:"string?"},borderLineWidth:{value:1,type:"number"},caption:{value:"Caption",type:"string"},clip:{value:!0,type:"boolean"},colorScheme:{value:"scheme01",type:"string"},columnSeriesOverlap:{value:!1,type:"boolean"},crosshairsColor:{value:null,type:"string?"},crosshairsDashStyle:{value:"2,2",type:"string"},crosshairsLineWidth:{value:1,type:"number"},dataSource:{value:[],type:"object",reflectToAttribute:!1},description:{value:"Description",type:"string"},draw:{value:null,type:"function?"},drawBefore:{value:null,type:"function?"},enableAxisTextAnimation:{value:!1,type:"boolean"},enableCrosshairs:{value:!1,type:"boolean"},greyScale:{value:!1,type:"boolean"},legendLayout:{value:{flow:{value:"horizontal",allowedValues:["horizontal","vertical"],type:"string"},height:{value:null,type:"number?"},left:{value:null,type:"number?"},top:{value:null,type:"number?"},width:{value:null,type:"number?"}},type:"object?"},localization:{value:{decimalSeparator:{value:".",type:"string"},patterns:{value:null,type:"object?"},thousandsSeparator:{value:"",type:"string"}},type:"object"},messages:{value:{en:{invalidRadiusDataField:"smart-chart: Invalid radiusDataField value at [{{index}}]",invalidSeries:"smart-chart: Invalid property: each series group must have a 'series' property which must be a valid array.",invalidSeriesGroups:"smart-chart: Invalid property: 'seriesGroups' property is required and must be a valid array.",invalidType:"smart-chart: Invalid serie type \"{{type}}\".",missingAxis:"smart-chart: seriesGroup[{{index}}] is missing {{axis}} definition.",missingReference:"smart-chart: Missing reference to {{files}}.",missingType:"smart-chart: Invalid property: each series group must have a valid 'type' property."}},type:"object",extend:!0},padding:{value:{bottom:{value:5,type:"number"},left:{value:5,type:"number"},right:{value:5,type:"number"},top:{value:5,type:"number"}},type:"object"},renderEngine:{value:"",allowedValues:["","SVG","HTML5"],type:"string"},rightToLeft:{value:!1,type:"boolean"},seriesGroups:{value:[],type:"any"},showBorderLine:{value:!0,type:"boolean"},showLegend:{value:!0,type:"boolean"},showToolTips:{value:!0,type:"boolean"},showToolTipsOnAllSeries:{value:!1,type:"boolean"},theme:{value:"light",allowedValues:["light","dark"],type:"string"},titlePadding:{value:{bottom:{value:10,type:"number"},left:{value:5,type:"number"},right:{value:5,type:"number"},top:{value:5,type:"number"}},type:"object"},toolTipBackground:{value:null,type:"string?"},toolTipFormatFunction:{value:null,type:"function?"},toolTipHideDelay:{value:4e3,type:"number"},toolTipLineColor:{value:null,type:"string?"},toolTipShowDelay:{value:300,type:"number"},valueAxis:{value:{alternatingBackgroundColor:{value:"",type:"string"},alternatingBackgroundColor2:{value:"",type:"string"},alternatingBackgroundOpacity:{value:1,type:"number"},axisSize:{value:null,type:"any"},bands:{value:null,type:"array?"},baselineValue:{value:0,type:"any"},customDraw:{value:!1,type:"boolean"},flip:{value:!1,type:"boolean"},formatFunction:{value:null,type:"function?"},formatSettings:{value:{dateFormat:{value:null,type:"string?"},decimalPlaces:{value:null,type:"number?"},decimalSeparator:{value:null,type:"string?"},negativeWithBrackets:{value:!1,type:"boolean"},prefix:{value:"",type:"string"},sufix:{value:"",type:"string"},thousandsSeparator:{value:null,type:"string?"}},type:"object"},gridLines:{value:{color:{value:"",type:"string"},custom:{value:null,type:"array?"},dashStyle:{value:"",type:"string"},lineWidth:{value:1,type:"number"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},visible:{value:!0,type:"any"}},type:"object"},labels:{value:{angle:{value:0,type:"number"},autoRotate:{value:!1,type:"boolean"},class:{value:null,type:"string?"},custom:{value:null,type:"array?"},formatFunction:{value:null,type:"function?"},formatSettings:{value:{dateFormat:{value:null,type:"string?"},decimalPlaces:{value:null,type:"number?"},decimalSeparator:{value:null,type:"string?"},negativeWithBrackets:{value:!1,type:"boolean"},prefix:{value:"",type:"string"},sufix:{value:"",type:"string"},thousandsSeparator:{value:null,type:"string?"}},type:"object"},horizontalAlignment:{value:"center",allowedValues:["left","center","right"],type:"string"},offset:{value:{x:{value:0,type:"number"},y:{value:0,type:"number"}},type:"object"},rotationPoint:{value:"auto",allowedValues:["auto","left","center","right","topleft","topcenter","topright","bottomleft","bottomcenter","bottomright","centermiddle"],type:"string"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},verticalAlignment:{value:"center",allowedValues:["top","center","bottom"],type:"string"},visible:{value:!0,type:"any"}},type:"object"},line:{value:{color:{value:"",type:"string"},dashStyle:{value:"",type:"string"},lineWidth:{value:1,type:"number"},visible:{value:!0,type:"any"}},type:"object"},logarithmicScale:{value:!1,type:"boolean"},logarithmicScaleBase:{value:10,type:"number"},maxValue:{value:NaN,type:"any"},minValue:{value:NaN,type:"any"},padding:{value:{bottom:{value:0,type:"number"},left:{value:0,type:"number"},right:{value:0,type:"number"},top:{value:0,type:"number"}},type:"object"},position:{value:"left",allowedValues:["left","right","top","bottom"],type:"string"},textRotationAngle:{value:null,type:"number?"},textRotationPoint:{value:"auto",allowedValues:["auto","left","center","right","topleft","topcenter","topright","bottomleft","bottomcenter","bottomright","centermiddle"],type:"string"},tickMarks:{value:{color:{value:"",type:"string"},custom:{value:null,type:"array?"},dashStyle:{value:"",type:"string"},lineWidth:{value:1,type:"number"},size:{value:4,type:"number"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},visible:{value:!0,type:"any"}},type:"object"},title:{value:{class:{value:null,type:"string?"},horizontalAlignment:{value:"center",allowedValues:["left","center","right"],type:"string"},text:{value:"",type:"string"},verticalAlignment:{value:"center",allowedValues:["top","center","bottom"],type:"string"},visible:{value:!0,type:"boolean"}},type:"object"},unitInterval:{value:null,type:"number?"},valuesOnTicks:{value:!0,type:"boolean"},visible:{value:!0,type:"boolean"}},type:"object"},xAxis:{value:{alternatingBackgroundColor:{value:"",type:"string"},alternatingBackgroundColor2:{value:"",type:"string"},alternatingBackgroundOpacity:{value:1,type:"number"},axisSize:{value:null,type:"any"},bands:{value:null,type:"array?"},baseUnit:{value:null,allowedValues:["year","month","day","hour","minute","second","millisecond",null],type:"string?"},customDraw:{value:!1,type:"boolean"},dataField:{value:"",type:"string"},dateFormat:{value:null,type:"string?"},displayText:{value:null,type:"string?"},flip:{value:!1,type:"boolean"},formatFunction:{value:null,type:"function?"},formatSettings:{value:{dateFormat:{value:null,type:"string?"},decimalPlaces:{value:null,type:"number?"},decimalSeparator:{value:null,type:"string?"},negativeWithBrackets:{value:!1,type:"boolean"},prefix:{value:"",type:"string"},sufix:{value:"",type:"string"},thousandsSeparator:{value:null,type:"string?"}},type:"object"},gridLines:{value:{color:{value:"",type:"string"},custom:{value:null,type:"array?"},dashStyle:{value:"",type:"string"},lineWidth:{value:1,type:"number"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},visible:{value:!0,type:"any"}},type:"object"},labels:{value:{angle:{value:0,type:"number"},autoRotate:{value:!1,type:"boolean"},class:{value:null,type:"string?"},custom:{value:null,type:"array?"},formatFunction:{value:null,type:"function?"},formatSettings:{value:{dateFormat:{value:null,type:"string?"},decimalPlaces:{value:null,type:"number?"},decimalSeparator:{value:null,type:"string?"},negativeWithBrackets:{value:!1,type:"boolean"},prefix:{value:"",type:"string"},sufix:{value:"",type:"string"},thousandsSeparator:{value:null,type:"string?"}},type:"object"},horizontalAlignment:{value:"center",allowedValues:["left","center","right"],type:"string"},offset:{value:{x:{value:0,type:"number"},y:{value:0,type:"number"}},type:"object"},rotationPoint:{value:"auto",allowedValues:["auto","left","center","right","topleft","topcenter","topright","bottomleft","bottomcenter","bottomright","centermiddle"],type:"string"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},verticalAlignment:{value:"center",allowedValues:["top","center","bottom"],type:"string"},visible:{value:!0,type:"any"}},type:"object"},line:{value:{color:{value:"",type:"string"},dashStyle:{value:"",type:"string"},lineWidth:{value:1,type:"number"},visible:{value:!0,type:"any"}},type:"object"},logarithmicScale:{value:!1,type:"boolean"},logarithmicScaleBase:{value:10,type:"number"},maxValue:{value:NaN,type:"any"},minValue:{value:NaN,type:"any"},padding:{value:{bottom:{value:0,type:"number"},left:{value:0,type:"number"},right:{value:0,type:"number"},top:{value:0,type:"number"}},type:"object"},position:{value:"bottom",allowedValues:["bottom","top","left","right"],type:"string"},rangeSelector:{value:{backgroundColor:{value:null,type:"string?"},backgroundImage:{value:"",type:"string"},baseUnit:{value:null,allowedValues:["year","month","day","hour","minute","second","millisecond",null],type:"string?"},borderLineColor:{value:null,type:"string?"},borderLineWidth:{value:null,type:"number?"},caption:{value:"",type:"string"},colorScheme:{value:null,type:"string?"},columnSeriesOverlap:{value:!1,type:"boolean"},columnsGapPercent:{value:25,type:"number"},dataField:{value:null,type:"string?"},description:{value:"",type:"string"},greyScale:{value:null,type:"boolean?"},gridLines:{value:{color:{value:"",type:"string"},custom:{value:null,type:"array?"},dashStyle:{value:"",type:"string"},lineWidth:{value:1,type:"number"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},visible:{value:!0,type:"any"}},type:"object"},labels:{value:{angle:{value:0,type:"number"},autoRotate:{value:!1,type:"boolean"},class:{value:null,type:"string?"},custom:{value:null,type:"array?"},formatFunction:{value:null,type:"function?"},formatSettings:{value:{dateFormat:{value:null,type:"string?"},decimalPlaces:{value:null,type:"number?"},decimalSeparator:{value:null,type:"string?"},negativeWithBrackets:{value:!1,type:"boolean"},prefix:{value:"",type:"string"},sufix:{value:"",type:"string"},thousandsSeparator:{value:null,type:"string?"}},type:"object"},horizontalAlignment:{value:"center",allowedValues:["left","center","right"],type:"string"},offset:{value:{x:{value:0,type:"number"},y:{value:0,type:"number"}},type:"object"},rotationPoint:{value:"auto",allowedValues:["auto","left","center","right","topleft","topcenter","topright","bottomleft","bottomcenter","bottomright","centermiddle"],type:"string"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},verticalAlignment:{value:"center",allowedValues:["top","center","bottom"],type:"string"},visible:{value:!0,type:"any"}},type:"object"},maxValue:{value:NaN,type:"any"},minValue:{value:NaN,type:"any"},padding:{value:{bottom:{value:0,type:"number"},left:{value:0,type:"number"},right:{value:0,type:"number"},top:{value:0,type:"number"}},type:"object"},position:{value:null,allowedValues:["bottom","top","left","right"],type:"string?"},renderTo:{value:null,type:"any"},rightToLeft:{value:null,type:"boolean?"},seriesGapPercent:{value:10,type:"number"},seriesGroups:{value:null,type:"array?"},serieType:{value:"area",type:"string"},showBorderLine:{value:null,type:"boolean?"},size:{value:null,type:"number?"},skipOverlappingPoints:{value:!0,type:"boolean"},titlePadding:{value:{bottom:{value:10,type:"number"},left:{value:5,type:"number"},right:{value:5,type:"number"},top:{value:5,type:"number"}},type:"object"},unitInterval:{value:null,type:"number?"},valueAxis:{value:{alternatingBackgroundColor:{value:"",type:"string"},alternatingBackgroundColor2:{value:"",type:"string"},alternatingBackgroundOpacity:{value:1,type:"number"},axisSize:{value:null,type:"any"},bands:{value:null,type:"array?"},baselineValue:{value:0,type:"any"},customDraw:{value:!1,type:"boolean"},flip:{value:!1,type:"boolean"},formatFunction:{value:null,type:"function?"},formatSettings:{value:{dateFormat:{value:null,type:"string?"},decimalPlaces:{value:null,type:"number?"},decimalSeparator:{value:null,type:"string?"},negativeWithBrackets:{value:!1,type:"boolean"},prefix:{value:"",type:"string"},sufix:{value:"",type:"string"},thousandsSeparator:{value:null,type:"string?"}},type:"object"},gridLines:{value:{color:{value:"",type:"string"},custom:{value:null,type:"array?"},dashStyle:{value:"",type:"string"},lineWidth:{value:1,type:"number"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},visible:{value:!0,type:"any"}},type:"object"},labels:{value:{angle:{value:0,type:"number"},autoRotate:{value:!1,type:"boolean"},class:{value:null,type:"string?"},custom:{value:null,type:"array?"},formatFunction:{value:null,type:"function?"},formatSettings:{value:{dateFormat:{value:null,type:"string?"},decimalPlaces:{value:null,type:"number?"},decimalSeparator:{value:null,type:"string?"},negativeWithBrackets:{value:!1,type:"boolean"},prefix:{value:"",type:"string"},sufix:{value:"",type:"string"},thousandsSeparator:{value:null,type:"string?"}},type:"object"},horizontalAlignment:{value:"center",allowedValues:["left","center","right"],type:"string"},offset:{value:{x:{value:0,type:"number"},y:{value:0,type:"number"}},type:"object"},rotationPoint:{value:"auto",allowedValues:["auto","left","center","right","topleft","topcenter","topright","bottomleft","bottomcenter","bottomright","centermiddle"],type:"string"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},verticalAlignment:{value:"center",allowedValues:["top","center","bottom"],type:"string"},visible:{value:!0,type:"any"}},type:"object"},line:{value:{color:{value:"",type:"string"},dashStyle:{value:"",type:"string"},lineWidth:{value:1,type:"number"},visible:{value:!0,type:"any"}},type:"object"},logarithmicScale:{value:!1,type:"boolean"},logarithmicScaleBase:{value:10,type:"number"},maxValue:{value:NaN,type:"any"},minValue:{value:NaN,type:"any"},padding:{value:{bottom:{value:0,type:"number"},left:{value:0,type:"number"},right:{value:0,type:"number"},top:{value:0,type:"number"}},type:"object"},position:{value:"left",allowedValues:["left","right","top","bottom"],type:"string"},textRotationAngle:{value:null,type:"number?"},textRotationPoint:{value:"auto",allowedValues:["auto","left","center","right","topleft","topcenter","topright","bottomleft","bottomcenter","bottomright","centermiddle"],type:"string"},tickMarks:{value:{color:{value:"",type:"string"},custom:{value:null,type:"array?"},dashStyle:{value:"",type:"string"},lineWidth:{value:1,type:"number"},size:{value:4,type:"number"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},visible:{value:!0,type:"any"}},type:"object"},title:{value:{class:{value:null,type:"string?"},horizontalAlignment:{value:"center",allowedValues:["left","center","right"],type:"string"},text:{value:"",type:"string"},verticalAlignment:{value:"center",allowedValues:["top","center","bottom"],type:"string"},visible:{value:!0,type:"boolean"}},type:"object"},unitInterval:{value:null,type:"number?"},valuesOnTicks:{value:!0,type:"boolean"},visible:{value:!1,type:"boolean"}},type:"object"},visible:{value:!1,type:"boolean"}},type:"object"},textRotationAngle:{value:null,type:"number?"},textRotationPoint:{value:"auto",allowedValues:["auto","left","center","right","topleft","topcenter","topright","bottomleft","bottomcenter","bottomright","centermiddle"],type:"string"},tickMarks:{value:{color:{value:"",type:"string"},custom:{value:null,type:"array?"},dashStyle:{value:"",type:"string"},lineWidth:{value:1,type:"number"},size:{value:4,type:"number"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},visible:{value:!0,type:"any"}},type:"object"},title:{value:{class:{value:null,type:"string?"},horizontalAlignment:{value:"center",allowedValues:["left","center","right"],type:"string"},text:{value:"",type:"string"},verticalAlignment:{value:"center",allowedValues:["top","center","bottom"],type:"string"},visible:{value:!0,type:"boolean"}},type:"object"},toolTipFormatFunction:{value:null,type:"function?"},toolTipFormatSettings:{value:{dateFormat:{value:null,type:"string?"},decimalPlaces:{value:null,type:"number?"},decimalSeparator:{value:null,type:"string?"},negativeWithBrackets:{value:!1,type:"boolean"},prefix:{value:"",type:"string"},sufix:{value:"",type:"string"},thousandsSeparator:{value:null,type:"string?"}},type:"object"},type:{value:"auto",allowedValues:["auto","date","basic","linear"],type:"string"},unitInterval:{value:null,type:"number?"},valuesOnTicks:{value:!0,type:"boolean"},visible:{value:!0,type:"boolean"}},type:"object"}}}get _legendLayout(){const e=this.legendLayout;return null!==e.height||null!==e.left||null!==e.top||null!==e.width||"vertical"===e.flow}_getFormatSettings(e,t){if(!e)return null;const i=e[t?t:"formatSettings"];return i?i.dateFormat||null!==i.decimalPlaces||i.decimalSeparator||i.negativeWithBrackets||i.prefix||i.sufix||i.thousandsSeparator?i:null:null}static get listeners(){return{click:"_clickHandler",down:"_downMoveHandler",mouseleave:"_mouseleaveHandler",move:"_moveHandler",resize:"_resizeHandler","document.move":"_downMoveHandler","document.up":"_documentUpHandler"}}static get requires(){return{"Smart.Utilities.Draw":"smart.draw.js"}}static get styleUrls(){return["smart.chart.css"]}template(){return"<div></div>"}ready(){super.ready(),this.checkLicense()}render(){const e=this;e._observeSeriesGroups(),e._isTouchDevice=Smart.Utilities.Core.isMobile,e._setDefaults(),e._createColorsCache(),e.refresh(),super.render()}detached(){const e=this;super.detached(),e._ttEl&&e._ttEl.box&&e._ttEl.box.remove(),delete e._ttEl}_observeSeriesGroups(){function e(e){t.context!==t&&e.newValue!==e.oldValue&&t.update()}const t=this;t._validateSeriesGroups(),t.seriesGroups=new Smart.ObservableArray(t.seriesGroups),t.seriesGroups.canNotify=!0;for(let r=0;r<t.seriesGroups.length;r++)t.seriesGroups[r].series=new Smart.ObservableArray(t.seriesGroups[r].series),t.seriesGroups[r].series.canNotify=!0,t.seriesGroups[r].series.notify(e);t.seriesGroups.notify(e)}_downMoveHandler(e){const t=this;let i=e.originalEvent.target;t.shadowRoot&&i===t&&(i=e.originalEvent.composedPath()[0]);const r=i.closest(".smart-chart-range-selector");if(r){const i=r.firstElementChild,n=i.parentChart;t!==i&&t!==n||n["_onSliderMouse"+e.type.slice(0,1).toUpperCase()+e.type.slice(1)](e)}}_documentUpHandler(e){const t=this;t._draggingRangeSelector&&t._onSliderMouseUp(e)}_setDefaults(){const e=this;e.axisPadding=5,e.enableEvents=!0,e.enableSampling=!0,e._itemsToggleState=[],e._isToggleRefresh=!1,e._isSelectorRefresh=!1,e._sliders=[],e._selectorRange=[],e._rangeSelectorInstances={},e._resizeState={},e._isRangeSelectorInstance=e._isRangeSelectorInstance||!1,e._renderData={},e._smartPlot=null,e._animTickInt=50,e._seriesTypes=["line","stackedline","stackedline100","spline","stackedspline","stackedspline100","stepline","stackedstepline","stackedstepline100","area","stackedarea","stackedarea100","splinearea","stackedsplinearea","stackedsplinearea100","steparea","stackedsteparea","stackedsteparea100","rangearea","splinerangearea","steprangearea","column","stackedcolumn","stackedcolumn100","rangecolumn","scatter","stackedscatter","stackedscatter100","bubble","stackedbubble","stackedbubble100","pie","donut","candlestick","ohlc","waterfall","stackedwaterfall"],e.colorSchemes=[{name:"scheme01",colors:["#307DD7","#AA4643","#89A54E","#71588F","#4198AF"]},{name:"scheme02",colors:["#7FD13B","#EA157A","#FEB80A","#00ADDC","#738AC8"]},{name:"scheme03",colors:["#E8601A","#FF9639","#F5BD6A","#599994","#115D6E"]},{name:"scheme04",colors:["#D02841","#FF7C41","#FFC051","#5B5F4D","#364651"]},{name:"scheme05",colors:["#25A0DA","#309B46","#8EBC00","#FF7515","#FFAE00"]},{name:"scheme06",colors:["#0A3A4A","#196674","#33A6B2","#9AC836","#D0E64B"]},{name:"scheme07",colors:["#CC6B32","#FFAB48","#FFE7AD","#A7C9AE","#888A63"]},{name:"scheme08",colors:["#3F3943","#01A2A6","#29D9C2","#BDF271","#FFFFA6"]},{name:"scheme09",colors:["#1B2B32","#37646F","#A3ABAF","#E1E7E8","#B22E2F"]},{name:"scheme10",colors:["#5A4B53","#9C3C58","#DE2B5B","#D86A41","#D2A825"]},{name:"scheme11",colors:["#993144","#FFA257","#CCA56A","#ADA072","#949681"]},{name:"scheme12",colors:["#105B63","#EEEAC5","#FFD34E","#DB9E36","#BD4932"]},{name:"scheme13",colors:["#BBEBBC","#F0EE94","#F5C465","#FA7642","#FF1E54"]},{name:"scheme14",colors:["#60573E","#F2EEAC","#BFA575","#A63841","#BFB8A3"]},{name:"scheme15",colors:["#444546","#FFBB6E","#F28D00","#D94F00","#7F203B"]},{name:"scheme16",colors:["#583C39","#674E49","#948658","#F0E99A","#564E49"]},{name:"scheme17",colors:["#142D58","#447F6E","#E1B65B","#C8782A","#9E3E17"]},{name:"scheme18",colors:["#4D2B1F","#635D61","#7992A2","#97BFD5","#BFDCF5"]},{name:"scheme19",colors:["#844341","#D5CC92","#BBA146","#897B26","#55591C"]},{name:"scheme20",colors:["#56626B","#6C9380","#C0CA55","#F07C6C","#AD5472"]},{name:"scheme21",colors:["#96003A","#FF7347","#FFBC7B","#FF4154","#642223"]},{name:"scheme22",colors:["#5D7359","#E0D697","#D6AA5C","#8C5430","#661C0E"]},{name:"scheme23",colors:["#16193B","#35478C","#4E7AC7","#7FB2F0","#ADD5F7"]},{name:"scheme24",colors:["#7B1A25","#BF5322","#9DA860","#CEA457","#B67818"]},{name:"scheme25",colors:["#0081DA","#3AAFFF","#99C900","#FFEB3D","#309B46"]},{name:"scheme26",colors:["#0069A5","#0098EE","#7BD2F6","#FFB800","#FF6800"]},{name:"scheme27",colors:["#FF6800","#A0A700","#FF8D00","#678900","#0069A5"]},{name:"scheme28",colors:["#3A43BA","#281E5D","#48AAAD","#0492C2","#1E456E","#59788D","#52B2C0","#82EDFD"]},{name:"scheme29",colors:["#003F5C","#BC5090","#58508D","#FF6361","#FFA600"]},{name:"scheme30",colors:["#16736F","#A2D56A","#1C515C","#62B773","#EEEF63","#1F313F","#309577"]},{name:"scheme31",colors:["#74CC66","#191A4D","#2D867A","#EEE3CD","#224D19","#0D261B","#5771C7","#B6D7E7","#206052","#6B5724","#C3AF4B","#603620","#536722","#B6E7B9","#34819D","#94ACDB"]},{name:"scheme32",colors:["#87C5FF","#5B5B60","#9BE076","#F7A384","#7479D3","#F13A80","#E4D388","#2BC6B2","#F45B14"]}]}_clickHandler(e){const t=this;if(t.disabled||t._isRangeSelectorInstance)return;let i=e.pageX||e.clientX||e.screenX,r=e.pageY||e.clientY||e.screenY;const n=t.getBoundingClientRect();t._isTouchDevice&&(i=e.pageX,r=e.pageY),i-=n.left,r-=n.top,t._mouseX=i,t._mouseY=r;!isNaN(t._lastClickTs)&&100>new Date().valueOf()-t._lastClickTs||(this._hostClickTimer=setTimeout(function(){if(t._isTouchDevice||(t._cancelTooltipTimer(),t._hideToolTip(),t._unselect()),t._pointMarker&&t._pointMarker.element){const i=t.seriesGroups[t._pointMarker.gidx],r=i.series[t._pointMarker.sidx];e.stopImmediatePropagation(),t._raiseItemEvent("click",i,r,t._pointMarker.iidx)}},100),"HTML5"===t.renderEngine&&t._canvasClickHandler(i,r))}_canvasClickHandler(e,t){const i=this,r=i.renderer._elements;let n;for(let i in r)if(r.hasOwnProperty(i)&&"0"!=i){const s=r[i];if(t>s.y&&t<s.y+s.height&&e>s.x&&e<s.x+s.width){n=s;break}}if(n&&n.purpose&&"legend-toggle"===n.purpose){const e=n.data;i._toggleSerie(e.groupIndex,e.seriesIndex,e.itemIndex)}}_mouseleaveHandler(){const e=this;if(e.disabled||e._isRangeSelectorInstance)return;const t=e._mouseX,i=e._mouseY,r=e._plotRect;r&&t>=r.x&&t<=r.x+r.width&&i>=r.y&&i<=r.y+r.height||(e._cancelTooltipTimer(),e._hideToolTip(0),e._unselect())}_moveHandler(e){const t=this;if(t.disabled)return;if("touchmove"===e.originalEvent.type&&e.originalEvent.preventDefault(),t._isRangeSelectorInstance){const e=t.parentChart;null===e.xAxis.rangeSelector.renderTo&&(e._unselect(),e._hideToolTip())}else t.style.cursor="default";let i=e.pageX||e.clientX||e.screenX,r=e.pageY||e.clientY||e.screenY;const n=t.getBoundingClientRect();t._isTouchDevice&&(i=e.pageX,r=e.pageY),i-=n.left,r-=n.top,t.onmousemove(i,r)}_resizeHandler(){const e=this,t=e.animation;e._isRangeSelectorInstance||(e.animation="none",e.refresh(),e.animation=t)}propertyChangedHandler(e,t,i){const r=this;switch(e){case"animation":case"theme":r._ttEl&&r._ttEl.box.setAttribute(e,i);break;case"seriesGroups":r._observeSeriesGroups();break;case"xAxis_rangeSelector_renderTo":if(null===i){const e=t.getElementsByClassName("smart-chart-range-selector")[0];e.parentElement.removeChild(e)}}this.refresh()}_initRenderer(){const e=this;e._draw=new Smart.Utilities.Draw(e.$.content,e.renderEngine),e.renderer=e._draw.renderer,e._smartPlot||(e._smartPlot=new Smart.Utilities.Plot(e.renderer))}_internalRefresh(){const e=this;if(e.offsetWidth||e.offsetHeight||e.getClientRects().length){e._stopAnimations(),e.renderer&&(e._isToggleRefresh||e._isUpdate)||(e._hideToolTip(0),e.$.content.innerHTML="",e._initRenderer());const t=e.renderer;if(t){const i=t.getRect();e._render({x:1,y:1,width:i.width,height:i.height}),this.$.fireEvent("refreshBegin",{instance:this}),t instanceof Smart.Utilities.HTML5Renderer&&t.refresh(),e._isUpdate=!1,this.$.fireEvent("refreshEnd",{instance:this})}}}saveAsPNG(e){return this._saveAsImage("png",e)}saveAsJPEG(e){return this._saveAsImage("jpeg",e)}saveAsPDF(e,t){return this._saveAsImage("pdf",e,t)}print(){return this._saveAsImage("print")}_saveAsImage(e,t,i){const r=this;return r._draw._widgetToImage(r,e,t,r._hasRangeSelector?r._selectorSaveAsImageCallback:void 0,i)}_selectorSaveAsImageCallback(e,t){let r=e;for(let n=0,i;n<r.seriesGroups.length;n++){if(i=r._getXAxis(n),!i||!i.rangeSelector||!i.rangeSelector.visible||i.rangeSelector.renderTo)continue;let e=r._rangeSelectorInstances[n];if(!e)continue;let s=e.renderer.getRect(),a=e.renderer.getContainer().getElementsByTagName("canvas")[0],l=a.getContext("2d"),o=r._sliders[n],d="horizontal"===r.seriesGroups[n].orientation,g=d?"height":"width",u=d?"width":"height",p=d?"y":"x",h=d?"x":"y",y={};y[p]=o.startOffset+o.rect[p],y[h]=o.rect[h],y[g]=o.endOffset-o.startOffset,y[u]=o.rect[u];let m=i.rangeSelector.colorSelectedRange||"blue",c=i.rangeSelector.colorRangeLine||"grey",f=[];f.push(e.renderer.rect(y.x,y.y,y.width,y.height,{fill:m,opacity:.1}));const x=r.renderer;d?(f.push(e.renderer.line(x._ptrnd(o.rect.x+o.rect.width),x._ptrnd(o.rect.y),x._ptrnd(o.rect.x+o.rect.width),x._ptrnd(y.y),{stroke:c,opacity:.5})),f.push(e.renderer.line(x._ptrnd(o.rect.x+o.rect.width),x._ptrnd(y.y+y.height),x._ptrnd(o.rect.x+o.rect.width),x._ptrnd(o.rect.y+o.rect.height),{stroke:c,opacity:.5})),f.push(e.renderer.line(x._ptrnd(o.rect.x),x._ptrnd(y.y),x._ptrnd(o.rect.x+o.rect.width),x._ptrnd(y.y),{stroke:c,opacity:.5})),f.push(e.renderer.line(x._ptrnd(o.rect.x),x._ptrnd(y.y+y.height),x._ptrnd(o.rect.x+o.rect.width),x._ptrnd(y.y+y.height),{stroke:c,opacity:.5}))):(f.push(e.renderer.line(x._ptrnd(o.rect.x),x._ptrnd(o.rect.y),x._ptrnd(y.x),x._ptrnd(o.rect.y),{stroke:c,opacity:.5})),f.push(e.renderer.line(x._ptrnd(y.x+y.width),x._ptrnd(o.rect.y),x._ptrnd(o.rect.x+o.rect.width),x._ptrnd(o.rect.y),{stroke:c,opacity:.5})),f.push(e.renderer.line(x._ptrnd(y.x),x._ptrnd(o.rect.y),x._ptrnd(y.x),x._ptrnd(o.rect.y+o.rect.height),{stroke:c,opacity:.5})),f.push(e.renderer.line(x._ptrnd(y.x+y.width),x._ptrnd(o.rect.y),x._ptrnd(y.x+y.width),x._ptrnd(o.rect.y+o.rect.height),{stroke:c,opacity:.5}))),e.renderer.refresh();let _=l.getImageData(s.x,s.y,s.width,s.height);const b=t.getContext("2d"),v=r.getBoundingClientRect(),A=e.getBoundingClientRect();b.putImageData(_,A.left-v.left,A.top-v.top,1,1,s.width,s.height);for(let t=0;t<f.length;t++)e.renderer.removeElement(f[t]);e.renderer.refresh()}return!0}refresh(){this._internalRefresh()}update(){this._isUpdate=!0,this._internalRefresh()}clear(){const e=this;e.caption="",e.description="",e.refresh()}_validateSeriesGroups(){const e=this;Array.isArray(this.seriesGroups)||e.seriesGroups instanceof Smart.ObservableArray||e.error(e.localize("invalidSeriesGroups"));for(let t=0;t<this.seriesGroups.length;t++){const i=this.seriesGroups[t];i.type||e.error(e.localize("missingType")),Array.isArray(i.series)||i.series instanceof Smart.ObservableArray||e.error(e.localize("invalidSeries"))}}_render(e){var t=Math.max,r=this,n=r.renderer;r._colorsCache.clear(),!r._isToggleRefresh&&r._isUpdate&&r._renderData&&r._renderDataClone(),r._renderData=[],n.clear(),r._unselect(),r._hideToolTip(0);var i=r.backgroundImage;r.style.backgroundImage=void 0===i||null===i||""===i?"":-1===i.indexOf("(")?"url(\""+i+"\")":i,r._rect=e;var s=r.padding||{left:5,top:5,right:5,bottom:5},a=n.createClipRect(e),l=n.beginGroup();n.setClip(l,a);var o=n.rect(e.x,e.y,e.width-2,e.height-2);if(void 0===i||null===i||""===i?n.attr(o,{fill:r.backgroundColor||r._getThemeColor("background")}):n.attr(o,{fill:"transparent"}),!1!==r.showBorderLine){var d=this.borderLineWidth;(isNaN(d)||0>d||10<d)&&(d=1),n.attr(o,{"stroke-width":d,stroke:r.borderLineColor||r._getThemeColor("line")})}"function"==typeof r.drawBefore&&r.drawBefore(n,e);var g={x:s.left,y:s.top,width:e.width-s.left-s.right,height:e.height-s.top-s.bottom};r._paddedRect=g;var u=r.titlePadding||{left:2,top:2,right:2,bottom:2},p;r.caption&&0<r.caption.length&&(p=n.measureText(r.caption,0,{class:"smart-chart-title-text"}),n.text(r.caption,g.x+u.left,g.y+u.top,g.width-(u.left+u.right),p.height,0,{class:"smart-chart-title-text"},!0,"center","center"),g.y+=p.height,g.height-=p.height),r.description&&0<r.description.length&&(p=n.measureText(r.description,0,{class:"smart-chart-title-description"}),n.text(r.description,g.x+u.left,g.y+u.top,g.width-(u.left+u.right),p.height,0,{class:"smart-chart-title-description"},!0,"center","center"),g.y+=p.height,g.height-=p.height),(r.caption||r.description)&&(g.y+=u.bottom+u.top,g.height-=u.bottom+u.top);var m={x:g.x,y:g.y,width:g.width,height:g.height};r._plotRect=m,r._buildStats(m);var h=r._isPieOnlySeries(),c=r.seriesGroups,f={xAxis:{},valueAxis:{}},_;for(let t=0;t<c.length&&!h;t++){if("pie"===c[t].type||"donut"===c[t].type)continue;var b=r._getXAxis(t);b||r.error(r.localize("missingAxis",{index:t,axis:"xAxis"}));let e=b===r._getXAxis()?-1:t;f.xAxis[e]=0}var v=r.axisPadding;isNaN(v)&&(v=5);var A={left:0,right:0,leftCount:0,rightCount:0},S=[];for(let t=0;t<c.length;t++){const e=c[t];if("pie"===e.type||"donut"===e.type||!0===e.spider||!0===e.polar){S.push({width:0,position:0,xRel:0});continue}_="horizontal"===e.orientation;var b=r._getXAxis(t);let i=b===r._getXAxis()?-1:t;var k=r._getValueAxis(t),C=k===r._getValueAxis()?-1:t,I=_?b.axisSize:k.axisSize,M={x:0,y:m.y,width:m.width,height:m.height},F=_?r._getXAxis(t).position:k.position;I&&"auto"!==I||(_?(I=this._renderXAxis(t,M,!0,m).width,1==(1&f.xAxis[i])?I=0:0<I&&(f.xAxis[i]|=1)):(I=r._renderValueAxis(t,M,!0,m).width,1==(1&f.valueAxis[C])?I=0:0<I&&(f.valueAxis[C]|=1))),"left"!==F&&!0===r.rightToLeft&&(F="right"),"right"!==F&&(F="left"),0<A[F+"Count"]&&0<A[F]&&0<I&&(A[F]+=v),S.push({width:I,position:F,xRel:A[F]}),A[F]+=I,A[F+"Count"]++}var D=t(1,t(e.width,e.height)),T={top:0,bottom:0,topCount:0,bottomCount:0},O=[];for(let t=0;t<c.length;t++){const e=c[t];if("pie"===e.type||"donut"===e.type||!0===e.spider||!0===e.polar){O.push({height:0,position:0,yRel:0});continue}_="horizontal"===e.orientation;var k=this._getValueAxis(t),C=k===r._getValueAxis()?-1:t,b=r._getXAxis(t);let i=b===r._getXAxis()?-1:t,n=_?k.axisSize:b.axisSize;var F=_?k.position:b.position;n&&"auto"!==n||(_?(n=r._renderValueAxis(t,{x:0,y:0,width:D,height:0},!0,m).height,2==(2&f.valueAxis[C])?n=0:0<n&&(f.valueAxis[C]|=2)):(n=r._renderXAxis(t,{x:0,y:0,width:D,height:0},!0).height,2==(2&f.xAxis[i])?n=0:0<n&&(f.xAxis[i]|=2))),"top"!==F&&(F="bottom"),0<T[F+"Count"]&&0<T[F]&&0<n&&(T[F]+=v),O.push({height:n,position:F,yRel:T[F]}),T[F]+=n,T[F+"Count"]++}r._createAnimationGroup("series");const R=!1!==r.showLegend,L=r._legendLayout;var P=R?r._renderLegend(L?r._rect:g,!0):{width:0,height:0};if(!L||isNaN(this.legendLayout.left)&&isNaN(this.legendLayout.top)||(P={width:0,height:0}),g.height<T.top+T.bottom+P.height||g.width<A.left+A.right)return void n.endGroup();m.height-=T.top+T.bottom+P.height,m.x+=A.left,m.width-=A.left+A.right,m.y+=T.top;var G=[];if(!h)for(let e=0;e<c.length;e++){const t=c[e];if(!0===t.polar||!0===t.spider||"pie"===t.type||"donut"===t.type)continue;_="horizontal"===t.orientation;var V=r._getXAxis(e)===r._getXAxis()?-1:e,C=r._getValueAxis(e)===r._getValueAxis()?-1:e;let i={x:m.x,y:0,width:m.width,height:O[e].height};if(i.y="top"===O[e].position?m.y-O[e].yRel-O[e].height:m.y+m.height+O[e].yRel,_){if(4==(4&f.valueAxis[C]))continue;if(!r._isGroupVisible(e))continue;r._renderValueAxis(e,i,!1,m),f.valueAxis[C]|=4}else{if(G.push(i),4==(4&f.xAxis[V]))continue;if(!r._isGroupVisible(e))continue;r._renderXAxis(e,i,!1,m),f.xAxis[V]|=4}}if(R){const e=r._legendLayout,t=e?r._rect:g;var E=g.x+this.renderer._ptrnd((g.width-P.width)/2),B=m.y+m.height+T.bottom,I=g.width;let i=P.height;e&&(!isNaN(r.legendLayout.left)&&(E=r.legendLayout.left),!isNaN(r.legendLayout.top)&&(B=r.legendLayout.top),!isNaN(r.legendLayout.width)&&(I=r.legendLayout.width),!isNaN(r.legendLayout.height)&&(i=r.legendLayout.height)),E+I>t.x+t.width&&(I=t.x+t.width-E),B+i>t.y+t.height&&(i=t.y+t.height-B),r._renderLegend({x:E,y:B,width:I,height:i})}if(r._hasHorizontalLines=!1,!h)for(let e=0;e<c.length;e++){const t=c[e];if(!0===t.polar||!0===t.spider||"pie"===t.type||"donut"===t.type)continue;_="horizontal"===c[e].orientation;let i={x:m.x-S[e].xRel-S[e].width,y:m.y,width:S[e].width,height:m.height};"left"!==S[e].position&&(i.x=m.x+m.width+S[e].xRel);var V=r._getXAxis(e)===r._getXAxis()?-1:e,C=r._getValueAxis(e)===r._getValueAxis()?-1:e;if(_){if(G.push(i),8==(8&f.xAxis[V]))continue;if(!r._isGroupVisible(e))continue;r._renderXAxis(e,i,!1,m),f.xAxis[V]|=8}else{if(8==(8&f.valueAxis[C]))continue;if(!r._isGroupVisible(e))continue;r._renderValueAxis(e,i,!1,m),f.valueAxis[C]|=8}}if(!(0>=m.width||0>=m.height)){r._plotRect={x:m.x,y:m.y,width:m.width,height:m.height};for(let e=0;e<c.length;e++)this._drawPlotAreaLines(e,!0,{gridLines:!1,tickMarks:!1,alternatingBackground:!0}),this._drawPlotAreaLines(e,!1,{gridLines:!1,tickMarks:!1,alternatingBackground:!0});for(let e=0;e<c.length;e++)this._drawPlotAreaLines(e,!0,{gridLines:!0,tickMarks:!0,alternatingBackground:!1}),this._drawPlotAreaLines(e,!1,{gridLines:!0,tickMarks:!0,alternatingBackground:!1});var H=!1;for(let e=0;e<c.length&&!H;e++){const t=c[e];if(void 0!==t.annotations||"function"==typeof t.draw||"function"==typeof t.drawBefore){H=!0;break}}var j=n.beginGroup();if(r.clip&&!H){var z=n.createClipRect({x:m.x-2,y:m.y,width:m.width+4,height:m.height});n.setClip(j,z)}for(let t=0;t<c.length;t++){const i=c[t];var W=!1;for(var X in r._seriesTypes)if(r._seriesTypes[X]===i.type){W=!0;break}W||r.error(r.localize("invalidType",{type:i.type})),"function"==typeof i.drawBefore&&i.drawBefore(n,e,t,this),(!0===i.polar||!0===i.spider)&&-1===i.type.indexOf("pie")&&-1===i.type.indexOf("donut")&&r._renderSpiderAxis(t,m),r._renderAxisBands(t,m,!0),r._renderAxisBands(t,m,!1)}for(let t=0;t<c.length;t++){const i=c[t];if(r._isColumnType(i.type)?r._renderColumnSeries(t,m):-1!==i.type.indexOf("pie")||-1!==i.type.indexOf("donut")?r._renderPieSeries(t,m):-1!==i.type.indexOf("line")||-1!==i.type.indexOf("area")?r._renderLineSeries(t,m):-1!==i.type.indexOf("scatter")||-1!==i.type.indexOf("bubble")?r._renderScatterSeries(t,m):(-1!==i.type.indexOf("candlestick")||-1!==i.type.indexOf("ohlc"))&&r._renderCandleStickSeries(t,m,-1!==i.type.indexOf("ohlc")),i.annotations){this._moduleAnnotations||r.error(r.localize("missingReference",{files:"smartchart.annotations.js"}));for(let e=0;e<i.annotations.length;e++)r._renderAnnotation(t,i.annotations[e],m)}"function"==typeof i.draw&&i.draw(n,e,t,this)}if(n.endGroup(),r.disabled){var N=n.rect(e.x,e.y,e.width,e.height);n.attr(N,{fill:"#777777",opacity:.5,stroke:"#00FFFFFF"})}"function"==typeof r.draw&&r.draw(n,e),n.endGroup(),r._startAnimation("series"),r._credits&&r._credits();var U=!1;for(let e=0;e<r.seriesGroups.length&&!U;e++){var b=r._getXAxis(e);b&&b.rangeSelector&&b.rangeSelector.visible&&(U=!0,r._hasRangeSelector=!0)}if(U){this._moduleRangeSelector||r.error(r.localize("missingReference",{files:"smartchart.rangeselector.js"}));var Y=[];r._isSelectorRefresh||(r._rangeSelectorInstances={});for(let e=0;e<r.seriesGroups.length;e++){var Z=this._getXAxis(e);-1===Y.indexOf(Z)&&this._renderXAxisRangeSelector(e,G[e])&&Y.push(Z)}}}}_credits(){}_isPieOnlySeries(){let e=this.seriesGroups;if(0===e.length)return!1;for(let t=0;t<e.length;t++)if("pie"!==e[t].type&&"donut"!==e[t].type)return!1;return!0}_renderChartLegend(e,t,n,s){var a=this,l=a.renderer,o={x:t.x,y:t.y,width:t.width,height:t.height},i=3;o.width>=2*i&&(o.x+=i,o.width-=2*i),o.height>=2*i&&(o.y+=i,o.height-=2*i);var r={width:o.width,height:0},d=0,u=0,p=20,h=0,m=10,c=10,f=0;for(let y=0;y<e.length;y++){var _=e[y].css;_||(_="smart-chart-legend-text"),p=20;var b=e[y].text,v=l.measureText(b,0,{class:_});v.height>p&&(p=v.height),v.width>f&&(f=v.width),s?(0!=y&&(u+=p),u>o.height&&(u=0,d+=f+2*c+m,f=v.width,r.width=d+f)):(0!==d&&(d+=c),d+2*m+v.width>o.width&&v.width<o.width&&(d=0,u+=p,p=20,h=o.width,r.height=u+p));var A=!1;if(v.width>o.width){A=!0;var w=o.width,S=b,k=S.split(/\s+/);let e=[],t="";for(let i=0;i<k.length;i++){var C=t+(0<t.length?" ":"")+k[i],I=a.renderer.measureText(C,0,{class:_});I.width>w&&0<C.length&&0<t.length?(e.push({text:t}),t=k[i]):t=C,i+1===k.length&&e.push({text:t})}v.width=0;var M=0;for(let i=0;i<e.length;i++){var F=e[i].text,I=a.renderer.measureText(F,0,{class:_});v.width=Math.max(v.width,I.width),M+=v.height}v.height=M}var D=d+v.width<o.width&&u+v.height<t.height;if(a._legendLayout)var D=o.x+d+v.width<a._rect.x+a._rect.width&&o.y+u+v.height<a._rect.y+a._rect.height;if(!n&&D){var T=e[y].seriesIndex,O=e[y].groupIndex,R=e[y].itemIndex,L=e[y].fillColor,P=e[y].lineColor,G=a._isSerieVisible(O,T,R),V=l.beginGroup(),g=G?e[y].opacity:.1;if(A){var S=b,w=o.width,k=S.split(/\s+/),E=0;let i=[],t="";for(let e=0;e<k.length;e++){var C=t+(0<t.length?" ":"")+k[e],I=a.renderer.measureText(C,0,{class:_});I.width>w&&0<C.length&&0<t.length?(i.push({text:t,dy:E}),E+=I.height,t=k[e]):t=C,e+1===k.length&&i.push({text:t,dy:E})}for(let e=0;e<i.length;e++){var F=i[e].text;E=i[e].dy;var I=a.renderer.measureText(F,0,{class:_});s?a.renderer.text(F,o.x+d+1.5*m,o.y+u+E,v.width,p,0,{class:_},!1,"left","center"):a.renderer.text(F,o.x+d+1.5*m,o.y+u+E,v.width,p,0,{class:_},!1,"center","center")}let r=l.rect(o.x+d,o.y+u+m/2+E/2,m,m);s&&(u+=E),a.renderer.attr(r,{fill:L,"fill-opacity":g,stroke:P,"stroke-width":1,"stroke-opacity":e[y].opacity})}else{let t=l.rect(o.x+d,o.y+u+m/2,m,m);a.renderer.attr(t,{fill:L,"fill-opacity":g,stroke:P,"stroke-width":1,"stroke-opacity":e[y].opacity,purpose:"legend-toggle",data:e[y]});let i;i=s?a.renderer.text(b,o.x+d+1.5*m,o.y+u,v.width,v.height+m/2,0,{class:_},!1,"left","center"):a.renderer.text(b,o.x+d+1.5*m,o.y+u,v.width,p,0,{class:_},!1,"center","center"),l.attr(i,{purpose:"legend-toggle",data:e[y]})}a.renderer.endGroup(),a._setLegendToggleHandler(O,T,R,V)}s||(d+=v.width+2*m,h<d&&(h=d))}if(n)return r.height=this.renderer._ptrnd(u+p+5),r.width=this.renderer._ptrnd(h),r}isSerieVisible(e,t,i){return this._isSerieVisible(e,t,i)}_isSerieVisible(e,t,i){for(;this._itemsToggleState.length<e+1;)this._itemsToggleState.push([]);let r=this._itemsToggleState[e];for(;r.length<t+1;)r.push(!!isNaN(i)||[]);let n=r[t];if(isNaN(i))return n;for(Array.isArray(n)||(r[t]=n=[]);n.length<i+1;)n.push(!0);return n[i]}isGroupVisible(e){return this._isGroupVisible(e)}_isGroupVisible(e){let t=!1,r=this.seriesGroups[e].series;if(!r)return t;for(let n=0;n<r.length;n++)if(this._isSerieVisible(e,n)){t=!0;break}return t}_toggleSerie(e,t,i,r){let n=!this._isSerieVisible(e,t,i);void 0!==r&&(n=r);let s=this.seriesGroups[e],a=s.series[t];if(this.$.fireEvent("toggle",{state:n,seriesGroup:s,serie:a,elementIndex:i}),isNaN(i))this._itemsToggleState[e][t]=n;else{let r=this._itemsToggleState[e][t];for(Array.isArray(r)||(r=[]);r.length<i;)r.push(!0);r[i]=n}this._isToggleRefresh=!0,this.update(),this._isToggleRefresh=!1}showSerie(e,t,i){this._toggleSerie(e,t,i,!0)}hideSerie(e,t,i){this._toggleSerie(e,t,i,!1)}_setLegendToggleHandler(e,t,i,r){let n=this.seriesGroups[e],a=n.series[t],s=a.enableSeriesToggle;if((void 0===s||null===s)&&(s=!1!==n.enableSeriesToggle),s){let n=this;this.renderer.addHandler(r,"click",function(){n._toggleSerie(e,t,i)})}}_renderLegend(e,t){let r=this,n=[];for(let a=0,i;a<r.seriesGroups.length;a++)if(i=r.seriesGroups[a],!1!==i.showLegend)for(let e=0,t;e<i.series.length;e++){if(t=i.series[e],!1===t.showLegend)continue;let s=r._getSerieSettings(a,e),l;if("pie"===i.type||"donut"===i.type){let o=r._getXAxis(a);const d=t.legendFormatSettings||i.legendFormatSettings||r._getFormatSettings(o)||r._getFormatSettings(t)||r._getFormatSettings(i);let g=t.legendFormatFunction||i.legendFormatFunction||o.formatFunction||t.formatFunction||i.formatFunction,u=r._getDataLen(a);for(let o=0;o<u;o++){l=r._getDataValue(o,t.displayText,a),l=r._formatValue(l,d,g,a,e,o);let i=r._getColors(a,e,o);n.push({groupIndex:a,seriesIndex:e,itemIndex:o,text:l,css:t.displayTextClass,fillColor:i.fillColor,lineColor:i.lineColor,opacity:s.opacity})}continue}const o=t.legendFormatSettings||i.legendFormatSettings;let d=t.legendFormatFunction||i.legendFormatFunction;l=r._formatValue(t.displayText||t.dataField||"",o,d,a,e,NaN);let g=r._getSeriesColors(a,e),u=this._get([t.legendFillColor,t.legendColor,g.fillColor]),p=this._get([t.legendLineColor,t.legendColor,g.lineColor]);n.push({groupIndex:a,seriesIndex:e,text:l,css:t.displayTextClass,fillColor:u,lineColor:p,opacity:s.opacity})}return r._renderChartLegend(n,e,t,r._legendLayout&&"vertical"===r.legendLayout.flow)}_getInterval(e,t){if(!e)return t;let i=this._get([e.unitInterval,t]);return isNaN(e.step)||null===e.step||(i=e.step*t),i}_getOffsets(e,t,i,r,n,s,a,l,o){let d=this._getInterval(n[e],l),g=[];(""===e||n[e].visible&&"custom"!==n[e].visible)&&(g=this._generateIntervalValues(r,d,l,a,o));let u;if("labels"!==e){let e=a?s.left:0;if(!a&&1<l&&(e=s.left*(l+1)),1===g.length&&(e*=2),u=this._valuesToOffsets(g,t,r,i,s,!1,e),!a){let e=(s.left+s.right)*d/l;t.flip?u.unshift(u[0]+e):u.push(u[u.length-1]+e)}}else{let e=s.left;1===g.length&&(e*=2),u=this._valuesToOffsets(g,t,r,i,s,a,e)}let p=this._arraysToObjectsArray([g,u],["value","offset"]);if(t[e]&&t[e].custom){let n=this._objectsArraysToArray(t[e].custom,"value"),l=this._objectsArraysToArray(t[e].custom,"offset"),o=this._valuesToOffsets(n,t,r,i,s,a,s.left);for(let r=0;r<t[e].custom.length;r++)p.push({value:n[r],offset:isNaN(l[r])?o[r]:l[r]})}return p}_renderXAxis(e,t,i,r){let n=this,s=n._getXAxis(e),a=n.seriesGroups[e],l="horizontal"===a.orientation,o={width:0,height:0},d=n._getAxisSettings(s);if(!s||!d.visible||"spider"===a.type)return o;if(!n._isGroupVisible(e)||this._isPieGroup(e))return o;let g=n._alignValuesWithTicks(e);for(;n._renderData.length<e+1;)n._renderData.push({});n.rightToLeft&&(s.flip=!0);let u=l?t.height:t.width,p=n._calculateXOffsets(e,u),h=p.axisStats,y=s.rangeSelector&&s.rangeSelector.visible,m=0;y&&(!this._moduleRangeSelector&&n.error(n.localize("missingReference",{files:"smartchart.rangeselector.js"})),m=this._selectorGetSize(s));let c=l&&"right"===s.position||!l&&"top"===s.position;!i&&y&&(l?(t.width-=m,"right"!==s.position&&(t.x+=m)):(t.height-=m,"top"===s.position&&(t.y+=m)));let f={rangeLength:p.rangeLength,itemWidth:p.itemWidth,intervalWidth:p.intervalWidth,data:p,settings:d,isMirror:c,rect:t};n._renderData[e].xAxis=f;let x=h.interval;if(isNaN(x))return o;l&&(d.title.angle-=90,d.labels.angle-=90);let _=this._getInterval(d.gridLines,x),b=this._getInterval(d.tickMarks,x),v=this._getInterval(d.labels,x),A=h.min,w=h.max,S=p.padding,k=!0===s.flip||n.rightToLeft,C={min:A,max:w},I;h.logAxis.enabled&&(C.min=h.logAxis.minPow,C.max=h.logAxis.maxPow),"date"===s.type?(d.gridLines.offsets=this._generateDTOffsets(A,w,u,S,_,x,h.dateTimeUnit,g,NaN,!1,k),d.tickMarks.offsets=this._generateDTOffsets(A,w,u,S,b,x,h.dateTimeUnit,g,NaN,!1,k),I=this._generateDTOffsets(A,w,u,S,v,x,h.dateTimeUnit,g,NaN,!0,k)):(d.gridLines.offsets=this._getOffsets("gridLines",s,u,h,d,S,g,x),d.tickMarks.offsets=this._getOffsets("tickMarks",s,u,h,d,S,g,x),I=this._getOffsets("labels",s,u,h,d,S,g,x));let M;n._elementRenderInfo&&n._elementRenderInfo.length>e&&(M=n._elementRenderInfo[e].xAxis);let F=[],D;d.labels.formatFunction&&(D=d.labels.formatFunction);const T=n._getFormatSettings(d.labels);let O;T&&(O=Object.assign({},T)),"date"===s.type&&(s.dateFormat&&!D?O?O.dateFormat=O.dateFormat||s.dateFormat:O={dateFormat:s.dateFormat}:!D&&(!O||O&&!O.dateFormat)&&(D=this._getDefaultDTFormatFn(s.baseUnit||"day")));for(let a=0;a<I.length;a++){let t=I[a].value,i=I[a].offset;if(isNaN(i))continue;let r;"date"!==s.type&&h.useIndeces&&s.dataField&&(r=Math.round(t),t=n._getDataValue(r,s.dataField,e),(void 0===t||null===t)&&(t=""));let l=n._formatValue(t,O,D,e,void 0,r);(void 0===l||null===l||""===l.toString())&&(isNaN(r)&&(r=a),r>=h.filterRange.min&&r<=h.filterRange.max&&(l=h.useIndeces?(h.min+r).toString():void 0===t?"":t.toString()));let o={key:t,text:l,targetX:i,x:i};M&&M.itemOffsets[t]&&(o.x=M.itemOffsets[t].x,o.y=M.itemOffsets[t].y),F.push(o)}let R=n._getAnimProps(e),L=R.enabled&&500>F.length?R.duration:0;!1===n.enableAxisTextAnimation&&(L=0);let P=n._renderAxis(l,c,d,{x:t.x,y:t.y,width:t.width,height:t.height},r,x,!1,!0,{items:F,renderData:f},i,L);return l?P.width+=m:P.height+=m,P}_animateAxisText(e,t){let r=e.items,n=e.textSettings;for(let s=0,i;s<r.length;s++){if(i=r[s],!i)continue;if(!i.visible)continue;let e=i.targetX,a=i.targetY;isNaN(i.x)||isNaN(i.y)||(e=i.x+(e-i.x)*t,a=i.y+(a-i.y)*t),i.element&&(this.renderer.removeElement(i.element),i.element=void 0),i.element=this.renderer.text(i.text,e,a,i.width,i.height,n.angle,{class:n.style},!1,n.halign,n.valign,n.textRotationPoint)}}_getPolarAxisCoords(e,t){var i=Math.abs,r=Math.PI;let n=this.seriesGroups[e],s=t.x+this._draw.getNum([n.offsetX,t.width/2]),a=t.y+this._draw.getNum([n.offsetY,t.height/2]),l=Math.min(t.width,t.height),o=n.radius;this._isPercent(o)&&(o=parseFloat(o)/100*l/2),isNaN(o)&&(o=.6*(l/2));let d=this._alignValuesWithTicks(e),g=this._get([n.startAngle,n.minAngle,0])-90;g=isNaN(g)?0:2*r*g/360;let u=this._get([n.endAngle,n.maxAngle,360])-90;if(u=isNaN(u)?2*r:2*r*u/360,g>u){let e=g;g=u,u=e}let p=this.renderer._rnd(i(g-u)/(2*r),.001,!0),h=2*r*o*p,y=this._calcGroupOffsets(e,t).xoffsets;if(!y)return;let m=!(1e-5<i(i(u-g)-2*r)),c;if(n.spider){const t=this._getXAxisStats(e,this._getXAxis(e),h);let r=t.interval;(isNaN(r)||0===r)&&(r=1);let n=(t.max-t.min)/r+(m?1:0);if(n=Math.round(n),2<n){let e=Math.cos(i(u-g)/2/n);e=this.renderer._rnd(e,.01),0===e&&(e=1),c=o/e,c>o&&d&&(o=c)}}return o=this.renderer._ptrnd(o),{x:s,y:a,r:o,adjR:this._get([c,o]),itemWidth:y.itemWidth,rangeLength:y.rangeLength,valuesOnTicks:d,startAngle:g,endAngle:u,isClosedCircle:m,axisSize:h}}_toPolarCoord(e,t,i,r){var n=Math.PI,s=Math.max;let a=Math.abs(e.startAngle-e.endAngle)/(2*n),l=2*(i-t.x)*n*a/s(1,t.width)+e.startAngle,o=(t.height+t.y-r)*e.r/s(1,t.height),d=e.x+o*Math.cos(l),g=e.y+o*Math.sin(l);return{x:this.renderer._ptrnd(d),y:this.renderer._ptrnd(g)}}_renderSpiderAxis(e,t){var r=Math.sin,n=Math.cos,i=Math.abs,s=Math.PI,a=Math.min,l=Math.max;let o=this,d=o._getXAxis(e),g=this._getAxisSettings(d);if(!d||!g.visible)return;let u=o.seriesGroups[e],p=o._getPolarAxisCoords(e,t);if(!p)return;let h=this.renderer._ptrnd(p.x),y=this.renderer._ptrnd(p.y),m=p.adjR,c=p.startAngle,f=p.endAngle;if(1>m)return;let x=this.renderer._rnd(i(c-f)/(2*s),.001,!0),_=2*s*m*x,b=p.isClosedCircle,v=this._renderData[e].xoffsets;if(!v.rangeLength)return;let A=v.axisStats.interval;for((isNaN(A)||1>A)&&(A=1);o._renderData.length<e+1;)o._renderData.push({});let w={rangeLength:v.rangeLength,itemWidth:v.itemWidth,data:v,rect:t,settings:g};o._renderData[e].xAxis=w,o._renderData[e].polarCoords=p;let S=!0;for(let r=0;r<e;r++){let e=o._renderData[r].polarCoords,t=o._getXAxis(r),i=!1;for(let t in p)if(p[t]!==e[t]){i=!0;break}i&&t===d||(S=!1)}let k=g.gridLines,C=g.tickMarks,I=g.labels,M=this._getInterval(k,A),F=this._getInterval(C,A),D=this._getInterval(I,A),T=o._alignValuesWithTicks(e),O=o.renderer,R=v.axisStats,L=R.min,P=R.max,G=this._getPaddingSize(v.axisStats,d,T,_,!0,b,!1),V=!0===d.flip||o.rightToLeft,E;"date"===d.type?(k.offsets=this._generateDTOffsets(L,P,_,G,M,A,d.baseUnit,!0,0,!1,V),C.offsets=this._generateDTOffsets(L,P,_,G,F,A,d.baseUnit,!0,0,!1,V),E=this._generateDTOffsets(L,P,_,G,D,A,d.baseUnit,!0,0,!0,V)):(g.gridLines.offsets=this._getOffsets("gridLines",d,_,R,g,G,!0,A),g.tickMarks.offsets=this._getOffsets("tickMarks",d,_,R,g,G,!0,A),E=this._getOffsets("labels",d,_,R,g,G,!0,A));let B;o._elementRenderInfo&&o._elementRenderInfo.length>e&&(B=o._elementRenderInfo[e].xAxis);let H=[],j=this._getDataLen(e);for(let r=0;r<E.length;r++){let t=E[r].offset,i=E[r].value,n;if("date"!==d.type&&R.useIndeces&&d.dataField){if(n=Math.round(i),n>=j)continue;i=o._getDataValue(n,d.dataField),(void 0===i||null===i)&&(i="")}let s=o._formatValue(i,o._getFormatSettings(I.formatSettings),I.formatFunction,e,void 0,n);(void 0===s||null===s||""===s.toString())&&(s=R.useIndeces?(R.min+r).toString():void 0===i||null===i?"":i.toString());let a={key:i,text:s,targetX:t,x:t};B&&B.itemOffsets[i]&&(a.x=B.itemOffsets[i].x,a.y=B.itemOffsets[i].y),H.push(a)}let z={stroke:k.color||o._getThemeColor("line"),fill:"none","stroke-width":k.width,"stroke-dasharray":k.dashStyle||""};if(!u.spider)if(1===x)O.circle(h,y,m,z);else{let e=180*(-c/s),t=180*(-f/s);this.renderer.pieslice(h,y,0,m,a(e,t),l(e,t),void 0,z)}let W=c;if(k.visible&&S){T||b||k.offsets.unshift({offset:-G.right});for(let e=0,t;e<k.offsets.length;e++){t=k.offsets[e].offset,T||(b?t+=G.right/2:t+=G.right);const i=W+2*t*s*x/l(1,_);if(.01<i-f)continue;let a=this.renderer._ptrnd(h+m*n(i)),o=this.renderer._ptrnd(y+m*r(i));O.line(h,y,a,o,z)}}if(C.visible&&S){let e=5,t={stroke:C.color||o._getThemeColor("line"),fill:"none","stroke-width":C.width,"stroke-dasharray":C.dashStyle||""};T||b||C.offsets.unshift({offset:-G.right});for(let a=0,i;a<C.offsets.length;a++){i=C.offsets[a].offset,T||(b?i+=G.right/2:i+=G.right);const o=W+2*i*s*x/l(1,_);if(.01<o-f)continue;let d={x:h+m*n(o),y:y+m*r(o)},g={x:h+(m+e)*n(o),y:y+(m+e)*r(o)};O.line(this.renderer._ptrnd(d.x),this.renderer._ptrnd(d.y),this.renderer._ptrnd(g.x),this.renderer._ptrnd(g.y),t)}}let X=[];if(u.spider){let e=[];e="date"===d.type?this._generateDTOffsets(L,P,_,G,A,A,d.baseUnit,!0,0,!1,V):this._getOffsets("",d,_,R,g,G,!0,A),T||b||e.unshift({offset:-G.right});for(let t=0,i;t<e.length;t++){i=e[t].offset,T||(b?i+=G.right/2:i+=G.right);const r=W+2*i*s*x/l(1,_);.01<r-f||X.push(r)}w.offsetAngles=X}let N=o._renderSpiderValueAxis(e,t,T?p.adjR:p.r,X);if(N||(N=[]),u.spider){if(!T)for(let e=0;e<N.length;e++)N[e]=N[e]*p.adjR/p.r;N.push(m),this._renderSpiderLines(h,y,N,p,X,z)}if(S&&I.visible){w.polarLabels=[];for(let e=0;e<H.length;e++){let t=H[e].x,r=W+2*t*s*x/l(1,_);r=(360-360*(r/(2*s)))%360,0>r&&(r=360+r);let n=O.measureText(H[e].text,0,{class:g.labels.style}),o=(T?p.adjR:p.r)+(C.visible?7:2),d=g.labels,u;if(d.autoRotate){let e=this._draw._ptRotate(h-n.width/2,y-o-n.height,h,y,-r/180*s),t=this._draw._ptRotate(h+n.width/2,y-o,h,y,-r/180*s);n.width=i(e.x-t.x),n.height=i(e.y-t.y),u={x:a(e.x,t.x),y:a(e.y,t.y)}}else u=this._adjustTextBoxPosition(h,y,n,o,r,!1,!1,!1);w.polarLabels.push({x:u.x,y:u.y,value:H[e].text}),O.text(H[e].text,u.x,u.y,n.width,n.height,d.autoRotate?90-r:d.angle,{class:d.style},!1,d.halign,d.valign)}}}_renderSpiderLines(e,t,i,r,n,s){let a=this.renderer,l=r.isClosedCircle;for(let o=0;o<i.length;o++){let r=i[o],d,g;for(let l=0;l<n.length;l++){let i=n[l],o=this.renderer._ptrnd(e+r*Math.cos(i)),u=this.renderer._ptrnd(t+r*Math.sin(i));d&&a.line(d.x,d.y,o,u,s),d={x:o,y:u},g||(g={x:o,y:u})}g&&l&&a.line(d.x,d.y,g.x,g.y,s)}}_renderSpiderValueAxis(e,t,r,i){var n=Math.sin,s=Math.cos,a=Math.abs,l=Math.PI,o=Math.min,d=Math.max,g=this,u=this.seriesGroups[e],p=this._getPolarAxisCoords(e,t);if(p){var h=this.renderer._ptrnd(p.x),m=this.renderer._ptrnd(p.y);r=r||p.r;var c=p.startAngle,f=p.endAngle,_=this.renderer._rnd(a(c-f)/(2*l),.001,!0);if(!(1>r)){r=this.renderer._ptrnd(r);var b=this._getValueAxis(e);const t=this._getAxisSettings(b);if(b&&!1!==t.visible){var y=this._stats.seriesGroups[e].mu,v=t.labels,A=g._getFormatSettings(v),w=-1!==u.type.indexOf("stacked")&&-1!==u.type.indexOf("100");w&&!A&&(A={sufix:"%"});var S=this._get([v.step,v.unitInterval/y]);isNaN(S)&&(S=1),S=d(1,Math.round(S)),this._calcValueAxisItems(e,r,S);var k=t.gridLines,C=t.tickMarks,I=t.labels,M={stroke:k.color||g._getThemeColor("line"),fill:"none","stroke-width":1,"stroke-dasharray":k.dashStyle||""},F=this._renderData[e].valueAxis,D=F.items,T=c;if(D.length&&t.line.visible){isNaN(t.line.angle)||(T=2*l*t.line.angle/360);var O=h+s(T)*r,R=m+n(T)*r;if(-1===i.indexOf(T)){var L=Object.assign({},M);L["stroke-width"]=t.line.lineWidth,L.stroke=t.line.color||g._getThemeColor("line"),L["stroke-dasharray"]=t.line.dashStyle,this.renderer.line(h,m,O,R,L)}}D=D.reverse();var P=this.renderer;F.polarLabels=[];for(let e=0;e<D.length-1;e++){var G=D[e];if(isNaN(G))continue;var V=I.formatFunction?I.formatFunction(G):this._formatNumber(G,A),E=P.measureText(V,0,{class:I.style}),B=h+(!1===b.showTickMarks?2:3);let i=m-F.itemWidth*e-E.height/2;{var H=this._draw._ptRotate(B,i,h,m,T),j=this._draw._ptRotate(B+E.width,i+E.height,h,m,T);B=o(H.x,j.x),i=o(H.y,j.y),E.width=a(H.x-j.x),E.height=a(H.y-j.y)}B+=t.labels.textOffset.x,i+=t.labels.textOffset.y,F.polarLabels.push({x:B,y:i,value:V}),P.text(V,B,i,E.width,E.height,I.autoRotate?90+180*c/l:I.angle,{class:I.style},!1,I.halign,I.valign)}var z=!1!==b.valuesOnTicks,W=this._stats.seriesGroups[e],X=W.mu,N=!0===b.logarithmicScale;N&&(X=1);var U={min:W.min,max:W.max,logAxis:{enabled:!0===N,base:b.logarithmicScaleBase,minPow:W.minPow,maxPow:W.maxPow}};(k.visible||u.spider||b.alternatingBackgroundColor||b.alternatingBackgroundColor2)&&(k.offsets=this._getOffsets("gridLines",b,r,U,t,{left:0,right:0},z,X));var Y=[];if(k.visible||u.spider){let e={stroke:k.color||g._getThemeColor("line"),fill:"none","stroke-width":1,"stroke-dasharray":k.dashStyle||""};for(let t=0,i;t<k.offsets.length;t++)if(i=this.renderer._ptrnd(k.offsets[t].offset),i!==r){if(u.spider){Y.push(i);continue}if(1!==_){var Z=180*(-c/l),q=180*(-f/l);this.renderer.pieslice(h,m,0,i,o(Z,q),d(Z,q),void 0,e)}else P.circle(h,m,i,e)}}if(b.tickMarks&&(b.tickMarks.visible||b.showTickMarks)||(C.visible=!1),C.visible){C.offsets=this._getOffsets("tickMarks",b,r,U,t,{left:0,right:0},z,X);const e=2*C.size;let a={stroke:C.color||g._getThemeColor("line"),fill:"none","stroke-width":1,"stroke-dasharray":C.dashStyle||""};for(let t=0;t<C.offsets.length;t++){var J=C.offsets[t].offset,H={x:h+J*s(T)-e/2*n(T+l/2),y:m+J*n(T)-e/2*s(T+l/2)},j={x:h+J*s(T)+e/2*n(T+l/2),y:m+J*n(T)+e/2*s(T+l/2)};P.line(this.renderer._ptrnd(H.x),this.renderer._ptrnd(H.y),this.renderer._ptrnd(j.x),this.renderer._ptrnd(j.y),a)}}return Y}}}}_renderAxis(e,t,i,r,n,s,a,l,o,d,g){if(i.customDraw&&!d)return{width:NaN,height:NaN};let u=i.title,p=i.labels,y=i.tickMarks,m=i.padding,c=y.visible?y.size:0,f=2,x={width:0,height:0},_={width:0,height:0};e?x.height=_.height=r.height:x.width=_.width=r.width,!d&&t&&e&&(r.x-=r.width);let b=o.renderData,v=b.itemWidth;if(u.visible&&void 0!==u.text&&null!==u.text&&""!==u){let i=u.angle,n=this.renderer.measureText(u.text,i,{class:u.style});_.width=n.width,_.height=n.height,d||this.renderer.text(u.text,r.x+u.offset.x+(e?t?-m.right-f+2*r.width-_.width:f+m.left:0),r.y+u.offset.y+(e?0:t?m.top+f:r.height-f-_.height-m.bottom),e?_.width:r.width,e?r.height:_.height,i,{class:u.style},!0,u.halign,u.valign,u.rotationPoint)}let A=0,S=l?-v/2:0;l&&!e&&(p.halign="center");let k=r.x,C=r.y,I=p.textOffset;I&&(!isNaN(I.x)&&(k+=I.x),!isNaN(I.y)&&(C+=I.y)),e?(k+=m.left+f+(0<_.width?_.width+f:0)+(t?r.width-_.width:0),C+=S):(k+=S,t?(C+=0<_.height?_.height+3*f:2*f,C+=c-(l?c:c/4)):C+=l?c:c/4,C+=m.top);let M=0,F=0,D=o.items;b.itemOffsets={},(this._isToggleRefresh||!this._isUpdate)&&(g=0);let T=!1,O=0;for(let u=0;u<D.length&&p.visible;u++,A+=v){if(!D[u]||isNaN(v))continue;let i=D[u].text;isNaN(D[u].targetX)||(A=D[u].targetX);let n=this.renderer.measureText(i,p.angle,{class:p.style});if(n.width>F&&(F=n.width),n.height>M&&(M=n.height),O+=e?M:F,!d){if(e&&A>r.height+2||!e&&A>r.width+2)continue;const i=e?k+(t?0===_.width?c:c-f:0):k+A;let n=e?C+A:C;b.itemOffsets[D[u].key]={x:i,y:n},T||isNaN(D[u].x)&&(isNaN(D[u].y)||!g)||(T=!0),D[u].targetX=i,D[u].targetY=n,D[u].width=e?r.width-m.left-m.right-2*f-c-(0<_.width?_.width+f:0):v,D[u].height=e?v:r.height-m.top-m.bottom-2*f-c-(0<_.height?_.height+f:0),D[u].visible=!0}}if(b.avgWidth=0===D.length?0:O/D.length,!d){let e={items:D,textSettings:p};if((isNaN(g)||!T)&&(g=0),this._animateAxisText(e,0===g?1:0),0!==g){let t=this;this._enqueueAnimation("series",void 0,void 0,g,function(e,i,r){t._animateAxisText(i,r)},e)}}if(x.width+=2*f+c+_.width+F+(e&&0<_.width?f:0),x.height+=2*f+c+_.height+M+(!e&&0<_.height?f:0),e?x.width+=m.left+m.right:x.height+=m.top+m.bottom,!d&&i.line.visible){let n={stroke:i.line.color||self._getThemeColor("line"),"stroke-width":i.line.width,"stroke-dasharray":i.line.dashStyle||""};if(e){let e=r.x+r.width+(t?m.left:-m.right);e=this.renderer._ptrnd(e),this.renderer.line(e,r.y,e,r.y+r.height,n)}else{let e=this.renderer._ptrnd(r.y+(t?r.height-m.bottom:m.top));this.renderer.line(this.renderer._ptrnd(r.x),e,this.renderer._ptrnd(r.x+r.width+1),e,n)}}return x.width=this.renderer._rup(x.width),x.height=this.renderer._rup(x.height),x}_drawPlotAreaLines(e,t,r){var n=Math.abs,i=this.seriesGroups[e],s="horizontal"!==i.orientation;if(!this._renderData||this._renderData.length<=e)return;var a=t?"valueAxis":"xAxis",l=this._renderData[e][a];if(!l)return;var o=this._renderData.axisDrawState;o||(o=this._renderData.axisDrawState={});var d="",g;t?(d="valueAxis_"+(i.valueAxis?e:"")+(s?"swap":""),g=this._getValueAxis(e)):(d="xAxis_"+(i.xAxis?e:"")+(s?"swap":""),g=this._getXAxis(e)),o=o[d]?o[d]:o[d]={},t||(s=!s);var u=l.settings;if(!u)return;if(u.customDraw)return;var p=u.gridLines,h=u.tickMarks,m=u.padding,c=l.rect,f=this._plotRect;if(!p||!h)return;var _=.5,b={};let v={stroke:p.color||self._getThemeColor("line"),"stroke-width":p.width,"stroke-dasharray":p.dashStyle||""};var A=t?c.y+c.height:c.x,w=p.offsets;t&&!g.flip&&(w=w.slice(0),w=w.reverse());let S;if(w&&0<w.length){var k=NaN;for(let e=0;e<w.length;e++)if(s?(S=this.renderer._ptrnd(c.y+w[e].offset),S<c.y-_&&(S=this.renderer._ptrnd(c.y)),S>c.y+c.height&&(S=c.y+c.height)):(S=this.renderer._ptrnd(c.x+w[e].offset),S>c.x+c.width+_&&(S=this.renderer._ptrnd(c.x+c.width))),!isNaN(S)&&(isNaN(k)||!(2>n(S-k)))){if(k=S,r.gridLines&&!1!==p.visible&&!0!==o.gridLines&&(s?this.renderer.line(this.renderer._ptrnd(f.x),S,this.renderer._ptrnd(f.x+f.width),S,v):this.renderer.line(S,this.renderer._ptrnd(f.y),S,this.renderer._ptrnd(f.y+f.height),v)),b[S]=!0,r.alternatingBackground&&(p.alternatingBackgroundColor||p.alternatingBackgroundColor2)&&!0!==o.alternatingBackground){var C=0==e%2?p.alternatingBackgroundColor2:p.alternatingBackgroundColor;if(0<e&&C){var I;I=s?this.renderer.rect(this.renderer._ptrnd(f.x),A,this.renderer._ptrnd(f.width-1),S-A,v):this.renderer.rect(A,this.renderer._ptrnd(f.y),S-A,this.renderer._ptrnd(f.height),v),this.renderer.attr(I,{"stroke-width":0,fill:C,opacity:p.alternatingBackgroundOpacity||1})}}A=S}}if(v={stroke:h.color||self._getThemeColor("line"),"stroke-width":h.width,"stroke-dasharray":h.dashStyle||""},r.tickMarks&&h.visible&&!0!==o.tickMarks){var M=h.size;let e=h.offsets;var k=NaN;for(let r=0;r<e.length;r++)if(s?(S=this.renderer._ptrnd(c.y+e[r].offset),S<c.y-_&&(S=this.renderer._ptrnd(c.y)),S>c.y+c.height&&(S=c.y+c.height)):(S=this.renderer._ptrnd(c.x+e[r].offset),S>c.x+c.width+_&&(S=this.renderer._ptrnd(c.x+c.width))),!isNaN(S)&&(isNaN(k)||!(2>n(S-k)))){if(b[S-1]?S--:b[S+1]&&S++,s){if(S>c.y+c.height+_)break;}else if(S>c.x+c.width+_)break;k=S;var F=l.isMirror?M:-M;if(s){var D=c.x+c.width+("right"===g.position?m.left:-m.right);t||(D=c.x+(l.isMirror?m.left:-m.right+c.width)),this.renderer.line(D,S,D+F,S,v)}else{var T=c.y+(l.isMirror?c.height:0);T+=l.isMirror?-m.bottom:m.top,T=this.renderer._ptrnd(T),this.renderer.line(S,T,S,T-F,v)}}}o.tickMarks=o.tickMarks||r.tickMarks,o.gridLines=o.gridLines||r.gridLines,o.alternatingBackground=o.alternatingBackground||r.alternatingBackground}_calcValueAxisItems(e,t,r){var n=Math.pow;let s=this._stats.seriesGroups[e];if(!s||!s.isValid)return!1;let i=this.seriesGroups[e],a=this._getValueAxis(e),l=!1!==a.valuesOnTicks,o=s.intervals,d=t/o,g=s.min,u=s.mu,p=!0===a.logarithmicScale,h=a.logarithmicScaleBase||10,y=-1!==i.type.indexOf("stacked")&&-1!==i.type.indexOf("100");for(p&&(u=isNaN(a.unitInterval)?1:a.unitInterval),l||(o=Math.max(o-1,1));this._renderData.length<e+1;)this._renderData.push({});this._renderData[e].valueAxis={};let m=this._renderData[e].valueAxis;m.itemWidth=m.intervalWidth=d,m.items=[];let c=m.items;for(let a=0,i;a<=o;a++){if(i=0,i=p?y?s.max/n(h,o-a):g*n(h,a):l?g+a*u:g+(a+.5)*u,0!=a%r){c.push(NaN);continue}c.push(i)}return m.rangeLength=p&&!y?s.intervals:s.intervals*u,!0!==a.flip&&(c=c.reverse()),!0}_getDecimalPlaces(e,t,i){let r=0;isNaN(i)&&(i=10);for(let n=0,s;n<e.length;n++){if(s=void 0===t?e[n]:e[n][t],isNaN(s))continue;let a=s.toString();for(let e=0;e<a.length;e++)if(("0">a[e]||"9"<a[e])&&(r=a.length-(e+1),0<=r))return Math.min(r,i);for(0<r&&(s*=Math.pow(10,r));Math.round(s)!==s&&r<i;)r++,s*=10}return r}_renderValueAxis(e,t,i,r){let n=this.seriesGroups[e],s="horizontal"===n.orientation,a=this._getValueAxis(e);a||this.error(this.localize("missingAxis",{index:e,axis:"valueAxis"}));let l={width:0,height:0};if(!this._isGroupVisible(e)||this._isPieOnlySeries()||"spider"===n.type)return l;let o=!1!==a.valuesOnTicks,d=this._stats.seriesGroups[e],g=d.mu,u=!0===a.logarithmicScale,p=a.logarithmicScaleBase||10;if(u&&(g=isNaN(a.unitInterval)?1:a.unitInterval),0===g&&(g=1),isNaN(g))return l;let h=this._getAxisSettings(a),y=h.title,m=h.labels,c=a.labels||{},f=this._get([a.horizontalTextAlignment,c.horizontalAlignment]);f||0!==m.angle||(m.halign=s?"center":"right"===a.position?"left":"right");let x=this._get([m.step,m.unitInterval/g]);if(isNaN(x)&&(x=1),x=Math.max(1,Math.round(x)),!this._calcValueAxisItems(e,s?t.width:t.height,x)||!h.visible)return l;s||(y.angle=this.rightToLeft?90:-90,"centercenter"===y.rotationPoint&&("top"===y.valign?y.rotationPoint="rightcenter":"bottom"===y.valign&&(y.rotationPoint="leftcenter")));let _=this._renderData[e].valueAxis,b=this._getFormatSettings(m),v=-1!==n.type.indexOf("stacked")&&-1!==n.type.indexOf("100");v&&!b&&(b={sufix:"%"}),m.formatFunction||b&&null!==b.decimalPlaces&&void 0!==b.decimalPlaces||(b=b||{},b.decimalPlaces=this._getDecimalPlaces([d.min,d.max,g],void 0,3));let A=h.gridLines,w=s?t.width:t.height,S=!0===a.flip;a.flip=!S;let k={min:d.min,max:d.max,logAxis:{enabled:!0===u,base:p,minPow:d.minPow,maxPow:d.maxPow}};(A.visible||a.alternatingBackgroundColor||a.alternatingBackgroundColor2)&&(A.offsets=this._getOffsets("gridLines",a,w,k,h,{left:0,right:0},o,g));let C=h.tickMarks;C.visible&&(C.offsets=this._getOffsets("tickMarks",a,w,k,h,{left:0,right:0},o,g));const I=this._getOffsets("labels",a,w,k,h,{left:0,right:0},o,g,!o);a.flip=S;let M=[],F;this._elementRenderInfo&&this._elementRenderInfo.length>e&&(F=this._elementRenderInfo[e].valueAxis);for(let n=0,s;n<I.length;n++){if(s=I[n].value,isNaN(I[n].offset)){M.push(void 0);continue}let e=m.formatFunction?m.formatFunction(s):isNaN(s)?s:this._formatNumber(s,b),t={key:s,text:e};F&&F.itemOffsets[s]&&(t.x=F.itemOffsets[s].x,t.y=F.itemOffsets[s].y),t.targetX=I[n].offset,isNaN(t.targetX)||M.push(t)}let D=s&&"top"===a.position||!s&&"right"===a.position||!s&&this.rightToLeft&&"left"!==a.position,T=this._getAnimProps(e),O=T.enabled&&500>M.length?T.duration:0;return!1===this.enableAxisTextAnimation&&(O=0),_.settings=h,_.isMirror=D,_.rect=t,this._renderAxis(!s,D,h,t,r,g,u,!0,{items:M,renderData:_},i,O)}_objectsArraysToArray(e,t){let r=[];if(!Array.isArray(e))return r;for(let n=0;n<e.length;n++)r.push(e[n][t]);return r}_arraysToObjectsArray(e,t){let r=[];if(e.length!==t.length)return r;for(let n=0;n<e.length;n++)for(let i=0;i<e[n].length;i++)r.length<=i&&r.push({}),r[i][t[n]]=e[n][i];return r}_valuesToOffsets(e,t,r,n,i,s,a){let l=[];if(!t||!Array.isArray(e))return l;let o=r.logAxis.base,d=r.logAxis.enabled?"logarithmic":"linear",g=t.flip,u=n,p=0,h=0;i&&!isNaN(i.left)&&(p=i.left),i&&!isNaN(i.right)&&(h=i.right),u=n-p-h,n=u;for(let y=0,m;y<e.length;y++)m=this._smartPlot.scale(e[y],{min:r.min.valueOf(),max:r.max.valueOf(),type:d,base:o},{min:0,max:s?n:u,flip:g},{}),isNaN(m)?l.push(NaN):(!isNaN(a)&&(m+=a),m<=n+p+h+1?l.push(this.renderer._ptrnd(m)):l.push(NaN));return l}_generateIntervalValues(e,t,r,i,n){var s=Math.pow;let a=[],l=e.min,o=e.max;if(e.logAxis&&e.logAxis.enabled&&(l=e.logAxis.minPow,o=e.logAxis.maxPow),void 0===l||null===l||void 0===o||null===o)return a;if(l===o)return e.logAxis&&e.logAxis.enabled?[s(e.logAxis.base,l)]:[l];let d=1;1>r&&(d=1e6,l*=d,o*=d,r*=d);for(let s=l;s<=o;s+=r)a.push(s/d+(n?r/2:0));if(t>r){let e=[],n=Math.round(t/r);for(let t=0;t<a.length;t++)0==t%n&&e.push(a[t]);a=e}if(e.logAxis&&e.logAxis.enabled)for(let t=0;t<a.length;t++)a[t]=s(e.logAxis.base,a[t]);return a}_generateDTOffsets(e,t,r,i,n,s,a,l,o,d,g){a||(a="day");var u=[];if(e>t)return u;if(e===t)return d?u.push({offset:l?r/2:i.left,value:e}):l&&u.push({offset:r/2,value:e}),u;var p=r-i.left-i.right,h=e,y=i.left,m=y;s=Math.max(s,1);var c=s,f=Math.min(1,s);for(1<s&&"millisecond"!==a&&(s=1);this.renderer._ptrnd(m)<=this.renderer._ptrnd(i.left+p+(l?0:i.right));){u.push({offset:m,value:h});var x=new Date(h.valueOf());if("millisecond"===a)x.setMilliseconds(h.getMilliseconds()+s);else if("second"===a)x.setSeconds(h.getSeconds()+s);else if("minute"===a)x.setMinutes(h.getMinutes()+s);else if("hour"===a){var _=x.valueOf();x.setHours(h.getHours()+s),_===x.valueOf()&&x.setHours(h.getHours()+s+1)}else"day"===a?x.setDate(h.getDate()+s):"month"===a?x.setMonth(h.getMonth()+s):"year"===a&&x.setFullYear(h.getFullYear()+s);h=x,m=y+(h.valueOf()-e.valueOf())*f/(t.valueOf()-e.valueOf())*p}if(g)for(let e=0;e<u.length;e++)u[e].offset=r-u[e].offset;if(1<c&&"millisecond"!==a){var b=[];for(let e=0;e<u.length;e+=c)b.push({offset:u[e].offset,value:u[e].value});u=b}if(!l&&!d&&1<u.length){var b=[{offset:0,value:void 0}];for(let e=1;e<u.length;e++)b.push({offset:u[e-1].offset+(u[e].offset-u[e-1].offset)/2,value:void 0});var v=b.length;1<v?b.push({offset:b[v-1].offset+(b[v-1].offset-b[v-2].offset)}):b.push({offset:r,value:void 0}),u=b}if(n>s){var b=[],A=Math.round(n/c);for(let e=0;e<u.length;e++)0==e%A&&b.push({offset:u[e].offset,value:u[e].value});u=b}return u}_hasStackValueReversal(e,t){let r=this.seriesGroups[e],i=-1!==r.type.indexOf("stacked");if(!i)return!1;let n=-1!==r.type.indexOf("waterfall"),s=this._getDataLen(e),a=0,l=!1,o=[];for(let i=0;i<r.series.length;i++)o[i]=this._isSerieVisible(e,i);for(let d=0,i;d<s;d++){i=void 0,n||(l=!1);for(let n=0;n<r.series.length;n++){if(!o[n])continue;const s=this._getDataValueAsNumber(d,r.series[n].dataField,e);if(isNaN(s))continue;if(r.series[n].summary){let t=this._getDataValue(d,r.series[n].summary,e);if(void 0!==t)continue}let g=l?0>s:s<t;if(l=!0,void 0===i&&(i=g),g!==i)return!0;i=g,a+=s}}return!1}_getValueAxis(e){let t=void 0===e||null===e?this.valueAxis:this.seriesGroups[e].valueAxis||this.valueAxis;return t||(t=this.valueAxis={}),t}_buildStats(e){var t=Math.min,r=Math.max,n={seriesGroups:[]};this._stats=n;for(let W=0;W<this.seriesGroups.length;W++){var s=this.seriesGroups[W];n.seriesGroups[W]={};var a=this._getXAxis(W),l=this._getValueAxis(W),o=this._getXAxisStats(W,a,"horizontal"===s.orientation?e.height:e.width);let X=n.seriesGroups[W];X.isValid=!0;var i="horizontal"===s.orientation?e.width:e.height,d=!0===l.logarithmicScale,g=l.logarithmicScaleBase;isNaN(g)&&(g=10);var u=-1!==s.type.indexOf("stacked"),h=u&&-1!==s.type.indexOf("100"),y=-1!==s.type.indexOf("range"),m=-1!==s.type.indexOf("waterfall");m&&!this._moduleWaterfall&&self.error(self.localize("missingReference",{files:"smartchart.waterfall.js"})),h&&(X.psums=[],X.nsums=[]);var c=NaN,f=NaN,x=NaN,_=NaN,b=l?l.baselineValue:NaN;isNaN(b)&&(b=d&&!h?1:0);var v=!1;0!==b&&u&&(v=this._hasStackValueReversal(W,b),v&&(b=0)),u&&m&&(v=this._hasStackValueReversal(W,b));var A=this._getDataLen(W),w=0,S=NaN,k=[];if(m)for(let e=0;e<s.series.length;e++)k.push(NaN);var C=NaN;for(let e=0;e<A&&X.isValid;e++){if(a.rangeSelector&&a.rangeSelector.visible){var I=a.dataField?this._getDataValue(e,a.dataField,W):e;if(I&&o.isDateTime&&(I=this._castAsDate(I,a.dateFormat)),o.useIndeces&&(I=e),I&&(I.valueOf()<o.min.valueOf()||I.valueOf()>o.max.valueOf()))continue}var M=l.minValue,F=l.maxValue;l.baselineValue&&(M=isNaN(M)?b:t(b,M),F=isNaN(F)?b:r(b,F));var D=0,T=0;for(let i=0;s.series&&i<s.series.length;i++)if(this._isSerieVisible(W,i)){var O=NaN,R=NaN,L=NaN;if(-1!==s.type.indexOf("candle")||-1!==s.type.indexOf("ohlc")){var P=["Open","Low","Close","High"];for(var G in P){var V=this._getDataValueAsNumber(e,s.series[i]["dataField"+P[G]],W);isNaN(V)||(L=isNaN(R)?V:t(L,V),R=isNaN(R)?V:r(R,V))}}else if(y){var E=this._getDataValueAsNumber(e,s.series[i].dataFieldFrom,W),B=this._getDataValueAsNumber(e,s.series[i].dataFieldTo,W);R=r(E,B),L=t(E,B)}else{if(O=this._getDataValueAsNumber(e,s.series[i].dataField,W),m){if(this._isSummary(W,e)){var H=this._getDataValue(e,s.series[i].summary,W);if(void 0!==H)continue}u?(!isNaN(C)&&(O+=C),C=O):(isNaN(k[i])?k[i]=O:O+=k[i],k[i]=O)}if(isNaN(O)||d&&0>=O)continue;L=R=O}(isNaN(F)||R>F)&&(!!isNaN(l.maxValue)||R<=l.maxValue)&&(F=R),(isNaN(M)||L<M)&&(!!isNaN(l.minValue)||L>=l.minValue)&&(M=L),isNaN(O)||!u||m||(O>b?D+=O:O<b&&(T+=O))}if(h||(!isNaN(l.maxValue)&&(D=t(l.maxValue,D)),!isNaN(l.minValue)&&(T=r(l.minValue,T))),d&&h)for(let t=0;t<s.series.length;t++){if(!this._isSerieVisible(W,t)){S=.01;continue}var O=this._getDataValueAsNumber(e,s.series[t].dataField,W);if(isNaN(O)||0>=O){S=.01;continue}var j=0===D?0:O/D;(isNaN(S)||j<S)&&(S=j)}var p=D-T;w<p&&(w=p),h&&(X.psums[e]=D,X.nsums[e]=T),(F>f||isNaN(f))&&(f=F),(M<c||isNaN(c))&&(c=M),(D>x||isNaN(x))&&(x=D),(T<_||isNaN(_))&&(_=T)}h&&(x=0===x?0:r(x,-_),_=0===_?0:t(_,-x)),c===f&&(!isNaN(l.minValue)&&isNaN(l.maxValue)?(c=l.minValue,f=d?c*g:c+1):isNaN(l.minValue)&&!isNaN(l.maxValue)&&(f=l.maxValue,c=d?f/g:f-1)),c===f&&(0===c?(c=-1,f=1):0>c?f=0:d?1===c&&(c/=g,f*=g):c=0);var z={gmin:c,gmax:f,gsumP:x,gsumN:_,gbase:b,isLogAxis:d,logBase:g,minPercent:S,gMaxRange:w,isStacked:u,isStacked100:h,isWaterfall:m,hasStackValueReversal:v,valueAxis:l,valueAxisSize:i};z.isStacked&&(0>z.gsumN&&(z.gmin=t(z.gmin,z.gbase+z.gsumN)),0<z.gsumP&&(z.gmax=r(z.gmax,z.gbase+z.gsumP))),X.context=z}this._mergeCommonValueAxisStats();for(let t=0,i;t<n.seriesGroups.length;t++)if(i=n.seriesGroups[t],i.isValid){var W=this._calcOutputGroupStats(i.context);for(let e in W)i[e]=W[e];delete i.context}}_mergeCommonValueAxisStats(){let e={};for(let t=0;t<this.seriesGroups.length;t++){if(!this._isGroupVisible(t))continue;if(this.seriesGroups[t].valueAxis)continue;let i=this._stats.seriesGroups[t].context;e.gbase=i.gbase,(isNaN(e.gmin)||i.gmin<e.gmin)&&(e.gmin=i.gmin),(isNaN(e.gmax)||i.gmax>e.gmax)&&(e.gmax=i.gmax),(isNaN(e.gsumP)||i.gsumP>e.gsumP)&&(e.gsumP=i.gsumP),(isNaN(e.gsumN)||i.gsumN<e.gsumN)&&(e.gsumN=i.gsumN),(isNaN(e.logBase)||i.logBase<e.logBase)&&(e.logBase=i.logBase),(isNaN(e.minPercent)||i.minPercent<e.minPercent)&&(e.minPercent=i.minPercent),0<e.gsumN&&(e.gmin=Math.min(e.gmin,e.gbase+e.gsumN)),0<e.gsumP&&(e.gmax=Math.max(e.gmax,e.gbase+e.gsumP))}for(let t=0;t<this.seriesGroups.length;t++){if(this.seriesGroups[t].valueAxis)continue;let i=this._stats.seriesGroups[t].context;for(let t in e)i[t]=e[t]}}_calcOutputGroupStats(e){var t=Math.pow,i=Math.max;let r=e.gmin,n=e.gmax,s=e.gsumP,a=e.gsumN,l=e.gbase,o=e.isLogAxis,d=e.logBase,g=e.minPercent,u=e.gMaxRange,p=e.isStacked,h=e.isStacked100,y=e.isWaterfall,m=e.hasStackValueReversal,c=e.valueAxis,f=e.valueAxisSize,x=e.valueAxis.unitInterval;x||(x=this._calcInterval(r,n,i(f/80,2))),r===n&&(r=l,n=2*n);let _=NaN,b=0,v=0;if(o){if(h){_=0;let e=1;for(b=v=this._draw.log(100,d);e>g;)e/=d,b--,_++;r=t(d,b)}else p&&!y&&(n=i(n,s)),v=this.renderer._rnd(this._draw.log(n,d),1,!0),n=t(d,v),b=this.renderer._rnd(this._draw.log(r,d),1,!1),r=t(d,b);x=d}r<a&&(a=r),n>s&&(s=n);let A=r,w=n;if(o||0==Math.abs(w-A)%x||(A=this.renderer._rnd(r,x,!1),w=this.renderer._rnd(n,x,!0)),h&&100<w&&(w=100),h&&!o&&(w=0<w?100:0,A=0>A?-100:0,x=c.unitInterval,(isNaN(x)||0>=x||100<=x)&&(x=10),0!=100%x))for(;1<=x&&0!=100%x;x--);if(isNaN(w)||isNaN(A)||isNaN(x))return{};if(isNaN(_)&&(_=parseInt(((w-A)/(0===x?1:x)).toFixed())),o&&!h&&(_=v-b,u=t(d,_)),1>_)return{};let S={min:A,max:w,logarithmic:o,logBase:d,base:o?A:l,minPow:b,maxPow:v,sumP:s,sumN:a,mu:x,maxRange:u,intervals:_,hasStackValueReversal:m};return S}_getDataLen(e){let t=this.dataSource;return void 0!==e&&null!==e&&-1!==e&&this.seriesGroups[e].dataSource&&(t=this.seriesGroups[e].dataSource),t?t.length:0}_getDataValue(e,t,i){let r=this.dataSource;return void 0!==i&&null!==i&&-1!==i&&(r=this.seriesGroups[i].dataSource||r),!r||0>e||e>r.length-1?void 0:"function"==typeof t?t(e,r):t&&""!==t?r[e][t]:r[e]}_getDataValueAsNumber(e,t,i){let r=this._getDataValue(e,t,i);return this._isDate(r)?r.valueOf():("number"!=typeof r&&(r=parseFloat(r)),"number"!=typeof r&&(r=void 0),r)}_isPieGroup(e){let t=this.seriesGroups[e];return!!(t&&t.type)&&(-1!==t.type.indexOf("pie")||-1!==t.type.indexOf("donut"))}_renderPieSeries(e,t){let r=this._getDataLen(e),i=this.seriesGroups[e],n=this._calcGroupOffsets(e,t).offsets;for(let a=0,l;a<i.series.length;a++){if(l=i.series[a],l.customDraw)continue;let s=this._getSerieSettings(e,a),o=this._getAnimProps(e,a),d=o.enabled&&5e3>r&&!this._isToggleRefresh&&o.duration;this._isTouchDevice&&this.renderer instanceof Smart.Utilities.HTML5Renderer&&(d=0);let g=this._get([l.minAngle,l.startAngle]);(isNaN(g)||0>g||360<g)&&(g=0);let u=this._get([l.maxAngle,l.endAngle]);(isNaN(u)||0>u||360<u)&&(u=360);let p={rect:t,minAngle:g,maxAngle:u,groupIndex:e,serieIndex:a,settings:s,items:[]};for(let t=0,i;t<r;t++){if(i=n[a][t],!i.visible)continue;let r=i.fromAngle,s=i.toAngle,l=this.renderer.pieslice(i.x,i.y,i.innerRadius,i.outerRadius,r,0===d?s:r,i.centerOffset);this._setRenderInfo(e,a,t,{element:l});let o={displayValue:i.displayValue,itemIndex:t,visible:i.visible,x:i.x,y:i.y,innerRadius:i.innerRadius,outerRadius:i.outerRadius,fromAngle:r,toAngle:s,centerOffset:i.centerOffset};p.items.push(o)}this._animatePieSlices(p,0);let h=this;this._enqueueAnimation("series",void 0,void 0,d,function(e,t,i){h._animatePieSlices(t,i)},p)}}_sliceSortFunction(e,t){return e.fromAngle-t.fromAngle}_animatePieSlices(e,t){var r;this._elementRenderInfo&&this._elementRenderInfo.length>e.groupIndex&&this._elementRenderInfo[e.groupIndex].series&&this._elementRenderInfo[e.groupIndex].series.length>e.serieIndex&&(r=this._elementRenderInfo[e.groupIndex].series[e.serieIndex]);var n=this._getLabelsSettings(e.groupIndex,e.serieIndex,NaN),s=n.visible,a=[];for(let n=0;n<e.items.length;n++){const s=e.items[n];if(!s.visible)continue;let d=s.fromAngle;var l=s.fromAngle+t*(s.toAngle-s.fromAngle);if(r&&r[s.displayValue]){var i=r[s.displayValue].fromAngle,o=r[s.displayValue].toAngle;d=i+(d-i)*t,l=o+(l-o)*t}a.push({index:n,from:d,to:l})}r&&a.sort(this._sliceSortFunction);var d=NaN;for(let o=0;o<a.length;o++){const i=e.items[a[o].index];var g=this._getRenderInfo(e.groupIndex,e.serieIndex,i.itemIndex);let y=a[o].from;var l=a[o].to;r&&(!isNaN(d)&&y>d&&(y=d),d=l,o==a.length-1&&l!==a[0].from&&(l=e.maxAngle+a[0].from));var u=this.renderer.pieSlicePath(i.x,i.y,i.innerRadius,i.outerRadius,y,l,i.centerOffset);this.renderer.attr(g.element,{d:u});var p=this._getColors(e.groupIndex,e.serieIndex,i.itemIndex,"radialGradient",i.outerRadius),h=e.settings;g.colors=p,g.settings=h,this.renderer.attr(g.element,{fill:p.fillColor,stroke:p.lineColor,"stroke-width":h.stroke,"fill-opacity":h.opacity,"stroke-opacity":h.opacity,"stroke-dasharray":"none"}),s&&this._showPieLabel(e.groupIndex,e.serieIndex,i.itemIndex,n,void 0,g.colors.lineColor),1===t&&this._installHandlers(g.element,"pieslice",e.groupIndex,e.serieIndex,i.itemIndex)}}_showPieLabel(e,t,i,r,n){var a=Math.pow;let l=this._renderData[e].offsets[t][i];if(l.elementInfo.labelElement&&this.renderer.removeElement(l.elementInfo.labelElement),r||(r=this._getLabelsSettings(e,t,NaN)),!r.visible)return;let o=l.fromAngle,d=l.toAngle,u=Math.abs(o-d);360<u&&(o=0,d=360);let p=u/2+o;p%=360;let h=2*(p*Math.PI)/360,y;!0===r.autoRotate&&(y=90>p||270<p?360-p:180-p);let m=r.linesEnabled,c=this._showLabel(e,t,i,{x:0,y:0,width:0,height:0},"center","center",!0,!1,!1,y),f=r.radius||l.outerRadius+Math.max(c.width,c.height);this._isPercent(f)&&(f=parseFloat(f)/100*Math.min(this._plotRect.width,this._plotRect.height)/2),f+=l.centerOffset,isNaN(n)&&(n=0),f+=n;let x=this.seriesGroups[e],g=x.series[t],s=this._draw.getNum([g.offsetX,x.offsetX,this._plotRect.width/2]),_=this._draw.getNum([g.offsetY,x.offsetY,this._plotRect.height/2]),b=this._plotRect.x+s,v=this._plotRect.y+_,A=this._adjustTextBoxPosition(b,v,c,f,p,l.outerRadius>f,!1!==r.linesAngles,!0===r.autoRotate);const w={},S=A.x<b?0:c.width/2,k=Math.sqrt(a(A.x-b,2)+a(A.y-v,2))+S<l.outerRadius?arguments[5]:void 0;if(l.elementInfo.labelElement=this._showLabel(e,t,i,{x:A.x,y:A.y,width:c.width,height:c.height},"left","top",!1,!1,!1,y,w,k),f>l.outerRadius+n+5&&!1!==m){let e={lineColor:l.elementInfo.colors.lineColor,stroke:l.elementInfo.settings.stroke,opacity:l.elementInfo.settings.opacity,dashStyle:l.elementInfo.settings.dashStyle};l.elementInfo.labelArrowPath=this._updateLebelArrowPath(l.elementInfo.labelArrowPath,b,v,f,l.outerRadius+n,h,!1!==r.linesAngles,e,w)}}_updateLebelArrowPath(e,t,i,r,n,s,a,l,o){var d=Math.sin,g=Math.cos,u=Math.abs;const p=this.renderer;let h=p._ptrnd(t+(r-0)*g(s)),y=p._ptrnd(i-(r-0)*d(s)),m=p._ptrnd(t+(n+2)*g(s)),c=p._ptrnd(i-(n+2)*d(s)),f=[];f.push({x:o.x+o.width/2,y:o.y}),f.push({x:o.x+o.width/2,y:o.y+o.height}),f.push({x:o.x,y:o.y+o.height/2}),f.push({x:o.x+o.width,y:o.y+o.height/2}),a||(f.push({x:o.x,y:o.y}),f.push({x:o.x+o.width,y:o.y}),f.push({x:o.x+o.width,y:o.y+o.height}),f.push({x:o.x,y:o.y+o.height})),f=f.sort(function(e,r){return p._ptdist(e.x,e.y,t,i)-p._ptdist(r.x,r.y,t,i)}),f=f.sort(function(e,r){return u(e.x-t)+u(e.y-i)-(u(r.x-t)+u(r.y-i))});for(let d=0;d<f.length;d++)f[d].x=p._ptrnd(f[d].x),f[d].y=p._ptrnd(f[d].y);h=f[0].x,y=f[0].y;let x="M "+h+","+y+" L"+m+","+c;return a&&(x="M "+h+","+y+" L"+m+","+y+" L"+m+","+c),e?p.attr(e,{d:x}):e=p.path(x,{}),p.attr(e,{fill:"none",stroke:l.lineColor,"stroke-width":l.stroke,"stroke-opacity":l.opacity,"stroke-dasharray":"none"}),e}_adjustTextBoxPosition(e,t,i,r,n,s,a,l){var o=Math.sin,d=Math.cos,g=Math.PI;let u=2*(n*g)/360,p=this.renderer._ptrnd(e+r*d(u)),h=this.renderer._ptrnd(t-r*o(u));if(l){let n=i.width,s=i.height,l=Math.atan(s/n)%(2*g),p=u%(2*g),a=0;p<=l?a=n/2*d(u):p>=l&&p<g-l?a=s/2*o(u):p>=g-l&&p<g+l?a=n/2*d(u):p>=g+l&&p<2*g-l?a=s/2*o(u):p>=2*g-l&&p<2*g&&(a=n/2*d(u)),r+=Math.abs(a)+3;let h=this.renderer._ptrnd(e+r*d(u)),m=this.renderer._ptrnd(t-r*o(u));return h-=i.width/2,m-=i.height/2,{x:h,y:m}}return s?(p-=i.width/2,h-=i.height/2):a?90<=n&&270>n?(h-=i.height/2,p-=i.width):h-=i.height/2:0<=n&&45>n||315<=n&&360>n?h-=i.height/2:45<=n&&135>n?(h-=i.height,p-=i.width/2):135<=n&&225>n?(h-=i.height/2,p-=i.width):225<=n&&315>n&&(p-=i.width/2),{x:p,y:h}}_isColumnType(e){return-1!==e.indexOf("column")||-1!==e.indexOf("waterfall")}_getColumnGroupsCount(e){let t=0;e=e||"vertical";let r=this.seriesGroups;for(let n=0,i;n<r.length;n++)i=r[n].orientation||"vertical",this._isColumnType(r[n].type)&&i===e&&t++;return this.columnSeriesOverlap&&(t=1),t}_getColumnGroupIndex(e){let t=0,r=this.seriesGroups[e].orientation||"vertical";for(let n=0;n<e;n++){let e=this.seriesGroups[n],i=e.orientation||"vertical";this._isColumnType(e.type)&&i===r&&t++}return t}_renderAxisBands(e,t,r){var i=Math.sin,n=Math.cos,s=Math.PI,a=Math.min,l=Math.round,o=r?this._getXAxis(e):this._getValueAxis(e),d=this.seriesGroups[e],g=r?void 0:d.bands;if(!g){for(let t=0;t<e;t++){var u=r?this._getXAxis(t):this._getValueAxis(t);if(u===o)return}g=o.bands}if(Array.isArray(g)){var p=t,h="horizontal"===d.orientation;h&&(p={x:t.y,y:t.x,width:t.height,height:t.width}),this._calcGroupOffsets(e,p);for(let o=0;o<g.length;o++){var y=g[o],m=y.minValue,c=y.maxValue,f=r?this.getXAxisDataPointOffset(m,e):this.getValueAxisDataPointOffset(m,e),x=r?this.getXAxisDataPointOffset(c,e):this.getValueAxisDataPointOffset(c,e);if(!(isNaN(f)||isNaN(x))){var _=Math.abs(f-x),b;if(d.polar||d.spider){var v=this._renderData[e],A=v.polarCoords;if(!r){var w=this._toPolarCoord(A,t,t.x,v.baseOffset),S=this._toPolarCoord(A,t,t.x,f),C=this._toPolarCoord(A,t,t.x,x),I=this.renderer._ptdist(w.x,w.y,S.x,S.y),M=this.renderer._ptdist(w.x,w.y,C.x,C.y),F=l(360*-A.startAngle/(2*s)),D=l(360*-A.endAngle/(2*s));if(F>D){const e=F;F=D,D=e}if(d.spider){var T=v.xAxis.offsetAngles;let e="";var O=[M,I],R=T;for(var L in A.isClosedCircle&&(R=T.slice(0),R.push(R[0])),O){for(let t=0;t<R.length;t++){var k=0===L?t:T.length-t-1,P=A.x+O[L]*n(R[k]),G=A.y+O[L]*i(R[k]);e+=""==e?"M ":" L",e+=this.renderer._ptrnd(P)+","+this.renderer._ptrnd(G)}if(0===L){var P=A.x+O[1]*n(R[k]),G=A.y+O[1]*i(R[k]);e+=" L"+this.renderer._ptrnd(P)+","+this.renderer._ptrnd(G)}}e+=" Z",b=this.renderer.path(e)}else b=this.renderer.pieslice(A.x,A.y,I,M,F,D)}else if(d.spider){const t=this.getPolarDataPointOffset(m,this._stats.seriesGroups[e].max,e),i=this.getPolarDataPointOffset(c,this._stats.seriesGroups[e].max,e);let r="M "+A.x+","+A.y;r+=" L "+t.x+","+t.y,r+=" L "+i.x+","+i.y,b=this.renderer.path(r)}else{var V={},E={x:a(f,x),y:t.y,width:_,height:t.height};this._columnAsPieSlice(V,t,A,E),b=V.element}}else{var B={x:a(f,x),y:p.y,width:_,height:p.height};if(r||(B={x:p.x,y:a(f,x),width:p.width,height:_}),h){let e=B.x;B.x=B.y,B.y=e,e=B.width,B.width=B.height,B.height=e}b=0===_||1===_?this.renderer.line(this.renderer._ptrnd(B.x),this.renderer._ptrnd(B.y),this.renderer._ptrnd(B.x+(h?0:B.width)),this.renderer._ptrnd(B.y+(h?B.height:0))):this.renderer.rect(B.x,B.y,B.width,B.height)}var H=y.color||this._getThemeColor("band"),j=y.lineColor||H,z=y.lineWidth;isNaN(z)&&(z=1);var W=y.opacity;(isNaN(W)||0>W||1<W)&&(W=1),this.renderer.attr(b,{fill:H,"fill-opacity":W,stroke:j,"stroke-opacity":W,"stroke-width":z,"stroke-dasharray":y.dashStyle})}}}}_getColumnGroupWidth(e,t,i){var r=Math.max;let n=this.seriesGroups[e],s=-1!==n.type.indexOf("stacked"),a=this._getColumnGroupsCount(n.orientation);(isNaN(a)||0===a)&&(a=1);let l=1<=t.rangeLength?t.itemWidth:.9*i,o=n.columnsMinWidth;isNaN(o)&&(o=1),isNaN(n.columnsMaxWidth)||(o=Math.min(n.columnsMaxWidth,o)),o>l&&0<t.length&&(l=r(l,.9*i/t.length));let d=o;if(!s){let e=n.seriesGapPercent;(isNaN(e)||0>e)&&(e=10),e/=100;let t=o;t*=1+e,d+=n.series.length*t}let g=r(l/a,d);return{requiredWidth:d,availableWidth:l,targetWidth:g}}_getColumnSerieWidthAndOffset(e,t){var i=Math.round,r=Math.max;let n=this.seriesGroups[e],s="horizontal"===n.orientation,a=this._plotRect;s&&(a={x:a.y,y:a.x,width:a.height,height:a.width});let l=this._calcGroupOffsets(e,a);if(!l||0===l.xoffsets.length)return;let o=this._getColumnGroupsCount(n.orientation);("candlestick"===n.type||"ohlc"===n.type)&&(o=1);let d=this._getColumnGroupIndex(e),g=this._getColumnGroupWidth(e,l.xoffsets,s?a.height:a.width),u=0,p=g.targetWidth;(!0===this.columnSeriesOverlap||i(p)>i(g.availableWidth/o))&&(o=1,d=0),u-=p*o/2,u+=p*d;let h=n.columnsGapPercent;0>=h&&(h=0),(isNaN(h)||100<=h)&&(h=25),h/=100;let y=p*h;y+g.requiredWidth>g.targetWidth&&(y=r(0,g.targetWidth-g.requiredWidth)),i(p)>i(g.availableWidth)&&(y=0),p-=y,u+=y/2;let m=n.seriesGapPercent;(isNaN(m)||0>m)&&(m=10);let c=-1!==n.type.indexOf("stacked"),f=p;c||(f/=n.series.length);let x=this._get([n.seriesGap,p*m/100/(n.series.length-1)]);(!0===n.polar||!0===n.spider||c||1>=n.series.length)&&(x=0);let _=x*(n.series.length-1);1<n.series.length&&_>p-1*n.series.length&&(_=p-1*n.series.length,x=_/r(1,n.series.length-1));let b=f-_/n.series.length,v=0,A=n.columnsMaxWidth;!isNaN(A)&&b>A&&(v=b-A,b=A);let w=0;if(!c){let e=(p-b*n.series.length-_)/2,i=r(0,t);w=e+b*t+i*x}else w=v/2;return{width:b,offset:u+w}}_renderColumnSeries(e,t){let i=this.seriesGroups[e];if(!i.series||0===i.series.length)return;let r="horizontal"===i.orientation,n=t;r&&(n={x:t.y,y:t.x,width:t.height,height:t.width});let a=this._calcGroupOffsets(e,n);if(!a||0===a.xoffsets.length)return;let l;(!0===i.polar||!0===i.spider)&&(l=this._getPolarAxisCoords(e,n));let o={groupIndex:e,rect:t,vertical:!r,seriesCtx:[],renderData:a,polarAxisCoords:l,columnGroupWidth:this._getColumnGroupWidth(e,a.xoffsets,r?n.height:n.width)},s=this._getGroupGradientType(e),d;for(let r=0,n;r<i.series.length;r++){if(n=i.series[r],n.customDraw)continue;let t=this._getAnimProps(e,r);d=t.enabled&&!this._isToggleRefresh&&100>a.xoffsets.length?t.duration:0;let s=this._getColumnSerieWidthAndOffset(e,r),g=this._isSerieVisible(e,r),u=this._getSerieSettings(e,r),p=this._getColors(e,r,NaN,this._getGroupGradientType(e),4),h=[];if("function"==typeof n.colorFunction&&!l)for(let t=a.xoffsets.first;t<=a.xoffsets.last;t++)h.push(this._getColors(e,r,t,s,4));let y={seriesIndex:r,serieColors:p,itemsColors:h,settings:u,columnWidth:s.width,xAdjust:s.offset,isVisible:g};o.seriesCtx.push(y)}this._animColumns(o,0===d?1:0);let g=this;this._enqueueAnimation("series",void 0,void 0,d,function(e,t,i){g._animColumns(t,i)},o)}_getPercent(e,t,i,r){return isNaN(e)&&(e=t),isNaN(i)||isNaN(e)||!(e<i)||(e=i),isNaN(r)||isNaN(e)||!(e>r)||(e=r),isNaN(e)?NaN:e}_getColumnVOffsets(e,t,r,i,n,s){var a=Math.abs,l=Math.min,o=Math.max,d=this.seriesGroups[t],g=this._getPercent(d.columnsTopWidthPercent,100,0,100),u=this._getPercent(d.columnsBottomWidthPercent,100,0,100);0===g&&0===u&&(u=100);var p=this._getPercent(d.columnsNeckHeightPercent,NaN,0,100)/100,h=this._getPercent(d.columnsNeckWidthPercent,100,0,100)/100,y=[],m=NaN;for(let a=0;a<r.length;a++){var c=r[a],f=c.seriesIndex,x=e.offsets[f][i].from,_=e.offsets[f][i].to,b=e.xoffsets.data[i],v=c.isVisible,A;v||(_=x);var w=this._elementRenderInfo;if(v&&w&&w.length>t&&w[t].series.length>f){var S=e.xoffsets.xvalues[i];A=w[t].series[f][S],!A||isNaN(A.from)||isNaN(A.to)||(x=A.from+(x-A.from)*s,_=A.to+(_-A.to)*s,b=A.xoffset+(b-A.xoffset)*s)}A||(_=x+(_-x)*(n?1:s)),isNaN(x)&&(x=isNaN(m)?e.baseOffset:m),m=!isNaN(_)&&n?_:x,isNaN(_)&&(_=x);var k={from:x,to:_,xOffset:b};(100!==g||100!==u)&&(k.funnel=!0,k.toWidthPercent=g,k.fromWidthPercent=u),y.push(k)}if(n&&1<y.length&&!(this._elementRenderInfo&&this._elementRenderInfo.length>t)){var C=0,I=0,M=-Infinity,F=1/0,D=1/0,T=-Infinity;for(let e=0;e<y.length;e++){var c=r[e];c.isVisible&&(y[e].to>=y[e].from?(I+=y[e].to-y[e].from,D=l(D,y[e].from),T=o(T,y[e].to)):(C+=y[e].from-y[e].to,M=o(M,y[e].from),F=l(F,y[e].to)))}var O=C,R=I;C*=s,I*=s;var L=0,P=0;for(let e=0;e<y.length;e++)if(y[e].to>=y[e].from){let t=y[e].to-y[e].from;t+P>I&&(t=o(0,I-P),y[e].to=y[e].from+t),(100!==g||100!==u)&&(y[e].funnel=!0,y[e].fromWidthPercent=!isNaN(p)&&R*p>=P?100*h:a(y[e].from-D)/R*(g-u)+u,y[e].toWidthPercent=!isNaN(p)&&R*p>=0+(P+t)?100*h:a(y[e].to-D)/R*(g-u)+u),P+=t}else{let t=y[e].from-y[e].to;t+L>C&&(t=o(0,C-L),y[e].to=y[e].from-t),(100!==g||100!==u)&&(y[e].funnel=!0,y[e].fromWidthPercent=!isNaN(p)&&O*p>=L?100*h:a(y[e].from-M)/O*(g-u)+u,y[e].toWidthPercent=!isNaN(p)&&O*p>=0+(L+t)?100*h:a(y[e].to-M)/O*(g-u)+u),L+=t}}return y}_columnAsPieSlice(e,t,i,r){var n=Math.PI;let s=this._toPolarCoord(i,t,r.x,r.y),a=this._toPolarCoord(i,t,r.x,r.y+r.height),l=this.renderer._ptdist(i.x,i.y,a.x,a.y),o=this.renderer._ptdist(i.x,i.y,s.x,s.y),d=t.width,g=180*Math.abs(i.startAngle-i.endAngle)/n,u=-((r.x-t.x)*g)/d,p=-((r.x+r.width-t.x)*g)/d,h=i.startAngle;if(h=360*h/(2*n),u-=h,p-=h,e)if(void 0!==e.element&&null!==e.element){let t=this.renderer.pieSlicePath(i.x,i.y,l,o,p,u,0);t+=" Z",this.renderer.attr(e.element,{d:t})}else e.element=this.renderer.pieslice(i.x,i.y,l,o,p,u,0);return{fromAngle:p,toAngle:u,innerRadius:l,outerRadius:o}}_setRenderInfo(e,t,i,r){this._renderData[e].offsets[t][i].elementInfo=r}_getRenderInfo(e,t,i){return this._renderData[e].offsets[t][i].elementInfo||{}}_animColumns(e,t){var r=Math.abs,n=this,s=e.groupIndex,a=this.seriesGroups[s],l=e.renderData,o=-1!==a.type.indexOf("waterfall"),i=this._getXAxis(s),d=-1!==a.type.indexOf("stacked"),g=e.polarAxisCoords,u=-1;for(let i=0;i<a.series.length;i++)if(this._isSerieVisible(s,i)){u=i;break}var p=NaN,h=NaN;for(let i=0;i<e.seriesCtx.length;i++){var y=e.seriesCtx[i];(isNaN(p)||p>y.xAdjust)&&(p=y.xAdjust),(isNaN(h)||h<y.xAdjust+y.columnWidth)&&(h=y.xAdjust+y.columnWidth)}var m=r(h-p),c=this._get([a.columnsGapPercent,25])/100;(0>isNaN(c)||1<=c)&&(c=.25);var f=c*m,_=e.renderData.xoffsets,b=-1,v={},A=!0===a.skipOverlappingPoints;for(let p=_.first;p<=_.last;p++){var w=_.data[p];if(!isNaN(w)){if(-1!==b&&r(w-b)<m-1+f&&A)continue;else b=w;var S=this._getColumnVOffsets(l,s,e.seriesCtx,p,d,t),k=!1;if(o)for(let e=0;e<a.series.length;e++)a.series[e].summary&&_.xvalues[p][a.series[e].summary]&&(k=!0);for(let h=0;h<e.seriesCtx.length;h++){var y=e.seriesCtx[h],C=y.seriesIndex,I=a.series[C],M=S[h].from,F=S[h].to,D=S[h].xOffset,T=(e.vertical?e.rect.x:e.rect.y)+y.xAdjust,O=y.settings;let m=0===y.itemsColors.length?y.serieColors:y.itemsColors[p-l.xoffsets.first];var R=this._isSerieVisible(s,C);if(R){var w=this.renderer._ptrnd(T+D),L={x:w,width:y.columnWidth};S[h].funnel&&(L.fromWidthPercent=S[h].fromWidthPercent,L.toWidthPercent=S[h].toWidthPercent);var P=!0;e.vertical?(L.y=M,L.height=F-M,0>L.height&&(L.y+=L.height,L.height=-L.height,P=!1)):(L.x=M<F?M:F,L.width=r(M-F),P=0>M-F,L.y=w,L.height=y.columnWidth);var G=M-F;if(!isNaN(G)){G=r(G);var V=void 0,E=n._getRenderInfo(s,C,p),B=E.element,H=E.labelElement,j=void 0===B||null===B;if(H&&(n.renderer.removeElement(H),H=void 0),!!g){var z={element:B};V=this._columnAsPieSlice(z,e.rect,g,L),B=z.element,m=this._getColors(s,C,void 0,"radialGradient",V.outerRadius)}else if(S[h].funnel){var W=this._getTrapezoidPath(Object.assign({},L),e.vertical,P);j?B=this.renderer.path(W,{}):this.renderer.attr(B,{d:W})}else j?B=this.renderer.rect(L.x,L.y,e.vertical?L.width:0,e.vertical?0:L.height):!0===e.vertical?this.renderer.attr(B,{x:L.x,y:L.y,height:G}):this.renderer.attr(B,{x:L.x,y:L.y,width:G});if(1>G&&(1!==t||g)?this.renderer.attr(B,{display:"none"}):this.renderer.attr(B,{display:"block"}),j&&this.renderer.attr(B,{fill:m.fillColor,"fill-opacity":O.opacity,"stroke-opacity":O.opacity,stroke:m.lineColor,"stroke-width":O.stroke,"stroke-dasharray":O.dashStyle}),H&&this.renderer.removeElement(H),!R||0===G&&1>t){E={element:B,labelElement:H},n._setRenderInfo(s,C,p,E);continue}if(o&&!1!==this._get([I.showWaterfallLines,a.showWaterfallLines])){if(!d||d&&h===u){var X=d?-1:h;if(1===t&&!isNaN(l.offsets[h][p].from)&&!isNaN(l.offsets[h][p].to)){var N=v[X];if(void 0!==N&&null!==N){var U={x:N.x,y:this.renderer._ptrnd(N.y)},Y={x:w,y:U.y},Z=a.columnsTopWidthPercent/100;isNaN(Z)?Z=1:(1<Z||0>Z)&&(Z=1);var q=a.columnsBottomWidthPercent/100;isNaN(q)?q=1:(1<q||0>q)&&(q=1);var J=e.vertical?L.width:L.height;if(U.x=U.x-J/2+J/2*Z,k){let e=J*Z/2;Y.x=Y.x+J/2-(i.flip?-e:e)}else{let e=J*q/2;Y.x=Y.x+J/2-(i.flip?-e:e)}e.vertical||(this._swapXY([U]),this._swapXY([Y])),this.renderer.line(U.x,U.y,Y.x,Y.y,{stroke:N.color,"stroke-width":O.stroke,"stroke-opacity":O.opacity,"fill-opacity":O.opacity,"stroke-dasharray":O.dashStyle})}}}1===t&&0!==G&&(v[d?-1:h]={y:F,x:e.vertical?L.x+L.width:L.y+L.height,color:m.lineColor})}if(g){var J=this._showLabel(s,C,p,L,void 0,void 0,!0),K=V.outerRadius+10;const e=this._adjustTextBoxPosition(g.x,g.y,J,K,(V.fromAngle+V.toAngle)/2,!0,!1,!1);H=this._showLabel(s,C,p,{x:e.x,y:e.y},void 0,void 0,!1,!1,!1)}else H=this._showLabel(s,C,p,L,void 0,void 0,!1,!1,P);E={element:B,labelElement:H},n._setRenderInfo(s,C,p,E),1===t&&this._installHandlers(B,"column",s,C,p)}}}}}}_getTrapezoidPath(e,t,i){let r="",n=e.fromWidthPercent/100,s=e.toWidthPercent/100;if(!t){let t=e.width;e.width=e.height,e.height=t,t=e.x,e.x=e.y,e.y=t}let a=e.x+e.width/2,l=[{x:a-e.width*(i?s:n)/2,y:e.y+e.height},{x:a-e.width*(i?n:s)/2,y:e.y},{x:a+e.width*(i?n:s)/2,y:e.y},{x:a+e.width*(i?s:n)/2,y:e.y+e.height}];t||this._swapXY(l),r+="M "+this.renderer._ptrnd(l[0].x)+","+this.renderer._ptrnd(l[0].y);for(let n=1;n<l.length;n++)r+=" L "+this.renderer._ptrnd(l[n].x)+","+this.renderer._ptrnd(l[n].y);return r+=" Z",r}_swapXY(e){for(let t=0,i;t<e.length;t++)i=e[t].x,e[t].x=e[t].y,e[t].y=i}_renderCandleStickSeries(e,t,i){let r=this,n=r.seriesGroups[e];if(!n.series||0===n.series.length)return;let a="horizontal"===n.orientation,s=t;a&&(s={x:t.y,y:t.x,width:t.height,height:t.width});let l=r._calcGroupOffsets(e,s);if(!l||0===l.xoffsets.length)return;let o;(n.polar||n.spider)&&(o=r._getPolarAxisCoords(e,s));let d=r._getGroupGradientType(e),g=[];for(let s=0;s<n.series.length;s++)g[s]=r._getColumnSerieWidthAndOffset(e,s);for(let u=0;u<n.series.length;u++){if(!this._isSerieVisible(e,u))continue;let p=r._getSerieSettings(e,u),h=n.series[u];if(h.customDraw)continue;let s="function"==typeof h.colorFunction?void 0:r._getColors(e,u,NaN,d),y={rect:t,inverse:a,groupIndex:e,seriesIndex:u,symbolType:h.symbolType,symbolSize:h.symbolSize,"fill-opacity":p.opacity,"stroke-opacity":p.opacity,"stroke-width":p.stroke,"stroke-dasharray":p.dashStyle,gradientType:d,colors:s,renderData:l,polarAxisCoords:o,columnsInfo:g,isOHLC:i,items:[],self:r},m=r._getAnimProps(e,u),c=m.enabled&&!r._isToggleRefresh&&5e3>l.xoffsets.length?m.duration:0;r._animCandleStick(y,0),r._enqueueAnimation("series",void 0,void 0,c,function(e,t,i){r._animCandleStick(t,i)},y)}}_animCandleStick(e,t){var r=Math.abs,i=Math.min,n=["Open","Low","Close","High"],s=e.columnsInfo[e.seriesIndex].width,a=e.self.seriesGroups[e.groupIndex],l=e.renderData.xoffsets,o=-1,d=r(l.data[l.last]-l.data[l.first]);d*=t;var g=NaN,u=NaN;for(let i=0;i<e.columnsInfo.length;i++){var p=e.columnsInfo[i];(isNaN(g)||g>p.offset)&&(g=p.offset),(isNaN(u)||u<p.offset+p.width)&&(u=p.offset+p.width)}var h=r(u-g),m=!1!==a.skipOverlappingPoints;for(let g=l.first;g<=l.last;g++){var c=l.data[g];if(!isNaN(c)&&!(-1!==o&&r(c-o)<h&&m)){var f=r(l.data[g]-l.data[l.first]);if(f>d)break;o=c;var _=e.items[g]=e.items[g]||{};for(let t in n){var b=e.self._getDataValueAsNumber(g,a.series[e.seriesIndex]["dataField"+n[t]],e.groupIndex);if(isNaN(b))break;var v=e.renderData.offsets[e.seriesIndex][g][n[t]];if(isNaN(v))break;_[n[t]]=v}if(c+=e.inverse?e.rect.y:e.rect.x,e.polarAxisCoords){var A=this._toPolarCoord(e.polarAxisCoords,this._plotRect,c,v);c=A.x,v=A.y}for(var w in c=this.renderer._ptrnd(c),n)_[w]=this.renderer._ptrnd(_[w]);var S=e.colors;if(S||(S=e.self._getColors(e.groupIndex,e.seriesIndex,g,e.gradientType)),!e.isOHLC){var k=_.lineElement;k||(k=e.inverse?this.renderer.line(_.Low,c,_.High,c):this.renderer.line(c,_.Low,c,_.High),this.renderer.attr(k,{fill:S.fillColor,"fill-opacity":e["fill-opacity"],"stroke-opacity":e["fill-opacity"],stroke:S.lineColor,"stroke-width":e["stroke-width"],"stroke-dasharray":e["stroke-dasharray"]}),_.lineElement=k);var C=_.stickElement;if(c-=s/2,!C){var I=S.fillColor;_.Close<=_.Open&&S.fillColorAlt&&(I=S.fillColorAlt),C=e.inverse?this.renderer.rect(i(_.Open,_.Close),c,r(_.Close-_.Open),s):this.renderer.rect(c,i(_.Open,_.Close),s,r(_.Close-_.Open)),this.renderer.attr(C,{fill:I,"fill-opacity":e["fill-opacity"],"stroke-opacity":e["fill-opacity"],stroke:S.lineColor,"stroke-width":e["stroke-width"],"stroke-dasharray":e["stroke-dasharray"]}),_.stickElement=C}1===t&&this._installHandlers(C,"column",e.groupIndex,e.seriesIndex,g)}else{var M="M"+c+","+_.Low+" L"+c+","+_.High+" M"+(c-s/2)+","+_.Open+" L"+c+","+_.Open+" M"+(c+s/2)+","+_.Close+" L"+c+","+_.Close;e.inverse&&(M="M"+_.Low+","+c+" L"+_.High+","+c+" M"+_.Open+","+(c-s/2)+" L"+_.Open+","+c+" M"+_.Close+","+c+" L"+_.Close+","+(c+s/2));var k=_.lineElement;k||(k=this.renderer.path(M,{}),this.renderer.attr(k,{fill:S.fillColor,"fill-opacity":e["fill-opacity"],"stroke-opacity":e["fill-opacity"],stroke:S.lineColor,"stroke-width":e["stroke-width"],"stroke-dasharray":e["stroke-dasharray"]}),_.lineElement=k),1===t&&this._installHandlers(k,"column",e.groupIndex,e.seriesIndex,g)}}}}_renderScatterSeries(e,t,n){var a=Math.max,i=this.seriesGroups[e];if(i.series&&0!==i.series.length){var l=-1!==i.type.indexOf("bubble"),o="horizontal"===i.orientation,d=t;o&&(d={x:t.y,y:t.x,width:t.height,height:t.width});var g=this._calcGroupOffsets(e,d);if(g&&0!==g.xoffsets.length){var u=d.width,p;(i.polar||i.spider)&&(p=this._getPolarAxisCoords(e,d),u=2*p.r);var h=this._getGroupGradientType(e);n||(n="to");for(let r=0;r<i.series.length;r++){var m=this._getSerieSettings(e,r),c=i.series[r];if(!c.customDraw){var s=c.dataField,f="function"==typeof c.colorFunction,_=this._getColors(e,r,NaN,h),b=NaN,v=NaN;if(l)for(let t=g.xoffsets.first;t<=g.xoffsets.last;t++){var A=this._getDataValueAsNumber(t,c.radiusDataField||c.sizeDataField,e);"number"!=typeof A&&this.error(this.localize("invalidRadiusDataField",{index:t})),isNaN(A)||((isNaN(b)||A<b)&&(b=A),(isNaN(v)||A>v)&&(v=A))}var w=c.minRadius||c.minSymbolSize;isNaN(w)&&(w=u/50);var S=c.maxRadius||c.maxSymbolSize;isNaN(S)&&(S=u/25),w>S&&(S=w);var k=c.radius;k=isNaN(k)&&!isNaN(c.symbolSize)?"circle"===c.symbolType?c.symbolSize/2:c.symbolSize:5;var C=this._getAnimProps(e,r),I=C.enabled&&!this._isToggleRefresh&&5e3>g.xoffsets.length?C.duration:0,M={groupIndex:e,seriesIndex:r,symbolType:c.symbolType,symbolSize:c.symbolSize,"fill-opacity":m.opacity,"stroke-opacity":m.opacity,"stroke-width":m.stroke,"stroke-width-symbol":m.strokeSymbol,"stroke-dasharray":m.dashStyle,items:[],polarAxisCoords:p},F=void 0;for(let u=g.xoffsets.first;u<=g.xoffsets.last;u++){var A=this._getDataValueAsNumber(u,s,e);if("number"==typeof A){var D=g.xoffsets.data[u],T=g.xoffsets.xvalues[u],O=g.offsets[r][u][n];if(!(O<d.y||O>d.y+d.height)&&!(isNaN(D)||isNaN(O))){if(o){var R=D;D=O,O=R+t.y}else D+=t.x;if(!(!f&&F&&this.enableSampling&&1>this.renderer._ptdist(F.x,F.y,D,O))){F={x:D,y:O};var L=k;if(l){var P=this._getDataValueAsNumber(u,c.radiusDataField||c.sizeDataField,e);if("number"!=typeof P)continue;L=w+(S-w)*(P-b)/a(1,v-b),isNaN(L)&&(L=w)}g.offsets[r][u].radius=L;var G=NaN,V=NaN,E=0,B=this._elementRenderInfo;if(void 0!==T&&null!==T&&B&&B.length>e&&B[e].series.length>r){var H=B[e].series[r][T];if(H&&!isNaN(H.to)){if(G=H.to,V=H.xoffset,E=k,o){var R=V;V=G,G=R+t.y}else V+=t.x;l&&(E=w+(S-w)*(H.valueRadius-b)/a(1,v-b),isNaN(E)&&(E=w))}}f&&(_=this._getColors(e,r,u,h)),M.items.push({from:E,to:L,itemIndex:u,fill:_.fillColor,stroke:_.lineColor,x:D,y:O,xFrom:V,yFrom:G})}}}}this._animR(M,0);var j=this;this._enqueueAnimation("series",void 0,void 0,I,function(e,t,i){j._animR(t,i)},M)}}}}}_animR(e,t){let n=e.items,s=e.symbolType||"circle",a=e.symbolSize;for(let l=0;l<n.length;l++){let i=n[l],o=i.x,d=i.y,g=Math.round((i.to-i.from)*t+i.from);if(isNaN(i.yFrom)||(d=i.yFrom+(d-i.yFrom)*t),isNaN(i.xFrom)||(o=i.xFrom+(o-i.xFrom)*t),e.polarAxisCoords){let t=this._toPolarCoord(e.polarAxisCoords,this._plotRect,o,d);o=t.x,d=t.y}o=this.renderer._ptrnd(o),d=this.renderer._ptrnd(d),g=this.renderer._ptrnd(g);let r=this._getRenderInfo(e.groupIndex,e.seriesIndex,n[l].itemIndex),u=r.element,p=r.labelElement;"circle"===s?(!u&&(u=this.renderer.circle(o,d,g),this.renderer.attr(u,{fill:i.fill,"fill-opacity":e["fill-opacity"],"stroke-opacity":e["fill-opacity"],stroke:i.stroke,"stroke-width":e["stroke-width"],"stroke-dasharray":e["stroke-dasharray"]})),this.renderer.attr(u,{r:g,cy:d,cx:o})):(u&&this.renderer.removeElement(u),u=this._drawSymbol(s,o,d,i.fill,e["fill-opacity"],i.stroke,e["stroke-opacity"]||e["fill-opacity"],e["stroke-width-symbol"],e["stroke-dasharray"],a||g)),p&&this.renderer.removeElement(p),p=this._showLabel(e.groupIndex,e.seriesIndex,i.itemIndex,{x:o-g,y:d-g,width:2*g,height:2*g}),1<=t&&this._installHandlers(u,"circle",e.groupIndex,e.seriesIndex,i.itemIndex),this._setRenderInfo(e.groupIndex,e.seriesIndex,n[l].itemIndex,{element:u,labelElement:p})}}_showMultiSeriesToolTip(e){let t=this,i="<div style='text-align:left'>",r="";for(let n=0;n<t.seriesGroups.length;n++){if(t._isPieGroup(n))continue;let s=t._getXAxis(n),a=t._getValueAxis(n),l=t.seriesGroups[n],o=this._getAxisSettings(s),d=this._getFormatSettings(o,"toolTipFormatSettings"),g=o.toolTipFormatFunction,u=t._getDataValue(e,s.dataField,n);(s.dataField===void 0||null===s.dataField||""===s.dataField)&&(u=e),"date"===s.type&&(u=t._castAsDate(u,(d?d.dateFormat:void 0)||s.dateFormat)),g||d||"date"!==s.type||(g=this._getDefaultDTFormatFn(s.baseUnit||"day"));let p=s.displayText||s.dataField||"";""!==p&&(p+=": ");let h=p+t._formatValue(u,d,g,n,void 0,e);r!==h&&(""!==r&&(i+="<br />"),i+=h+"<br /><br />",r=h);for(let r=0,s;r<l.series.length;r++){if(s=l.series[r],!1===l.showToolTips||!1===s.showToolTips)continue;if(!t._isSerieVisible(n,r))continue;let o=t._get([t._getFormatSettings(s,"toolTipFormatSettings"),t._getFormatSettings(l,"toolTipFormatSettings"),t._getFormatSettings(a,"toolTipFormatSettings"),t._getFormatSettings(t,"toolTipFormatSettings")]),d=t._get([s.toolTipFormatFunction,l.toolTipFormatFunction,a.toolTipFormatFunction,t.toolTipFormatFunction]),g=t._getFormattedValue(n,r,e,o,d),u=t._getColors(n,r,e);i+="<span style=\"color:"+u.lineColor+";\">"+g+"</span><br />\n"}}let n=this._get([t.toolTipClass,"smart-chart-tooltip-text"]),s=this._get([t.toolTipBackground,t._getThemeColor("background")]),a=this._get([t.toolTipLineColor,t._getThemeColor("line")]),l=this._get([t.toolTipOpacity,1]);i+="</div>";let o=this.getItemCoord(t._ttEl.gidx,t._ttEl.sidx,t._ttEl.iidx);o.x+=window.pageXOffset,o.y+=window.pageYOffset,t._createTooltip(o,t.seriesGroups[t._ttEl.gidx],i,{css:n,fill:s,stroke:a,fillOpacity:l,symbolSize:3})}_showToolTip(e,t,i,r,n){let s=this,a=s._getXAxis(i),l=s._getValueAxis(i);if(s._ttEl&&i===s._ttEl.gidx&&r===s._ttEl.sidx&&n===s._ttEl.iidx)return;let o=s.seriesGroups[i],d=o.series[r],g=s.enableCrosshairs;s._pointMarker?(e=parseInt(s._pointMarker.x+5),t=parseInt(s._pointMarker.y-5)):g=!1;let u=g&&!1===s.showToolTips;if(e=this.renderer._ptrnd(e),t=this.renderer._ptrnd(t),!1===o.showToolTips||!1===d.showToolTips)return;s._ttEl||(s._ttEl={}),s._ttEl.sidx=r,s._ttEl.gidx=i,s._ttEl.iidx=n;let p=0;for(let a=0;a<s.seriesGroups.length;a++)for(let e=0;e<s.seriesGroups[a].series.length;e++)p++;if(g){let e=this.renderer._ptrnd(s._pointMarker.x),t=this.renderer._ptrnd(s._pointMarker.y),r=s.crosshairsColor||s._getThemeColor("line");if(o.polar||o.spider){let n=this._getPolarAxisCoords(i,this._plotRect),a=this.renderer._ptdist(e,t,n.x,n.y);if(a>n.r)return;let l=Math.atan2(t-n.y,e-n.x),o=Math.cos(l)*n.r+n.x,d=Math.sin(l)*n.r+n.y;s._ttEl.vLine?s.renderer.attr(s._ttEl.vLine,{x1:n.x,y1:n.y,x2:o,y2:d}):s._ttEl.vLine=s.renderer.line(n.x,n.y,o,d,{stroke:r,"stroke-width":s.crosshairsLineWidth||1,"stroke-dasharray":s.crosshairsDashStyle||""})}else s._ttEl.vLine&&s._ttEl.hLine?(s.renderer.attr(s._ttEl.vLine,{x1:e,x2:e}),s.renderer.attr(s._ttEl.hLine,{y1:t,y2:t})):(s._ttEl.vLine=s.renderer.line(e,s._plotRect.y,e,s._plotRect.y+s._plotRect.height,{stroke:r,"stroke-width":s.crosshairsLineWidth||1,"stroke-dasharray":s.crosshairsDashStyle||""}),s._ttEl.hLine=s.renderer.line(s._plotRect.x,t,s._plotRect.x+s._plotRect.width,t,{stroke:r,"stroke-width":s.crosshairsLineWidth||1,"stroke-dasharray":s.crosshairsDashStyle||""}))}if(s.showToolTipsOnAllSeries&&!s._isPieGroup(i)&&1<p)return void s._showMultiSeriesToolTip(n);let h=s._get([s._getFormatSettings(d,"toolTipFormatSettings"),s._getFormatSettings(o,"toolTipFormatSettings"),s._getFormatSettings(l,"toolTipFormatSettings"),s._getFormatSettings(s,"toolTipFormatSettings")]),m=s._get([d.toolTipFormatFunction,o.toolTipFormatFunction,l.toolTipFormatFunction,s.toolTipFormatFunction]),c=s._getColors(i,r,n),f=s._getDataValue(n,a.dataField,i);(void 0===a.dataField||null===a.dataField||""===a.dataField)&&(f=n),"date"===a.type&&(f=s._castAsDate(f,(h?h.dateFormat:void 0)||a.dateFormat));let _="";if("function"==typeof m){let e={},t=0;for(let r in d)0===r.indexOf("dataField")&&(e[r.substring(9,r.length).toLowerCase()]=s._getDataValue(n,d[r],i),t++);0===t?e=s._getDataValue(n,void 0,i):1===t&&(e=e[""]),_=m(e,n,d,o,f,a)}else{_=s._getFormattedValue(i,r,n,h,m);let e=this._getAxisSettings(a),t=s._getFormatSettings(e,"toolTipFormatSettings"),l=e.toolTipFormatFunction;l||t||"date"!==a.type||(l=this._getDefaultDTFormatFn(a.baseUnit||"day"));let o=s._formatValue(f,t,l,i,r,n);if(!s._isPieGroup(i)){let e=a.displayText||a.dataField||"";_=0<e.length?e+": "+o+"<br>"+_:o+"<br>"+_}else f=s._getDataValue(n,d.displayText||d.dataField,i),o=s._formatValue(f,t,l,i,r,n),_=o+": "+_}if(!u&&!1!==s.showToolTips){let e=this._get([d.toolTipClass,o.toolTipClass,s.toolTipClass,"smart-chart-tooltip-text"]),t=this._get([d.toolTipBackground,o.toolTipBackground,s.toolTipBackground,s._getThemeColor("background")]),a=this._get([d.toolTipLineColor,o.toolTipLineColor,s.toolTipLineColor,c.lineColor,s._getThemeColor("line")]),l=this._get([d.toolTipOpacity,o.toolTipOpacity,s.toolTipOpacity,1]),g=this.getItemCoord(i,r,n);g.y=Math.min(Math.max(g.y,this._plotRect.y),this._plotRect.y+this._plotRect.y+this._plotRect.height);let u=0;s._pointMarker&&s._pointMarker.element&&(u=d.symbolSizeSelected,isNaN(u)&&(u=d.symbolSize),(isNaN(u)||50<u||0>u)&&(u=o.symbolSize),(isNaN(u)||50<u||0>u)&&(u=8)),s._createTooltip(g,o,_,{css:e,fill:t,stroke:a,fillOpacity:l,symbolSize:u})}}_fitTooltip(e,t,i,r,n){let s={},a=2+n/2,l=7;if(t.x-i.width-l-a>e.x&&t.y+t.height/2-i.height/2>e.y&&t.y+t.height/2+i.height/2<e.y+e.height&&(s.left={arrowLocation:"right",x:t.x-i.width-l-a,y:t.y+t.height/2-i.height/2,width:i.width+l,height:i.height}),t.x+t.width+i.width+l+a<e.x+e.width&&t.y+t.height/2-i.height/2>e.y&&t.y+t.height/2+i.height/2<e.y+e.height&&(s.right={arrowLocation:"left",x:t.x+t.width+a,y:t.y+t.height/2-i.height/2,width:i.width+l,height:i.height}),t.y-i.height-a-l>e.y&&t.x+t.width/2-i.width/2>e.x&&t.x+t.width/2+i.width/2<e.x+e.width&&(s.top={arrowLocation:"bottom",x:t.x+t.width/2-i.width/2,y:t.y-i.height-a-l,width:i.width,height:i.height+l}),t.y+t.height+i.height+l+a<e.y+e.height&&t.x+t.width/2-i.width/2>e.x&&t.x+t.width/2+i.width/2<e.x+e.width&&(s.bottom={arrowLocation:"top",x:t.x+t.width/2-i.width/2,y:t.y+t.height+a,width:i.width,height:i.height+l}),t.width>t.height||(-1!==r.type.indexOf("stackedcolumn")||-1!==r.type.indexOf("stackedwaterfall"))&&"horizontal"!==r.orientation){if(s.left)return s.left;if(s.right)return s.right}else{if(s.top)return s.top;if(s.bottom)return s.bottom}for(let a in s)if(s[a])return s[a];return{arrowLocation:""}}_createTooltip(e,t,i,r){var n=Math.max;const s=this,a=t.type;let l=s._ttEl.box;if(!l){l=s._ttEl.box=document.createElement("div"),l.className="smart-chart-tooltip",l.setAttribute("animation",s.animation),l.setAttribute("theme",s.theme);const e=document.createElement("div"),t=document.createElement("div"),i=document.createElement("div");e.id="arrowOuterDiv",e.className="smart-chart-tooltip-arrow-outer",t.id="arrowInnerDiv",t.className="smart-chart-tooltip-arrow-inner",i.id="contentDiv",i.className="smart-chart-tooltip-content",l.appendChild(i),l.appendChild(e),l.appendChild(t),document.body.appendChild(l)}if(!i||0===i.length)return void l.classList.add("smart-visibility-hidden");l.classList.add("smart-visibility-hidden");const o=l.firstElementChild,d=l.children[1],g=l.children[2];g.style.opacity=d.style.opacity=r.fillOpacity,o.style.backgroundColor=r.fill,o.style.borderColor=r.stroke,o.style.opacity=r.fillOpacity;const u="<span class=\""+r.css+"\">"+i+"</span>";o.innerHTML=u;const p=s._measureHtml(u),h=s._plotRect;if(p.width>h.width||p.height>h.height)return;let m={width:p.width,height:p.height},c="",f=7,_=s._isColumnType(a),b=n(e.x,h.x),v=n(e.y,h.y);if(-1!==a.indexOf("pie")||-1!==a.indexOf("donut")){let t=(e.fromAngle+e.toAngle)/2;t*=Math.PI/180;let i=!isNaN(e.innerRadius)&&0<e.innerRadius?(e.innerRadius+e.outerRadius)/2:.75*e.outerRadius;b=e.x=e.center.x+Math.cos(t)*i,v=e.y=e.center.y-Math.sin(t)*i,e.width=e.height=1}else _&&(t.polar||t.spider)&&(e.width=e.height=1);let A=this._fitTooltip(this._plotRect,e,m,t,r.symbolSize);""!==A.arrowLocation&&(c=A.arrowLocation,b=A.x,v=A.y,m.width=A.width,m.height=A.height),"top"===c||"bottom"===c?(m.height+=f,b-=f/2,"bottom"===c&&(v-=f)):("left"===c||"right"===c)&&(m.width+=f,v-=f/2,"right"===c&&(b-=f)),b+m.width>h.x+h.width&&(c="",b=h.x+h.width-m.width),v+m.height>h.y+h.height&&(c="",v=h.y+h.height-m.height);let w={x:0,y:0},S={x:0,y:0};o.style.width=p.width+"px",o.style.height=p.height+"px",d.style["margin-top"]=d.style["margin-left"]=0,g.style["margin-top"]=g.style["margin-left"]=0,o.style["margin-top"]=o.style["margin-left"]=0;let k=f+"px solid",C=f+"px solid transparent";"left"===c?(w={x:0,y:(p.height-f)/2},S={x:f,y:0},o.style["margin-left"]=f+"px",d.style["margin-left"]="0px",d.style["margin-top"]=w.y+"px",d.style["border-left"]="",d.style["border-right"]=k+" "+r.stroke,d.style["border-top"]=C,d.style["border-bottom"]=C,g.style["margin-left"]="1px",g.style["margin-top"]=w.y+"px",g.style["border-left"]="",g.style["border-right"]=k+" "+r.fill,g.style["border-top"]=C,g.style["border-bottom"]=C):"right"===c?(w={x:m.width-f,y:(p.height-f)/2},S={x:0,y:0},d.style["margin-left"]=w.x+"px",d.style["margin-top"]=w.y+"px",d.style["border-left"]=k+" "+r.stroke,d.style["border-right"]="",d.style["border-top"]=C,d.style["border-bottom"]=C,g.style["margin-left"]=w.x-1+"px",g.style["margin-top"]=w.y+"px",g.style["border-left"]=k+" "+r.fill,g.style["border-right"]="",g.style["border-top"]=C,g.style["border-bottom"]=C):"top"===c?(w={x:m.width/2-f/2,y:0},S={x:0,y:f},o.style["margin-top"]=S.y+"px",d.style["margin-left"]=w.x+"px",d.style["border-top"]="",d.style["border-bottom"]=k+" "+r.stroke,d.style["border-left"]=C,d.style["border-right"]=C,g.style["margin-left"]=w.x+"px",g.style["margin-top"]="1px",g.style["border-top"]="",g.style["border-bottom"]=k+" "+r.fill,g.style["border-left"]=C,g.style["border-right"]=C):"bottom"===c?(w={x:m.width/2-f/2,y:m.height-f},S={x:0,y:0},d.style["margin-left"]=w.x+"px",d.style["margin-top"]=w.y+"px",d.style["border-top"]=k+" "+r.stroke,d.style["border-bottom"]="",d.style["border-left"]=C,d.style["border-right"]=C,g.style["margin-left"]=w.x+"px",g.style["margin-top"]=w.y-1+"px",g.style["border-top"]=k+" "+r.fill,g.style["border-bottom"]="",g.style["border-left"]=C,g.style["border-right"]=C):void 0;""===c?(d.classList.add("smart-hidden"),g.classList.add("smart-hidden")):(d.classList.remove("smart-hidden"),g.classList.remove("smart-hidden")),l.style.width=m.width+"px",l.style.height=m.height+"px";const I=s.getBoundingClientRect();l.style.left=b+I.left+window.pageXOffset+"px",l.style.top=v+I.top+window.pageYOffset+"px",l.classList.remove("smart-visibility-hidden")}_measureHtml(e){const t=this;let i=t._measureDiv;i||(t._measureDiv=i=document.createElement("div"),i.className="smart-chart-tooltip",i.style.position="absolute",i.style.visibility="hidden",i.style.left=0,i.style.top=0,(t.shadowRoot||t).appendChild(i)),i.innerHTML=e;const r={width:i.offsetWidth+2,height:i.offsetHeight+2};return Smart.Utilities.Core.Browser.Firefox&&(r.height+=3),r}_hideToolTip(){this._ttEl&&(this._ttEl.box&&this._ttEl.box.classList.add("smart-visibility-hidden"),this._hideCrosshairs(),this._ttEl.gidx=void 0)}_hideCrosshairs(){this._ttEl&&(this._ttEl.vLine&&(this.renderer.removeElement(this._ttEl.vLine),this._ttEl.vLine=void 0),this._ttEl.hLine&&(this.renderer.removeElement(this._ttEl.hLine),this._ttEl.hLine=void 0))}_get(e){return this._draw.getByPriority(e)}_getAxisSettings(e){if(!e)return{};let t=this,i=e.gridLines||{},r={visible:t._get([i.visible,!0]),color:t._get([i.color,t._getThemeColor("line")]),unitInterval:i.unitInterval,step:i.step,dashStyle:i.dashStyle,width:t._get([i.lineWidth,1]),offsets:[],alternatingBackgroundColor:e.alternatingBackgroundColor,alternatingBackgroundColor2:e.alternatingBackgroundColor2,alternatingBackgroundOpacity:e.alternatingBackgroundOpacity},n=e.tickMarks||{},s={visible:t._get([n.visible,e.showTickMarks,!0]),color:t._get([n.color,e.tickMarksColor,t._getThemeColor("line")]),unitInterval:t._get([n.unitInterval,n.interval,e.tickMarksInterval]),step:t._get([n.step,e.tickMarksStep]),dashStyle:t._get([n.dashStyle,e.tickMarksDashStyle]),width:t._get([n.lineWidth,1]),size:t._get([n.size,4]),offsets:[]},a=e.title||{},l={visible:t._get([a.visible,!0]),text:t._get([e.description,a.text]),style:t._get([e.descriptionClass,a["class"],"smart-chart-axis-description"]),halign:t._get([e.horizontalDescriptionAlignment,a.horizontalAlignment,"center"]),valign:t._get([e.verticalDescriptionAlignment,a.verticalAlignment,"center"]),angle:0,rotationPoint:t._get([a.rotationPoint,"centercenter"]),offset:t._get([a.offset,{x:0,y:0}])},o=e.line||{},d={visible:t._get([o.visible,!0]),color:t._get([o.color,r.color,t._getThemeColor("line")]),dashStyle:t._get([o.dashStyle,r.dashStyle,""]),width:t._get([o.lineWidth,1]),angle:t._get([o.angle,NaN])},g=e.padding||{};g={left:g.left||0,right:g.right||0,top:g.top||0,bottom:g.bottom||0};let u=this._getAxisLabelsSettings(e),p={visible:this._get([e.visible,!0]),customDraw:this._get([e.customDraw,!1]),gridLines:r,tickMarks:s,line:d,title:l,labels:u,padding:g,toolTipFormatFunction:this._get([e.toolTipFormatFunction,e.formatFunction,u.formatFunction]),toolTipFormatSettings:this._get([t._getFormatSettings(e,"toolTipFormatSettings"),t._getFormatSettings(e),t._getFormatSettings(u)])};return p}_getAxisLabelsSettings(e){let t=this,i=e.labels||{},r={visible:t._get([e.showLabels,i.visible,!0]),unitInterval:t._get([i.unitInterval,i.interval,e.labelsInterval]),step:t._get([i.step,e.labelsStep]),angle:t._get([e.textRotationAngle,i.angle,0]),style:t._get([e["class"],i["class"],"smart-chart-axis-text"]),halign:t._get([e.horizontalTextAlignment,i.horizontalAlignment,"center"]),valign:t._get([e.verticalTextAlignment,i.verticalAlignment,"center"]),textRotationPoint:t._get([e.textRotationPoint,i.rotationPoint,"auto"]),textOffset:t._get([e.textOffset,i.offset,{x:0,y:0}]),autoRotate:t._get([e.labelsAutoRotate,i.autoRotate,!1]),formatSettings:t._get([t._getFormatSettings(e),t._getFormatSettings(i),void 0]),formatFunction:t._get([e.formatFunction,i.formatFunction,void 0])};return r}_getLabelsSettings(e,t,r,i){let n=this.seriesGroups[e],a=n.series[t],s=isNaN(r)?void 0:this._getDataValue(r,a.dataField,e),l=i||["Visible","Offset","Angle","HorizontalAlignment","VerticalAlignment","Class","BackgroundColor","BorderColor","BorderOpacity","Padding","Opacity","BackgroundOpacity","LinesAngles","LinesEnabled","AutoRotate","Radius"],o={};for(let d=0;d<l.length;d++){let e=l[d],t="labels"+e,i="label"+e,g=e.substring(0,1).toLowerCase()+e.substring(1),u;n.labels&&"object"==typeof n.labels&&(u=n.labels[g]),a.labels&&"object"==typeof a.labels&&void 0!==a.labels[g]&&null!==a.labels[g]&&(u=a.labels[g]),u=this._get([a[t],a[i],u,n[t],n[i]]),o[g]="function"==typeof u?u(s,r,a,n):u}o["class"]=o["class"]||"smart-chart-label-text",o.visible=this._get([o.visible,a.showLabels,n.showLabels,void 0!==a.labels&&null!==a.labels||void 0,void 0!==n.labels&&null!==n.labels||void 0]);let d=o.padding||1;return o.padding={left:this._get([d.left,isNaN(d)?1:d]),right:this._get([d.right,isNaN(d)?1:d]),top:this._get([d.top,isNaN(d)?1:d]),bottom:this._get([d.bottom,isNaN(d)?1:d])},o}_showLabel(e,t,i,r,n,s,a,l,o,d,g){var u=Math.max;let p={width:0,height:0},m;if(isNaN(i))return;let c=this._getLabelsSettings(e,t,i);if(!c.visible)return a?p:void 0;if(0>r.width||0>r.height)return a?p:void 0;let f=c.angle;isNaN(d)||(f=d);let _=c.offset||{},b={x:_.x,y:_.y};isNaN(b.x)&&(b.x=0),isNaN(b.y)&&(b.y=0),n=n||c.horizontalAlignment||"center",s=s||c.verticalAlignment||"center";let v=this._getFormattedValue(e,t,i,void 0,void 0,!0),A=r.width,w=r.height;if(!0===l&&"center"!==n&&(n="right"===n?"left":"right"),!0===o&&"center"!==s&&"middle"!==s&&(s="top"===s?"bottom":"top",b.y*=-1),p=this.renderer.measureText(v,f,{class:c["class"]}),a)return p;let h=0,S=0;0<A&&(""===n||"center"===n?h+=(A-p.width)/2:"right"===n&&(h+=A-p.width)),0<w&&(""===s||"center"===s?S+=(w-p.height)/2:"bottom"===s&&(S+=w-p.height)),h+=r.x+b.x,S+=r.y+b.y;let k=this._plotRect;h<=k.x&&(h=k.x+2),S<=k.y&&(S=k.y+2);let C={width:u(p.width,1),height:u(p.height,1)};S+C.height>=k.y+k.height&&(S=k.y+k.height-(m?(C.height+m.height)/2:C.height)-2),h+C.width>=k.x+k.width&&(h=k.x+k.width-C.width-2);let I=c.backgroundColor,M=c.borderColor,F=c.padding,D;(I||M)&&(D=this.renderer.beginGroup(),this.renderer.rect(h-F.left,S-F.top,p.width+F.left+F.right,p.height+F.bottom+F.bottom,{fill:I||"transparent","fill-opacity":c.backgroundOpacity||1,stroke:M||"transparent","stroke-opacity":c.borderOpacity,"stroke-width":1}));let T=this.renderer.text(v,h,S,p.width,p.height,f,{class:c["class"],opacity:c.opacity||1},!1,"center","center",void 0,arguments[11]);return g&&(g.x=h-F.left,g.y=S-F.top,g.width=p.width+F.left+F.right,g.height=p.height+F.bottom+F.bottom),D&&this.renderer.endGroup(),D||T}_getAnimProps(e,t){let i=this.seriesGroups[e],r=isNaN(t)?void 0:i.series[t],n=this.hasAnimation;i.animation&&(n="none"!==i.animation),r&&r.animation&&(n="none"!==r.animation);let s=this.animationDuration;isNaN(s)&&(s=1e3);let a=i.animationDuration;if(isNaN(a)||(s=a),r){let e=r.animationDuration;isNaN(e)||(s=e)}return 5e3<s&&(s=1e3),{enabled:n,duration:s}}_isColorTransition(e,t,i,r){if(r-1<i.xoffsets.first)return!1;let n=this._getColors(e,t,r,this._getGroupGradientType(e)),s=this._getColors(e,t,r-1,this._getGroupGradientType(e));return n.fillColor!==s.fillColor}_renderLineSeries(e,t){var r=Math.max,n=this.seriesGroups[e];if(n.series&&0!==n.series.length){var s=-1!==n.type.indexOf("area"),i=-1!==n.type.indexOf("stacked"),a=i&&-1!==n.type.indexOf("100"),l=-1!==n.type.indexOf("spline"),o=-1!==n.type.indexOf("step"),d=-1!==n.type.indexOf("range"),g=!0===n.polar||!0===n.spider;if(g&&(o=!1),!(o&&l)){var u="horizontal"===n.orientation,p=!0===this._getXAxis(e).flip,h=t;u&&(h={x:t.y,y:t.x,width:t.height,height:t.width});var y=this._calcGroupOffsets(e,h);if(y&&0!==y.xoffsets.length){this._linesRenderInfo||(this._linesRenderInfo={}),this._linesRenderInfo[e]={};for(let t=n.series.length-1;0<=t;t--){var m=this._getSerieSettings(e,t),c={groupIndex:e,rect:h,serieIndex:t,swapXY:u,isArea:s,isSpline:l,isRange:d,isPolar:g,settings:m,segments:[],pointsLength:0},f=this._isSerieVisible(e,t);if(!f){this._linesRenderInfo[e][t]=c;continue}var _=n.series[t];if(!_.customDraw){var b="function"==typeof _.colorFunction,v=y.xoffsets.first,A=v,w=this._getColors(e,t,NaN,this._getGroupGradientType(e)),S;do{var k=[],C=[],I=[],M=0,F=0,D=NaN,T=NaN,O=NaN;if(1>y.xoffsets.length)continue;var R=this._getAnimProps(e,t),L=R.enabled&&!this._isToggleRefresh&&1e4>y.xoffsets.length&&R.duration,P=v;S=!1;var G=void 0;for(let l=v;l<=y.xoffsets.last;l++){v=l;var V=y.xoffsets.data[l],E=y.xoffsets.xvalues[l];if(!isNaN(V)&&(V=r(V,1),M=V,F=y.offsets[t][l].to,!(!b&&G&&this.enableSampling&&1>this.renderer._ptdist(G.x,G.y,M,F)))){G={x:M,y:F};var B=y.offsets[t][l].from;if(isNaN(F)||isNaN(B))if("connect"===_.emptyPointsDisplay)continue;else if("zero"===_.emptyPointsDisplay)isNaN(F)&&(F=y.baseOffset),isNaN(B)&&(B=y.baseOffset);else{S=!0;break}if(b&&this._isColorTransition(e,t,y,v)&&1<k.length){v--;break}var H=this._elementRenderInfo;if(H&&H.length>e&&H[e].series.length>t){var j=H[e].series[t][E],O=this.renderer._ptrnd(j?j.to:void 0),z=this.renderer._ptrnd(h.x+(j?j.xoffset:void 0));I.push(u?{y:z,x:O,index:l}:{x:z,y:O,index:l})}A=l,2>m.stroke&&(1>=F-h.y&&(F=h.y+1),1>=B-h.y&&(B=h.y+1),1>=h.y+h.height-F&&(F=h.y+h.height-1),1>=h.y+h.height-B&&(B=h.y+h.height-1)),!s&&a&&(F<=h.y&&(F=h.y+1),F>=h.y+h.height&&(F=h.y+h.height-1),B<=h.y&&(B=h.y+1),B>=h.y+h.height&&(B=h.y+h.height-1)),V=r(V,1),M=V+h.x,!0===n.skipOverlappingPoints&&!isNaN(D)&&1>=Math.abs(D-M)||(o&&!isNaN(D)&&!isNaN(T)&&T!==F&&k.push(u?{y:M,x:this.renderer._ptrnd(T)}:{x:M,y:this.renderer._ptrnd(T)}),k.push(u?{y:M,x:this.renderer._ptrnd(F),index:l}:{x:M,y:this.renderer._ptrnd(F),index:l}),C.push(u?{y:M,x:this.renderer._ptrnd(B),index:l}:{x:M,y:this.renderer._ptrnd(B),index:l}),D=M,T=F,isNaN(O)&&(O=F))}}if(0===k.length){v++;continue}var W=k[k.length-1].index;b&&(w=this._getColors(e,t,W,this._getGroupGradientType(e)));var X=h.x+y.xoffsets.data[P],N=h.x+y.xoffsets.data[A];if(s&&!0===n.alignEndPointsWithIntervals&&(X>h.x&&(X=h.x),N<h.x+h.width&&(N=h.x+h.width),p)){var U=X;X=N,N=U}N=this.renderer._ptrnd(N),X=this.renderer._ptrnd(X);var Y=y.baseOffset;O=this.renderer._ptrnd(O);var Z=this.renderer._ptrnd(F)||Y;d&&(k=k.concat(C.reverse())),c.pointsLength+=k.length;var q={lastItemIndex:W,colorSettings:w,pointsArray:k,pointsStart:I,left:X,right:N,pyStart:O,pyEnd:Z,yBase:Y,labelElements:[],symbolElements:[]};c.segments.push(q)}while(v<y.xoffsets.first+y.xoffsets.length-1||S);this._linesRenderInfo[e][t]=c}}var J=this._linesRenderInfo[e],K=[];for(let e in J)K.push(J[e]);K=K.sort(function(e,t){return e.serieIndex-t.serieIndex}),s&&i&&K.reverse();for(let e=0;e<K.length;e++){var c=K[e];this._animateLine(c,0===L?1:0);var $=this;this._enqueueAnimation("series",void 0,void 0,L,function(e,t,i){$._animateLine(t,i)},c)}}}}}_animateLine(e,t){let r=e.settings,n=e.groupIndex,s=e.serieIndex,i=this.seriesGroups[n],a=i.series[s],l=this._getSymbol(n,s),o=this._getLabelsSettings(n,s,NaN,["Visible"]).visible,d=!0;e.isPolar&&!isNaN(i.endAngle)&&360!==Math.round(Math.abs((isNaN(i.startAngle)?0:i.startAngle)-i.endAngle))&&(d=!1),!1===a.endPointsConnect&&(d=!1);let g=0;for(let i=0;i<e.segments.length;i++){let u=e.segments[i],p=this._calculateLine(n,e.pointsLength,g,u.pointsArray,u.pointsStart,u.yBase,t,e.isArea,e.swapXY);if(g+=u.pointsArray.length,""===p)continue;let h=p.split(" "),y=p;y=""===y?"M 0 0":this._buildLineCmd(p,e.isRange,u.left,u.right,u.pyStart,u.pyEnd,u.yBase,e.isArea,e.isPolar,d,e.isSpline,e.swapXY);let m=u.colorSettings;if(u.pathElement?this.renderer.attr(u.pathElement,{d:y}):(u.pathElement=this.renderer.path(y,{"stroke-width":r.stroke,stroke:m.lineColor,"stroke-opacity":r.opacity,"fill-opacity":r.opacity,"stroke-dasharray":r.dashStyle,fill:e.isArea?m.fillColor:"none"}),this._installHandlers(u.pathElement,"path",n,s,u.lastItemIndex)),u.labelElements){for(let e=0;e<u.labelElements.length;e++)this.renderer.removeElement(u.labelElements[e]);u.labelElements=[]}if(u.symbolElements){for(let e=0;e<u.symbolElements.length;e++)this.renderer.removeElement(u.symbolElements[e]);u.symbolElements=[]}if(u.pointsArray.length===h.length&&("none"!==l||o)){let e=a.symbolSize,t=this._plotRect;for(let a=0,i;a<h.length;a++)if(i=h[a].split(","),i={x:parseFloat(i[0]),y:parseFloat(i[1])},!(i.x<t.x||i.x>t.x+t.width||i.y<t.y||i.y>t.y+t.height)){if("none"!==l){let t=this._getColors(n,s,u.pointsArray[a].index,this._getGroupGradientType(n)),o=this._drawSymbol(l,i.x,i.y,t.fillColorSymbol,r.opacity,t.lineColorSymbol,r.opacity,r.strokeSymbol,void 0,e);u.symbolElements.push(o)}if(o&&(i=this._adjustLineLabelPosition(n,s,u.pointsArray[a].index,i),i)){let e=this._showLabel(n,s,u.pointsArray[a].index,{x:i.x,y:i.y,width:0,height:0});u.labelElements.push(e)}}}if(1===t&&"none"!==l)for(let e=0;e<u.symbolElements.length;e++)isNaN(u.pointsArray[e].index)||this._installHandlers(u.symbolElements[e],"symbol",n,s,u.pointsArray[e].index)}}_adjustLineLabelPosition(e,t,i,r){let n=this._showLabel(e,t,i,{width:0,height:0},"","",!0);if(n){let e={x:r.x-n.width/2,y:0,y:r.y-1.5*n.height};return e}}_calculateLine(e,t,i,r,n,s,a,l,o){let d=this.seriesGroups[e],g;(!0===d.polar||!0===d.spider)&&(g=this._getPolarAxisCoords(e,this._plotRect));let u="",p=r.length;if(!l&&0===n.length){p=t*a-i}for(let d=0;d<p+1&&d<r.length;d++){0<d&&(u+=" ");let e=r[d].y,t=r[d].x,i=l?s:e,h=t;if(n&&n.length>d&&(i=n[d].y,h=n[d].x,(isNaN(i)||isNaN(h))&&(i=e,h=t)),p<=r.length&&0<d&&d===p&&(h=r[d-1].x,i=r[d-1].y),o?(t=this.renderer._ptrnd((t-i)*(l?a:1)+i),e=this.renderer._ptrnd(e)):(t=this.renderer._ptrnd((t-h)*a+h),e=this.renderer._ptrnd((e-i)*a+i)),g){let i=this._toPolarCoord(g,this._plotRect,t,e);t=i.x,e=i.y}u+=t+","+e}return u}_buildLineCmd(e,t,i,r,n,s,a,l,o,d,g,u){let p=e,h=u?a+","+i:i+","+a,y=u?a+","+r:r+","+a;!l||o||t||(p=h+" "+e+" "+y),g&&(p=this._getBezierPoints(p));let m=p.split(" ");if(0===m.length)return"";if(1===m.length){let e=m[0].split(",");return"M "+m[0]+" L"+(parseFloat(e[0])+1)+","+(parseFloat(e[1])+1)}let c=m[0].replace("M","");return l&&!o?t?p="M "+c+" L "+c+(g?"":" L "+c+" ")+p:p="M "+h+" L "+c+" "+p:!g&&(p="M "+c+" L "+c+" "+p),(o&&d||t)&&(p+=" Z"),p}_getSerieSettings(e,t){let i=this.seriesGroups[e],r=-1!==i.type.indexOf("area"),n=-1!==i.type.indexOf("line"),s=i.series[t],a=s.dashStyle||i.dashStyle||"",l=s.opacity||i.opacity;(isNaN(l)||0>l||1<l)&&(l=1);let o=s.lineWidth;isNaN(o)&&"auto"!==o&&(o=i.lineWidth),("auto"===o||isNaN(o)||0>o||15<o)&&(r?o=2:n?o=3:o=1);let d=s.lineWidthSymbol;return isNaN(d)&&(d=1),{stroke:o,strokeSymbol:d,opacity:l,dashStyle:a}}_getColors(e,t,i,r,n){let s=this.seriesGroups[e],a=s.series[t],l=this._get([a.useGradientColors,s.useGradientColors,!1]),o=this._getSeriesColors(e,t,i);o.fillColor||(o.fillColor=color,o.fillColorSelected=this.renderer.adjustColor(color,1.1),o.fillColorAlt=this.renderer.adjustColor(color,4),o.fillColorAltSelected=this.renderer.adjustColor(color,3),o.lineColor=o.symbolColor=this.renderer.adjustColor(color,.9),o.lineColorSelected=o.symbolColorSelected=this.renderer.adjustColor(color,.9));let d=[[0,1.4],[100,1]],g=[[0,1],[25,1.1],[50,1.4],[100,1]],u=NaN;if(isNaN(n)||(u=2===n?d:g),l){let n={};for(let e in o)n[e]=o[e];if(o=n,"verticalLinearGradient"===r||"horizontalLinearGradient"===r){let e="verticalLinearGradient"===r?u||d:u||g,t=["fillColor","fillColorSelected","fillColorAlt","fillColorAltSelected"];for(let i in t){let n=o[t[i]];n&&(o[t[i]]=this.renderer._toLinearGradient(n,"verticalLinearGradient"===r,e))}}else if("radialGradient"===r){let r=d,n;("pie"===s.type||"donut"===s.type||s.polar)&&void 0!==i&&null!==i&&this._renderData[e]&&this._renderData[e].offsets[t]&&(n=this._renderData[e].offsets[t][i],r=[[0,1.3],[90,1.2],[100,1]]),o.fillColor=this.renderer._toRadialGradient(o.fillColor,r,n),o.fillColorSelected=this.renderer._toRadialGradient(o.fillColorSelected,r,n)}}return o}_installHandlers(e,t,i,r,n){if(!this.enableEvents)return!1;var a=this,l=this.seriesGroups[i],o=this.seriesGroups[i].series[r],s=-1!==l.type.indexOf("line")||-1!==l.type.indexOf("area");s||!1===l.enableSelection||!1===o.enableSelection||this.renderer.addHandler(e,"mousemove",function(t){var e=a._selected;if(!(e&&e.isLineType&&"click"===e.linesUnselectMode&&(e.group!==i||e.series!==r))){var s=t.pageX||t.clientX||t.screenX,l=t.pageY||t.clientY||t.screenY;const e=a.getBoundingClientRect();s-=e.left,l-=e.top,a._ttEl&&a._ttEl.gidx===i&&a._ttEl.sidx===r&&a._ttEl.iidx===n||a._startTooltipTimer(i,r,n)}}),!1===l.enableSelection||!1===o.enableSelection||this.renderer.addHandler(e,"mouseover",function(){var s=a._selected;s&&s.isLineType&&"click"===s.linesUnselectMode&&(s.group!==i||s.series!==r)||a._select(e,t,i,r,n,n)}),this.renderer.addHandler(e,"click",function(i){(clearTimeout(a._hostClickTimer),a._lastClickTs=new Date().valueOf(),!(s&&"symbol"!==t&&"pointMarker"!==t))&&(a._isColumnType(l.type)&&a._unselect(),isNaN(n)||(i.stopImmediatePropagation(),a._raiseItemEvent("click",l,o,n)))})}_getHorizontalOffset(e,t,i,r){let n=this._plotRect,s=this._getDataLen(e);if(0===s)return{index:void 0,value:i};let a=this._calcGroupOffsets(e,this._plotRect);if(0===a.xoffsets.length)return{index:void 0,value:void 0};let l=i,o=r,d=this.seriesGroups[e],g;(d.polar||d.spider)&&(g=this._getPolarAxisCoords(e,n));let u,p,h,y;for(let s=a.xoffsets.first;s<=a.xoffsets.last;s++){let e=a.xoffsets.data[s],i=a.offsets[t][s].to,r=0;if(g){let t=this._toPolarCoord(g,n,e+n.x,i);e=t.x,i=t.y,r=this.renderer._ptdist(l,o,e,i)}else if("horizontal"===d.orientation){e+=n.y;let t=i;i=e,e=t,r=this.renderer._ptdist(l,o,e,i)}else e+=n.x,r=Math.abs(l-e);(isNaN(u)||u>r)&&(u=r,p=s,h=e,y=i)}return{index:p,value:a.xoffsets.data[p],polarAxisCoords:g,x:h,y:y}}onmousemove(e,t){var r=Math.abs;if(this._mouseX===e&&this._mouseY===t)return;if(this._mouseX=e,this._mouseY=t,!this._selected)return;let n=this._selected.group,a=this._selected.series,l=this.seriesGroups[n],o=l.series[a],s=this._plotRect;if(this.renderer&&(s=this.renderer.getRect(),s.x+=5,s.y+=5,s.width-=10,s.height-=10),e<s.x+window.scrollX||e>s.x+s.width+window.scrollX||t<s.y+window.scrollY||t>s.y+s.height+window.scrollY)return this._hideToolTip(),void this._unselect();let d="horizontal"===l.orientation;if(s=this._plotRect,-1!==l.type.indexOf("line")||-1!==l.type.indexOf("area")){let g=this._getHorizontalOffset(n,this._selected.series,e,t),u=g.index;if(void 0===u||null===u)return;if(this._selected.item!==u){let e=this._linesRenderInfo[n][a].segments,t=0;for(;u>e[t].lastItemIndex;)if(t++,t>=e.length)return;let i=e[t].pathElement,r=e[t].lastItemIndex;this._unselect(!1),this._select(i,"path",n,a,u,r)}let i=this._getSymbol(this._selected.group,this._selected.series);"none"===i&&(i="circle");let p=this._calcGroupOffsets(n,s),h=p.offsets[this._selected.series][u].to,y=h;-1!==l.type.indexOf("range")&&(y=p.offsets[this._selected.series][u].from);let m=d?e:t;if(t=!isNaN(y)&&r(m-y)<r(m-h)?y:h,isNaN(t))return;if(e=g.value,d){let i=e;e=t,t=i+s.y}else e+=s.x;if(g.polarAxisCoords&&(e=g.x,t=g.y),t=this.renderer._ptrnd(t),e=this.renderer._ptrnd(e),this._pointMarker&&this._pointMarker.element&&(this.renderer.removeElement(this._pointMarker.element),this._pointMarker.element=void 0),isNaN(e)||isNaN(t))return;let c=this._getSeriesColors(n,a,u),f=this._getSerieSettings(n,a),x=o.symbolSizeSelected;isNaN(x)&&(x=o.symbolSize),(isNaN(x)||50<x||0>x)&&(x=l.symbolSize),(isNaN(x)||50<x||0>x)&&(x=8),(this.showToolTips||this.enableCrosshairs)&&(this._pointMarker={type:i,x:e,y:t,gidx:n,sidx:a,iidx:u},this._pointMarker.element=this._drawSymbol(i,e,t,c.fillColorSymbolSelected,f.opacity,c.lineColorSymbolSelected,f.opacity,f.strokeSymbol,f.dashStyle,x),this._installHandlers(this._pointMarker.element,"pointMarker",n,a,u)),this._startTooltipTimer(n,this._selected.series,u)}}_drawSymbol(e,t,i,r,n,s,a,l,o,d){let g=d||6,u=g/2,p,h;switch(e){case"none":return;case"circle":p=this.renderer.circle(t,i,g/2);break;case"square":--g,u=g/2,p=this.renderer.rect(t-u,i-u,g,g);break;case"diamond":h="M "+(t-u)+","+i+" L"+t+","+(i-u)+" L"+(t+u)+","+i+" L"+t+","+(i+u)+" Z",p=this.renderer.path(h);break;case"triangle_up":case"triangle":h="M "+(t-u)+","+(i+u)+" L "+(t+u)+","+(i+u)+" L "+t+","+(i-u)+" Z",p=this.renderer.path(h);break;case"triangle_down":h="M "+(t-u)+","+(i-u)+" L "+t+","+(i+u)+" L "+(t+u)+","+(i-u)+" Z",p=this.renderer.path(h);break;case"triangle_left":h="M "+(t-u)+","+i+" L "+(t+u)+","+(i+u)+" L "+(t+u)+","+(i-u)+" Z",p=this.renderer.path(h);break;case"triangle_right":h="M "+(t-u)+","+(i-u)+" L "+(t-u)+","+(i+u)+" L "+(t+u)+","+i+" Z",p=this.renderer.path(h);break;default:p=this.renderer.circle(t,i,g);}return this.renderer.attr(p,{fill:r,"fill-opacity":n,stroke:s,"stroke-width":l,"stroke-opacity":a,"stroke-dasharray":o||""}),"circle"!==e&&(this.renderer.attr(p,{r:g/2}),"square"!==e&&this.renderer.attr(p,{x:t,y:i})),p}_getSymbol(e,t){let i=["circle","square","diamond","triangle_up","triangle_down","triangle_left","triangle_right"],r=this.seriesGroups[e],n=r.series[t],s;return(void 0!==n.symbolType&&null!==n.symbolType&&(s=n.symbolType),(void 0===s||null===s)&&(s=r.symbolType),"default"===s)?i[t%i.length]:void 0!==s&&null!==s?s:"none"}_startTooltipTimer(e,t,i,r,n,s,a){this._cancelTooltipTimer();let l=this,o=this.toolTipShowDelay;(isNaN(o)||1e4<o||0>o)&&(o=500),(this._ttEl||!0===this.enableCrosshairs&&!1===this.showToolTips)&&(o=0),isNaN(s)||(o=s),clearTimeout(this._tttimerHide),isNaN(r)&&(r=l._mouseX),isNaN(n)&&(n=l._mouseY-3),0===o&&l._showToolTip(r,n,e,t,i),this._tttimer=setTimeout(function(){0!==o&&l._showToolTip(r,n,e,t,i);let s=l.toolTipHideDelay;isNaN(a)||(s=a),isNaN(s)&&(s=4e3),l._tttimerHide=setTimeout(function(){l._hideToolTip(),l._unselect()},s)},o)}_cancelTooltipTimer(){clearTimeout(this._tttimer)}_getGroupGradientType(e){let t=this.seriesGroups[e];if(-1!==t.type.indexOf("area"))return"horizontal"===t.orientation?"horizontalLinearGradient":"verticalLinearGradient";return this._isColumnType(t.type)||-1!==t.type.indexOf("candle")?t.polar?"radialGradient":"horizontal"===t.orientation?"verticalLinearGradient":"horizontalLinearGradient":-1!==t.type.indexOf("scatter")||-1!==t.type.indexOf("bubble")||this._isPieGroup(e)?"radialGradient":void 0}_select(e,t,i,r,n,a){if(this._selected)if(this._selected.item!==n||this._selected.series!==r||this._selected.group!==i)this._unselect();else return;let l=this.seriesGroups[i],o=l.series[r];if(!1===l.enableSelection||!1===o.enableSelection)return;let s=-1!==l.type.indexOf("line")&&-1===l.type.indexOf("area");this._selected={element:e,type:t,group:i,series:r,item:n,iidxBase:a,isLineType:s,linesUnselectMode:o.linesUnselectMode||l.linesUnselectMode};let d=this._getColors(i,r,a||n,this._getGroupGradientType(i)),g=d.fillColorSelected;s&&(g="none");let u=this._getSerieSettings(i,r),p="symbol"===t?d.lineColorSymbolSelected:d.lineColorSelected;g="symbol"===t?d.fillColorSymbolSelected:g;let h="symbol"===t?1:u.stroke;this.renderer.getAttr(e,"fill")===d.fillColorAlt&&(g=d.fillColorAltSelected),this.renderer.attr(e,{stroke:p,fill:g,"stroke-width":h}),(-1!==l.type.indexOf("pie")||-1!==l.type.indexOf("donut"))&&this._applyPieSelect(),this._raiseItemEvent("mouseover",l,o,n)}_applyPieSelect(){var e=this;e._createAnimationGroup("animPieSlice");var t=this._selected;if(t){var i=this.getItemCoord(t.group,t.series,t.item);if(i){var r=this._getRenderInfo(t.group,t.series,t.item);this._enqueueAnimation("animPieSlice",void 0,void 0,300,function(i,r,n){var s=r.coord,a=s.selectedRadiusChange*n,l=e.renderer.pieSlicePath(s.center.x,s.center.y,0===s.innerRadius?0:s.innerRadius+a,s.outerRadius+a,s.fromAngle,s.toAngle,s.centerOffset);e.renderer.attr(r.element.element,{d:l}),e._showPieLabel(t.group,t.series,t.item,void 0,a,r.element.colors.lineColor)},{element:r,coord:i}),e._startAnimation("animPieSlice")}}}_applyPieUnselect(){this._stopAnimations();let e=this._selected;if(e){let t=this.getItemCoord(e.group,e.series,e.item);if(t&&t.center){let i=this.renderer.pieSlicePath(t.center.x,t.center.y,t.innerRadius,t.outerRadius,t.fromAngle,t.toAngle,t.centerOffset);this.renderer.attr(e.element,{d:i}),this._showPieLabel(e.group,e.series,e.item,void 0,0,this._getRenderInfo(e.group,e.series,e.item).colors.lineColor)}}}_unselect(){let e=this;if(e._selected){let t=e._selected.group,i=e._selected.series,r=e._selected.item,n=e._selected.iidxBase,a=e._selected.type,l=e.seriesGroups[t],o=l.series[i],s=-1!==l.type.indexOf("line")&&-1===l.type.indexOf("area"),d=e._getColors(t,i,n||r,e._getGroupGradientType(t)),g=d.fillColor;s&&(g="none");let u=e._getSerieSettings(t,i),p="symbol"===a?d.lineColorSymbol:d.lineColor;g="symbol"===a?d.fillColorSymbol:g,this.renderer.getAttr(e._selected.element,"fill")===d.fillColorAltSelected&&(g=d.fillColorAlt);let h="symbol"===a?1:u.stroke;e.renderer.attr(e._selected.element,{stroke:p,fill:g,"stroke-width":h}),(-1!==l.type.indexOf("pie")||-1!==l.type.indexOf("donut"))&&this._applyPieUnselect(),e._selected=void 0,isNaN(r)||e._raiseItemEvent("mouseout",l,o,r)}e._pointMarker&&(e._pointMarker.element&&(e.renderer.removeElement(e._pointMarker.element),e._pointMarker.element=void 0),e._pointMarker=void 0,e._hideCrosshairs())}_raiseItemEvent(e,t,i,r){let n=i[e]||t[e],s=0;for(;s<this.seriesGroups.length&&!(this.seriesGroups[s]===t);s++);if(s!==this.seriesGroups.length){let a={event:e,seriesGroup:t,serie:i,elementIndex:r,elementValue:this._getDataValue(r,i.dataField,s)};n&&"function"==typeof n&&n(a),this.$.fireEvent(e,a)}}_calcInterval(e,t,i){var r=Math.abs;let n=r(t-e),s=n/i,a=.1,l=[1,2,3,4,5,10,15,20,25,50,100];1>s&&(l=[.5,.25,.125,.1],a=10);let o=0;do{o=0,1<=s?a*=10:a/=10;for(let e=1;e<l.length&&r(l[o]*a-s)>r(l[e]*a-s);e++)o=e}while(o==l.length-1);return l[o]*a}_renderDataClone(){if(this._renderData&&!this._isToggleRefresh){let e=this._elementRenderInfo=[];if(!this._isSelectorRefresh)for(let t=0;t<this._renderData.length;t++){for(;e.length<=t;)e.push({});let i=e[t],r=this._renderData[t];if(!r.offsets)continue;if(r.valueAxis)for(let e in i.valueAxis={itemOffsets:{}},r.valueAxis.itemOffsets)i.valueAxis.itemOffsets[e]=r.valueAxis.itemOffsets[e];if(r.xAxis)for(let e in i.xAxis={itemOffsets:{}},r.xAxis.itemOffsets)i.xAxis.itemOffsets[e]=r.xAxis.itemOffsets[e];i.series=[];let n=i.series,a=this._isPieGroup(t);for(let e=0;e<r.offsets.length;e++){n.push({});for(let t=0;t<r.offsets[e].length;t++)if(!a)n[e][r.xoffsets.xvalues[t]]={value:r.offsets[e][t].value,valueRadius:r.offsets[e][t].valueRadius,xoffset:r.xoffsets.data[t],from:r.offsets[e][t].from,to:r.offsets[e][t].to};else{let i=r.offsets[e][t];n[e][i.displayValue]={value:i.value,x:i.x,y:i.y,fromAngle:i.fromAngle,toAngle:i.toAngle}}}}}}getPolarDataPointOffset(e,t,i){let r=this._renderData[i];if(!r)return{x:NaN,y:NaN};let n=this.getValueAxisDataPointOffset(t,i),s=this.getXAxisDataPointOffset(e,i),a=this._toPolarCoord(r.polarCoords,r.xAxis.rect,s,n);return{x:a.x,y:a.y}}_getDataPointOffsetDiff(e,t,i,r,n,s,a){let l=this._getDataPointOffset(e,i,r,n,s,a),o=this._getDataPointOffset(t,i,r,n,s,a);return Math.abs(l-o)}_getXAxisRenderData(e){if(e>=this._renderData.length)return;let t=this.seriesGroups[e],r=this._renderData[e].xAxis;if(r){if(void 0===t.xAxis||null===t.xAxis)for(let t=0;t<=e;t++)if(void 0===this.seriesGroups[t].xAxis||null===this.seriesGroups[t].xAxis){r=this._renderData[t].xAxis;break}return r}}getXAxisDataPointOffset(e,t){let i=this.seriesGroups[t];if(isNaN(e))return NaN;const r=this._getXAxisRenderData(t);if(!r)return NaN;let n=r.data.axisStats,s=n.min.valueOf(),a=n.max.valueOf(),l=a-s;if(0===l&&(l=1),e.valueOf()>a||e.valueOf()<s)return NaN;let o=this._getXAxis(t),d="horizontal"===i.orientation?"height":"width",g="horizontal"===i.orientation?"y":"x",u=(e.valueOf()-s)/l,p=r.rect[d]-r.data.padding.left-r.data.padding.right;if(i.polar||i.spider){let e=this._renderData[t].polarCoords;e.isClosedCircle&&(p=r.data.axisSize)}return this._plotRect[g]+r.data.padding.left+p*(o.flip?1-u:u)}getValueAxisDataPointOffset(e,t){let i=this._getValueAxis(t);if(!i)return NaN;let r=this._renderData[t];if(!r)return NaN;let n=!0===i.flip,s=r.logBase,a=r.scale,l=r.gbase,o=r.baseOffset;return this._getDataPointOffset(e,l,s,a,o,n)}_getDataPointOffset(e,t,i,r,n,s){let a;return isNaN(e)&&(e=t),a=isNaN(i)?(e-t)*r:(this._draw.log(e,i)-this._draw.log(t,i))*r,a=s?n+a:n-a,a}_calcGroupOffsets(e,t){var r=Math.abs;let n=this.seriesGroups[e];for(;this._renderData.length<e+1;)this._renderData.push({});if(null!==this._renderData[e]&&void 0!==this._renderData[e].offsets)return this._renderData[e];if(this._isPieGroup(e))return this._calcPieSeriesGroupOffsets(e,t);let i=this._getValueAxis(e);if(!i||!n.series||0===n.series.length)return this._renderData[e];let s=!0===i.flip,a=!0===i.logarithmicScale,l=i.logarithmicScaleBase||10,o=[],d=-1!==n.type.indexOf("stacked"),g=d&&-1!==n.type.indexOf("100"),u=-1!==n.type.indexOf("range"),p=this._isColumnType(n.type),h=-1!==n.type.indexOf("waterfall"),y=this._getDataLen(e),m=n.baselineValue||i.baselineValue||0;g&&(m=0);let c=this._stats.seriesGroups[e];if(!c||!c.isValid)return;let f=c.hasStackValueReversal;if(f&&(m=0),h&&d){if(f)return;m=c.base}m>c.max&&(m=c.max),m<c.min&&(m=c.min);let x=g||a?c.maxRange:c.max-c.min,_=c.min,b=c.max,v=t.height/(a?c.intervals:x),A=0;g?0>_*b?(x/=2,A=-(x+m)*v):A=-m*v:A=-(m-_)*v,s?A=t.y-A:A+=t.y+t.height;let w=[],S=[],k=[],C;a&&(C=this._draw.log(b,l)-this._draw.log(m,l),d&&(C=c.intervals,m=g?0:_),!s&&(A=t.y+C/c.intervals*t.height)),A=this.renderer._ptrnd(A);let I=0>_*b?t.height/2:t.height,M=[],F=[],D=d&&(p||a),T=[];o=Array(n.series.length);for(let i=0;i<n.series.length;i++)o[i]=Array(y);for(let p=0;p<y;p++){!h&&d&&(F=[]);for(let t=0;t<n.series.length;t++){!d&&a&&(M=[]);let i=n.series[t],f=i.dataField,x=i.dataFieldFrom,_=i.dataFieldTo,b=i.radiusDataField||i.sizeDataField;o[t][p]={};let C=this._isSerieVisible(e,t);if(-1!==n.type.indexOf("candle")||-1!==n.type.indexOf("ohlc")){let r=["Open","Close","High","Low"];for(let n in r){let d="dataField"+r[n];i[d]&&(o[t][p][r[n]]=this._getDataPointOffset(this._getDataValueAsNumber(p,i[d],e),m,a?l:NaN,v,A,s))}continue}if(d)for(;F.length<=p;)F.push(0);let O=NaN;u&&(O=this._getDataValueAsNumber(p,x,e),isNaN(O)&&(O=m));let R=NaN;R=u?this._getDataValueAsNumber(p,_,e):this._getDataValueAsNumber(p,f,e);let L=this._getDataValueAsNumber(p,b,e);if(d&&(F[p]+=C?R:0),C||(R=NaN),isNaN(R)||a&&0>=R){o[t][p]={from:void 0,to:void 0};continue}let P;d&&(D?P=R>=m?w:S:R=F[p]);let G=v*(R-m);if(u&&(G=v*(R-O)),d&&D&&(T[p]?G=v*R:(T[p]=!0,G=v*(R-m))),a){for(;M.length<=p;)M.push({p:{value:0,height:0},n:{value:0,height:0}});let e=u||u?O:m,t=R>e?M[p].p:M[p].n;t.value+=R,g?(R=100*(t.value/(c.psums[p]+c.nsums[p])),G=(this._draw.log(R,l)-c.minPow)*v):(G=this._draw.log(t.value,l)-this._draw.log(e,l),G*=v),G-=t.height,t.height+=G}let h=A;if(u){let e=0;e=a?(this._draw.log(O,l)-this._draw.log(m,l))*v:(O-m)*v,h+=s?e:-e}if(d){if(g&&!a){let e=c.psums[p]-c.nsums[p];R>m?(G=c.psums[p]/e*I,0!==c.psums[p]&&(G*=R/c.psums[p])):(G=c.nsums[p]/e*I,0!==c.nsums[p]&&(G*=R/c.nsums[p]))}D&&(isNaN(P[p])&&(P[p]=h),h=P[p])}isNaN(k[p])&&(k[p]=0);let y=k[p];G=r(G);let V=G;if(1<=G){const e=this.renderer._ptrnd(G)-1;G=.5<r(G-e)?Math.round(G):e}if(y+=G-V,d||(y=0),.5<r(y)&&(0<y?(G-=1,y-=1):(G+=1,y+=1)),k[p]=y,t==n.series.length-1&&g){let e=0;for(let i=0;i<t;i++)e+=r(o[i][p].to-o[i][p].from);if(e+=G,e<I)if(.5<G)G=this.renderer._ptrnd(G+I-e);else for(let i=t-1,n;0<=i;){if(n=r(o[i][p].to-o[i][p].from),1<n){o[i][p].from>o[i][p].to&&(o[i][p].from+=I-e);break}i--}}s&&(G*=-1);let E=R<m;u&&(E=O>R);let B=isNaN(O)?R:{from:O,to:R};E?(D&&(P[p]+=G),o[t][p]={from:h,to:h+G,value:B,valueRadius:L}):(D&&(P[p]-=G),o[t][p]={from:h,to:h-G,value:B,valueRadius:L})}}let O=this._renderData[e];return O.baseOffset=A,O.gbase=m,O.logBase=a?l:NaN,O.scale=v,O.offsets=h?this._applyWaterfall(o,y,e,A,m,a?l:NaN,v,s,d):o,O.xoffsets=this._calculateXOffsets(e,t.width),this._renderData[e]}_isPercent(e){return"string"==typeof e&&0<e.length&&e.indexOf("%")===e.length-1}_calcPieSeriesGroupOffsets(e,t){var i=this,r=this._getDataLen(e),n=this.seriesGroups[e],a=this._renderData[e]={},l=a.offsets=[];for(let a=0;a<n.series.length;a++){var o=n.series[a],s=this._get([o.minAngle,o.startAngle]);(isNaN(s)||0>s||360<s)&&(s=0);var d=this._get([o.maxAngle,o.endAngle]);(isNaN(d)||0>d||360<d)&&(d=360);var g=d-s,u=o.initialAngle||0;u<s&&(u=s),u>d&&(u=d);var p=o.centerOffset||0,h=this._draw.getNum([o.offsetX,n.offsetX,t.width/2]),m=this._draw.getNum([o.offsetY,n.offsetY,t.height/2]),c=Math.min(t.width,t.height)/2,f=u,_=o.radius;i._isPercent(_)&&(_=parseFloat(_)/100*c),isNaN(_)&&(_=.4*c);var b=o.innerRadius;i._isPercent(b)&&(b=parseFloat(b)/100*c),(isNaN(b)||b>=_)&&(b=0);var v=o.selectedRadiusChange;i._isPercent(v)&&(v=parseFloat(v)/100*(_-b)),isNaN(v)&&(v=.1*(_-b)),l.push([]);var A=0,w=0;for(let t=0;t<r;t++){var S=this._getDataValueAsNumber(t,o.dataField,e);isNaN(S)||!this._isSerieVisible(e,a,t)&&!0!==o.hiddenPointsDisplay||(0<S?A+=S:w+=S)}var k=A-w;0==k&&(k=1);for(let n=0;n<r;n++){var S=this._getDataValueAsNumber(n,o.dataField,e);if(isNaN(S)){l[a].push({});continue}var C=o.displayText||o.displayField,I=this._getDataValue(n,C,e);(I===void 0||null===I)&&(I=n);var M=0,F=this._isSerieVisible(e,a,n);(F||!0===o.hiddenPointsDisplay)&&(M=Math.abs(S)/k*g);var D=t.x+h,x=t.y+m,y=p;"function"==typeof p&&(y=p({seriesIndex:a,seriesGroupIndex:e,itemIndex:n})),isNaN(y)&&(y=0);var T={key:e+"_"+a+"_"+n,value:S,displayValue:I,x:D,y:x,fromAngle:f,toAngle:f+M,centerOffset:y,innerRadius:b,outerRadius:_,selectedRadiusChange:v,visible:F};l[a].push(T),f+=M}}return a}_isPointSeriesOnly(){for(let e=0,t;e<this.seriesGroups.length;e++)if(t=this.seriesGroups[e],-1===t.type.indexOf("line")&&-1===t.type.indexOf("area")&&-1===t.type.indexOf("scatter")&&-1===t.type.indexOf("bubble"))return!1;return!0}_hasColumnSeries(){let e=["column","ohlc","candlestick","waterfall"];for(let t=0,i;t<this.seriesGroups.length;t++)for(let r in i=this.seriesGroups[t],e)if(-1!==i.type.indexOf(e[r]))return!0;return!1}_alignValuesWithTicks(e){let t=this._isPointSeriesOnly(),i=this.seriesGroups[e],r=this._getXAxis(e),n=void 0===r.valuesOnTicks||null===r.valuesOnTicks?t:!1!==r.valuesOnTicks;return r.logarithmicScale&&(n=!0),void 0===e||null===e?n:void 0===i.valuesOnTicks||null===i.valuesOnTicks?n:i.valuesOnTicks}_getYearsDiff(e,t){return t.getFullYear()-e.getFullYear()}_getMonthsDiff(e,t){return 12*(t.getFullYear()-e.getFullYear())+t.getMonth()-e.getMonth()}_getDateDiff(e,t,i,r){let n=0;switch("year"!==i&&"month"!==i&&(n=t.valueOf()-e.valueOf()),i){case"year":n=this._getYearsDiff(e,t);break;case"month":n=this._getMonthsDiff(e,t);break;case"day":n/=86400000;break;case"hour":n/=3600000;break;case"minute":n/=60000;break;case"second":n/=1e3;break;case"millisecond":}return"year"!==i&&"month"!==i&&!1!==r&&(n=this.renderer._rnd(n,1,!0)),n}_getBestDTUnit(e,t,r,n,s){let a="day",l=t.valueOf()-e.valueOf();a=1e3>l?"second":36e5>l?"minute":864e5>l?"hour":2592e6>l?"day":31104e6>l?"month":"year";let o=[{key:"year",cnt:l/31536000000},{key:"month",cnt:l/2592000000},{key:"day",cnt:l/86400000},{key:"hour",cnt:l/3600000},{key:"minute",cnt:l/60000},{key:"second",cnt:l/1e3},{key:"millisecond",cnt:l}],d=-1;for(let i=0;i<o.length;i++)if(o[i].key===a){d=i;break}let g=-1,u=-1;for(;d<o.length&&!(o[d].cnt/100>n);d++){let i=this._estAxisInterval(e,t,r,n,o[d].key,s),a=this._getDTIntCnt(e,t,i,o[d].key);(-1===g||g<a)&&(g=a,u=d)}return a=o[u].key,a}_getXAxisStats(e,t,i){var r=Math.pow,n=Math.max;let s=this._getDataLen(e),a="date"===t.type||"time"===t.type;if(a&&!this._autoDateFormats){this._autoDateFormats||(this._autoDateFormats=[]);let e=this._testXAxisDateFormat();e&&this._autoDateFormats.push(e)}let l=a?this._castAsDate(t.minValue,t.dateFormat):this._castAsNumber(t.minValue),o=a?this._castAsDate(t.maxValue,t.dateFormat):this._castAsNumber(t.maxValue);if(this._selectorRange&&this._selectorRange[e]){let i=this._selectorRange[e].min;isNaN(i)||(l=a?this._castAsDate(i,t.dateFormat):this._castAsNumber(i));let r=this._selectorRange[e].max;isNaN(r)||(o=a?this._castAsDate(r,t.dateFormat):this._castAsNumber(r))}let d=l,g=o,u=void 0===t.type||null===t.type||"auto"===t.type,p=u||"basic"===t.type,h=0,y=0,m,c;for(let r=0,n;r<s&&t.dataField;r++)n=this._getDataValue(r,t.dataField,e),n=a?this._castAsDate(n,t.dateFormat):this._castAsNumber(n),isNaN(n)||(a?h++:y++,(isNaN(m)||n<m)&&(m=n),(isNaN(c)||n>=c)&&(c=n));u&&(!a&&y===s||a&&h===s)&&(p=!1),p&&(m=0,c=n(0,s-1)),isNaN(d)&&(d=m),isNaN(g)&&(g=c),a?(!this._isDate(d)&&(d=this._isDate(g)?g:new Date),!this._isDate(g)&&(g=this._isDate(d)?d:new Date)):(isNaN(d)&&(d=0),isNaN(g)&&(g=p?n(0,s-1):d)),(void 0===m||null===m)&&(m=d),(void 0===c||null===c)&&(c=g);let f=t.rangeSelector&&t.rangeSelector.visible;if(f){let e=f.minValue||d;e&&a&&(e=this._castAsDate(e,f.dateFormat||t.dateFormat));let i=f.maxValue||g;i&&a&&(i=this._castAsDate(i,f.dateFormat||t.rangeSelector)),d<e&&(d=e),g<e&&(g=i),d>i&&(d=e),g>i&&(g=i)}let x,_;a&&(x=t.baseUnit,!x&&(x=this._getBestDTUnit(d,g,e,i)),_="hour"===x||"minute"===x||"second"===x||"millisecond"===x);let b=!0===t.logarithmicScale,v=t.logarithmicScaleBase;(isNaN(v)||1>=v)&&(v=10);let A=t.unitInterval;b?A=1:(isNaN(A)||0>=A)&&(A=this._estAxisInterval(d,g,e,i,x));let w={min:d,max:g},S=this.seriesGroups[e],k,C;return b?(!d&&(d=1,g&&d>g&&(d=g)),!g&&(g=d),w={min:d,max:g},k=this.renderer._rnd(this._draw.log(d,v),1,!1),C=this.renderer._rnd(this._draw.log(g,v),1,!0),g=r(v,C),d=r(v,k)):!a&&(S.polar||S.spider)&&(d=this.renderer._rnd(d,A,!1),g=this.renderer._rnd(g,A,!0)),{min:d,max:g,logAxis:{enabled:b,base:v,minPow:k,maxPow:C},dsRange:{min:m,max:c},filterRange:w,useIndeces:p,isDateTime:a,isTimeUnit:_,dateTimeUnit:x,interval:A}}_getDefaultDTFormatFn(e){let t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],i;return i="year"===e||"month"===e||"day"===e?function(e){return e.getDate()+"-"+t[e.getMonth()]+"-"+e.getFullYear()}:function(e){return e.getDate()+"-"+t[e.getMonth()]+"-"+e.getFullYear()+"<br>"+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()},i}_getDTIntCnt(e,t,i,r){let n=0,s=new Date(e),a=new Date(t);if(a=a.valueOf(),0>=i)return 1;for(;s.valueOf()<a;)"millisecond"===r?s=new Date(s.valueOf()+i):"second"===r?s=new Date(s.valueOf()+1e3*i):"minute"===r?s=new Date(s.valueOf()+6e4*i):"hour"===r?s=new Date(s.valueOf()+24*(6e4*i)):"day"===r?s.setDate(s.getDate()+i):"month"===r?s.setMonth(s.getMonth()+i):"year"==r&&s.setFullYear(s.getFullYear()+i),n++;return n}_estAxisInterval(e,t,r,n,s,a){if(isNaN(e)||isNaN(t))return NaN;let l=[1,2,5,10,15,20,50,100,200,500],o=0,d=n/(!isNaN(a)&&0<a?a:50);if(this._renderData&&this._renderData.length>r&&this._renderData[r].xAxis&&!isNaN(this._renderData[r].xAxis.avgWidth)){let e=Math.max(1,this._renderData[r].xAxis.avgWidth);0!==e&&isNaN(a)&&(d=.9*n/e)}if(1>=d)return Math.abs(t-e);let g=0,u;for(;u=o>=l.length?Math.pow(10,3+o-l.length):l[o],g=this._isDate(e)&&this._isDate(t)?this._getDTIntCnt(e,t,u,s):(t-e)/u,!(g<=d);)o++;let p=this.seriesGroups[r];return(p.spider||p.polar)&&2*u>t-e&&(u=t-e),u}_getPaddingSize(e,t,i,r,n,s,a){var l=Math.max,o=e.min,d=e.max;e.logAxis.enabled&&(o=e.logAxis.minPow,d=e.logAxis.maxPow);var g=e.interval,u=e.dateTimeUnit;if(n){var p=r/l(1,d-o+g)*g;return s?{left:0,right:p}:i?{left:0,right:0}:{left:p/2,right:p/2}}if(i&&!a)return{left:0,right:0};if(this._isDate(o)&&this._isDate(d)){var h=this._getDTIntCnt(o,d,Math.min(g,d-o),u),y=r/l(2,h);return{left:y/2,right:y/2}}var h=l(1,d-o);if(1===h){const e=r/4;return{left:e,right:e}}var y=r/(h+1);return{left:y/2,right:y/2}}_calculateXOffsets(e,t){var i=Math.abs,r=this.seriesGroups[e],n=this._getXAxis(e),s=[],a=[],l=this._getDataLen(e),o=this._getXAxisStats(e,n,t),d=o.min,g=o.max,u=o.isDateTime,p=o.isTimeUnit,h=this._hasColumnSeries(),y=r.polar||r.spider,m=this._get([r.startAngle,r.minAngle,0]),c=this._get([r.endAngle,r.maxAngle,360]),f=y&&!(1e-4<i(i(c-m)-360)),_=this._alignValuesWithTicks(e),b=this._getPaddingSize(o,n,_,t,y,f,h),v=g-d,A=o.filterRange;0===v&&(v=1);var w=t-b.left-b.right;y&&_&&!f&&(b.left=b.right=0);var S=-1,k=-1;for(let r=0;r<l;r++){var C=void 0===n.dataField?r:this._getDataValue(r,n.dataField,e);if(o.useIndeces){if(r<A.min||r>A.max){s.push(NaN),a.push(void 0);continue}if(M=b.left+(r-d)/v*w,!0===o.logAxis.enabled){var I=o.logAxis.base;M=this._smartPlot.scale(C,{min:d.valueOf(),max:g.valueOf(),type:"logarithmic",base:I},{min:0,max:w,flip:!1})}s.push(this.renderer._ptrnd(M)),a.push(C),-1==S&&(S=r),(-1==k||k<r)&&(k=r);continue}if(C=u?this._castAsDate(C,n.dateFormat):this._castAsNumber(C),isNaN(C)||C<A.min||C>A.max){s.push(NaN),a.push(void 0);continue}var M=0;if(!0===o.logAxis.enabled){var I=o.logAxis.base;M=this._smartPlot.scale(C,{min:d.valueOf(),max:g.valueOf(),type:"logarithmic",base:I},{min:0,max:w,flip:!1})}else M=!u||u&&p?(C-d)*w/v:(C.valueOf()-d.valueOf())/(g.valueOf()-d.valueOf())*w;M=this.renderer._ptrnd(b.left+M),s.push(M),a.push(C),-1==S&&(S=r),(-1==k||k<r)&&(k=r)}if(!0===n.flip)for(let e=0;e<s.length;e++)isNaN(s[e])||(s[e]=t-s[e]);(p||u)&&(v=this._getDateDiff(d,g,n.baseUnit),v=this.renderer._rnd(v,1,!1));var F=Math.max(1,v),D=w/F;return S==k&&1===F&&(s[S]=b.left+w/2),{axisStats:o,data:s,xvalues:a,first:S,last:k,length:-1==k?0:k-S+1,itemWidth:D,intervalWidth:D*o.interval,rangeLength:v,useIndeces:o.useIndeces,padding:b,axisSize:w}}_getXAxis(e){return void 0===e||null===e||this.seriesGroups.length<=e?this.xAxis:this.seriesGroups[e].xAxis||this.xAxis}_isGreyScale(e,t){let i=this.seriesGroups[e],r=i.series[t];if(!0===r.greyScale)return!0;return!1!==r.greyScale&&(!0===i.greyScale||!1!==i.greyScale&&!0===this.greyScale)}_getSeriesColors(e,t,i){let r=this._getSeriesColorsInternal(e,t,i);if(this._isGreyScale(e,t))for(let e in r)r[e]=this._draw.toGreyScale(r[e]);return r}_getColorFromScheme(e,t,i){let r="#000000",n=this.seriesGroups[e],s=n.series[t];if(this._isPieGroup(e)){let a=this._getDataLen(e);r=this._getItemColorFromScheme(s.colorScheme||n.colorScheme||this.colorScheme,t*a+i,e,t)}else{let s=0;for(let r=0;r<=e;r++)for(let i=0;i<this.seriesGroups[r].series.length&&(r!==e||parseInt(i)!==t);i++)s++;let a=this.colorScheme;if(n.colorScheme&&(a=n.colorScheme),(void 0===a||null===a||""===a)&&(a=this.colorSchemes[0].name),!a)return r;for(let e=0,t;e<this.colorSchemes.length;e++)if(t=this.colorSchemes[e],t.name===a){for(;s>t.colors.length;)s-=t.colors.length,++e>=this.colorSchemes.length&&(e=0),t=this.colorSchemes[e];r=t.colors[s%t.colors.length]}}return r}_createColorsCache(){this._colorsCache={get:function(e){if(this._store[e])return this._store[e]},set:function(e,t){1e4>this._size&&(this._store[e]=t,this._size++)},clear:function(){this._store={},this._size=0},_size:0,_store:{}}}_getSeriesColorsInternal(e,t,i){let r=this.seriesGroups[e],n=r.series[t];"function"===!typeof n.colorFunction&&"pie"!==r.type&&"donut"!==r.type&&(i=NaN);let s=e+"_"+t+"_"+(isNaN(i)?"NaN":i);if(this._colorsCache.get(s))return this._colorsCache.get(s);let a={lineColor:"#222222",lineColorSelected:"#151515",lineColorSymbol:"#222222",lineColorSymbolSelected:"#151515",fillColor:"#222222",fillColorSelected:"#333333",fillColorSymbol:"#222222",fillColorSymbolSelected:"#333333",fillColorAlt:"#222222",fillColorAltSelected:"#333333"},l;if("function"==typeof n.colorFunction){let t=isNaN(i)?NaN:this._getDataValue(i,n.dataField,e);if(-1!==r.type.indexOf("range")&&!isNaN(i)){let r=this._getDataValue(i,n.dataFieldFrom,e),s=this._getDataValue(i,n.dataFieldTo,e);t={from:r,to:s}}if(l=n.colorFunction(t,i,n,r),"object"==typeof l)for(let e in l)a[e]=l[e];else a.fillColor=l}else{for(let e in a)n[e]&&(a[e]=n[e]);n.fillColor||n.color?n.fillColor=n.fillColor||n.color:a.fillColor=this._getColorFromScheme(e,t,i)}let o={fillColor:{baseColor:"fillColor",adjust:1},fillColorSelected:{baseColor:"fillColor",adjust:1.1},fillColorSymbol:{baseColor:"fillColor",adjust:1},fillColorSymbolSelected:{baseColor:"fillColorSymbol",adjust:2},fillColorAlt:{baseColor:"fillColor",adjust:4},fillColorAltSelected:{baseColor:"fillColor",adjust:3},lineColor:{baseColor:"fillColor",adjust:.95},lineColorSelected:{baseColor:"lineColor",adjust:.95},lineColorSymbol:{baseColor:"lineColor",adjust:1},lineColorSymbolSelected:{baseColor:"lineColorSelected",adjust:1}};for(let r in a)("object"!=typeof l||!l[r])&&n[r]&&(a[r]=n[r]);for(let r in a)("object"!=typeof l||!l[r])&&(n[r]||(a[r]=this.renderer.adjustColor(a[o[r].baseColor],o[r].adjust)));return this._colorsCache.set(s,a),a}_getItemColorFromScheme(e,t,r,n){let s;for((void 0===e||""===e)&&(e=this.colorSchemes[0].name),s=0;s<this.colorSchemes.length&&!(e===this.colorSchemes[s].name);s++);for(let i=0;i<=t;){s===this.colorSchemes.length&&(s=0);let e=this.colorSchemes[s].colors.length;if(i+e<=t)i+=e,s++;else{let e=this.colorSchemes[s].colors[t-i];return this._isGreyScale(r,n)&&0===e.indexOf("#")&&(e=this._draw.toGreyScale(e)),e}}}getColorScheme(e){for(let t=0;t<this.colorSchemes.length;t++)if(this.colorSchemes[t].name===e)return this.colorSchemes[t].colors}addColorScheme(e,t){for(let r=0;r<this.colorSchemes.length;r++)if(this.colorSchemes[r].name===e)return void(this.colorSchemes[r].colors=t);this.colorSchemes.push({name:e,colors:t})}removeColorScheme(e){for(let t=0;t<this.colorSchemes.length;t++)if(this.colorSchemes[t].name===e){this.colorSchemes.splice(t,1);break}}_formatValue(e,t,i,r,n,s){if(e===void 0||null===e)return"";if(this._isObject(e)&&!this._isDate(e)&&!i)return"";if(i){if("function"===!typeof i)return e.toString();try{return i(e,s,n,r)}catch(t){return t.message}}return this._isNumber(e)?this._formatNumber(e,t):this._isDate(e)?this._formatDate(e,t):t?(t.prefix||"")+e.toString()+(t.sufix||""):e.toString()}_getFormattedValue(e,t,r,i,n,a){let l=this.seriesGroups[e],o=l.series[t],s="",d=i,g=n;o.labels&&(d=d||this._getFormatSettings(o.labels),g=g||o.labels.formatFunction),d||g||(d=this._getFormatSettings(o),g=o.formatFunction,!d&&!g&&(d=this._getFormatSettings(l),g=l.formatFunction));let u={},p=0;for(let s in o)0===s.indexOf("dataField")&&(u[s.substring(9).toLowerCase()]=this._getDataValue(r,o[s],e),p++);if(0==p&&(u=this._getDataValue(r,void 0,e)),-1!==l.type.indexOf("waterfall")&&this._isSummary(e,r)&&(u=this._renderData[e].offsets[t][r].value,p=0),g&&"function"==typeof g)try{return g(1==p?u[""]:u,r,o,l)}catch(t){return t.message}if(1==p&&this._isPieGroup(e))return this._formatValue(u[""],d,g,e,t,r);if(0<p){let n=0;for(let i in u){0<n&&""!==s&&(s+="<br>");let l="dataField"+(0<i.length?i.substring(0,1).toUpperCase()+i.substring(1):""),p="displayText"+(0<i.length?i.substring(0,1).toUpperCase()+i.substring(1):""),h=o[p]||o[l],y=u[i];if(void 0!==y)y=this._formatValue(y,d,g,e,t,r);else continue;s+=!0===a?y:h+": "+y,n++}}else void 0!==u&&null!==u&&(s=this._formatValue(u,d,g,e,t,r));return s||""}_isNumberAsString(e){if("string"!=typeof e)return!1;e=e.trim();for(let t=0,i;t<e.length;t++)if(i=e.charAt(t),!("0"<=i&&"9">=i||","===i||"."===i)&&("-"!==i||0!=t)&&("("!==i||0!=t)&&(")"!==i||t!=e.length-1))return!1;return!0}_castAsDate(e,t){if(e instanceof Date&&!isNaN(e))return e;if("string"==typeof e){let r=new Date(e);if(this._isDate(r))return-1===e.indexOf(":")&&r.setHours(0,0,0,0),r;try{if(t&&(r=Smart.Utilities.DateTime.parseDateString(e,void 0,t).toDate(),this._isDate(r)))return r;if(this._autoDateFormats)for(let t=0;t<this._autoDateFormats.length;t++)if(r=Smart.Utilities.DateTime.parseDateString(e,void 0,this._autoDateFormats[t]).toDate(),this._isDate(r))return r;let i=this._detectDateFormat(e);if(i&&(r=Smart.Utilities.DateTime.parseDateString(e,void 0,i).toDate(),this._isDate(r)))return this._autoDateFormats.push(i),r}catch(e){}}}_castAsNumber(e){if(e instanceof Date&&!isNaN(e))return e.valueOf();if("string"==typeof e)if(this._isNumber(e))e=parseFloat(e);else if(!/[a-zA-Z]/.test(e)){let t=new Date(e);void 0!==t&&null!==t&&(e=t.valueOf())}return isNaN(e)?void 0:e}_isNumber(e){return"string"==typeof e&&this._isNumberAsString(e)&&(e=parseFloat(e)),"number"==typeof e&&isFinite(e)}_isDate(e){return e instanceof Date&&!isNaN(e.getDate())}_isBoolean(e){return"boolean"==typeof e}_isObject(e){return e&&("object"==typeof e||"function"==typeof e)||!1}_formatDate(e,t){let i=e.toString();return t&&(t.dateFormat&&(i=new Smart.Utilities.DateTime(e).toString(t.dateFormat)),i=(t.prefix||"")+i+(t.sufix||"")),i}_formatNumber(e,t){if(!this._isNumber(e))return e;t=t||{};const i=this;let r=i.localization.decimalSeparator,n=i.localization.thousandsSeparator;t.decimalSeparator&&(r=t.decimalSeparator),t.thousandsSeparator&&(n=t.thousandsSeparator);let s=t.prefix||"",a=t.sufix||"",l=t.decimalPlaces;isNaN(l)&&(l=this._getDecimalPlaces([e],void 0,3));let o=t.negativeWithBrackets||!1,d=0>e;d&&o&&(e*=-1);let g=e.toString(),u=Math.pow(10,l),p;if(g=(Math.round(e*u)/u).toString(),isNaN(g)&&(g=""),p=g.lastIndexOf("."),0<l)for(0>p?(g+=r,p=g.length-1):"."!==r&&(g=g.replace(".",r));g.length-1-p<l;)g+="0";p=g.lastIndexOf(r),p=-1<p?p:g.length;let h=g.substring(p),y=0;for(let r=p;0<r;r--,y++)0==y%3&&r!==p&&(!d||1<r||d&&o)&&(h=n+h),h=g.charAt(r-1)+h;return g=h,d&&o&&(g="("+g+")"),s+g+a}_calculateControlPoints(e,t){var i=Math.sqrt,r=Math.pow;let n=e[t],s=e[t+1],a=e[t+2],l=e[t+3],o=e[t+4],d=e[t+5],g=.4,u=i(r(a-n,2)+r(l-s,2)),p=i(r(o-a,2)+r(d-l,2)),h=u+p;0===h&&(h=1);let y=g*u/h,m=g-y;return[a+y*(n-o),l+y*(s-d),a-m*(n-o),l-m*(s-d)]}_getBezierPoints(e){var t=Math.abs;let r="",n=[],s=[],a=e.split(" ");for(let t=0,i;t<a.length;t++)i=a[t].split(","),n.push(parseFloat(i[0])),n.push(parseFloat(i[1])),isNaN(n[n.length-1])||isNaN(n[n.length-2]);let l=n.length;if(1>=l)return"";if(2===l)return r="M"+this.renderer._ptrnd(n[0])+","+this.renderer._ptrnd(n[1])+" L"+this.renderer._ptrnd(n[0]+1)+","+this.renderer._ptrnd(n[1]+1)+" ",r;for(let t=0;t<l-4;t+=2)s=s.concat(this._calculateControlPoints(n,t));for(let t=2;t<l-5;t+=2)r+=" C"+this.renderer._ptrnd(s[2*t-2])+","+this.renderer._ptrnd(s[2*t-1])+" "+this.renderer._ptrnd(s[2*t])+","+this.renderer._ptrnd(s[2*t+1])+" "+this.renderer._ptrnd(n[t+2])+","+this.renderer._ptrnd(n[t+3])+" ";return r=4>=l||3>t(n[0]-n[2])||3>t(n[1]-n[3])?"M"+this.renderer._ptrnd(n[0])+","+this.renderer._ptrnd(n[1])+" L"+this.renderer._ptrnd(n[2])+","+this.renderer._ptrnd(n[3])+" "+r:"M"+this.renderer._ptrnd(n[0])+","+this.renderer._ptrnd(n[1])+" Q"+this.renderer._ptrnd(s[0])+","+this.renderer._ptrnd(s[1])+" "+this.renderer._ptrnd(n[2])+","+this.renderer._ptrnd(n[3])+" "+r,4<=l&&(3>t(n[l-2]-n[l-4])||3>t(n[l-1]-n[l-3]))?r+=" L"+this.renderer._ptrnd(n[l-2])+","+this.renderer._ptrnd(n[l-1])+" ":5<=l&&(r+=" Q"+this.renderer._ptrnd(s[2*l-10])+","+this.renderer._ptrnd(s[2*l-9])+" "+this.renderer._ptrnd(n[l-2])+","+this.renderer._ptrnd(n[l-1])+" "),r}_createAnimationGroup(e){this._animGroups||(this._animGroups={}),this._animGroups[e]={animations:[],startTick:NaN}}_startAnimation(e){let t=new Date,i=t.getTime();this._animGroups[e].startTick=i,this._runAnimation(),this._enableAnimTimer()}_enqueueAnimation(e,t,i,r,n,s,a){0>r&&(r=0),a===void 0&&(a="easeInOutSine"),this._animGroups[e].animations.push({key:t,properties:i,duration:r,fn:n,context:s,easing:a})}_stopAnimations(){clearTimeout(this._animtimer),this._animtimer=void 0,this._animGroups=void 0}_enableAnimTimer(){if(!this._animtimer){let e=this;this._animtimer=setTimeout(function(){e._runAnimation()},this._animTickInt)}}_runAnimation(){if(this._animGroups){let e=new Date,t=e.getTime(),i={};for(let e in this._animGroups){let r=this._animGroups[e].animations,n=this._animGroups[e].startTick,s=0;for(let e=0;e<r.length;e++){let i=r[e],a=t-n;i.duration>s&&(s=i.duration);let l=0<i.duration?a/i.duration:1,o=l;if(i.easing&&0!==i.duration&&!1!==i.duration&&(o=Smart.Utilities.Animation.Easings[i.easing](a,0,1,i.duration)),1<l&&(l=1,o=1),i.fn){i.fn(i.key,i.context,o);continue}let d={};for(let e=0;e<i.properties.length;e++){let t=i.properties[e],r=0;r=1==l?t.to:o*(t.to-t.from)+t.from,d[t.key]=r}this.renderer.attr(i.key,d)}n+s>t&&(i[e]={startTick:n,animations:r})}this._animGroups=i,this.renderer instanceof Smart.Utilities.HTML5Renderer&&this.renderer.refresh()}this._animtimer=null,0<Object.values(this._animGroups).length&&this._enableAnimTimer()}_fixCoords(e,t){var i="horizontal"===this.seriesGroups[t].orientation;if(!i)return e;var r=e.x;e.x=e.y,e.y=r+this._plotRect.y-this._plotRect.x;var r=e.width;return e.width=e.height,e.height=r,e}getItemCoord(e,t,i){var r=Math.sin,n=Math.cos,a=Math.abs,l=Math.PI,o=Math.min,d=this;if(d._isPieGroup(e)&&(!d._isSerieVisible(e,t,i)||!d._renderData||d._renderData.length<=e))return{x:NaN,y:NaN};if(!d._isSerieVisible(e,t)||!d._renderData||d._renderData.length<=e)return{x:NaN,y:NaN};var u=d.seriesGroups[e],g=u.series[t],s=d._getItemCoord(e,t,i);if(d._isPieGroup(e)){if(isNaN(s.x)||isNaN(s.y)||isNaN(s.fromAngle)||isNaN(s.toAngle))return{x:NaN,y:NaN};var p=this._plotRect,h=s.fromAngle*(l/180),m=s.toAngle*(l/180);const e=p.x+s.center.x+n(h)*s.outerRadius,t=p.x+s.center.x+n(m)*s.outerRadius,i=p.y+s.center.y-r(h)*s.outerRadius,d=p.y+s.center.y-r(m)*s.outerRadius;var c=o(e,t),f=a(t-e);let g=o(i,d);var x=a(d-i);return s={x:c,y:g,width:f,height:x,center:s.center,centerOffset:s.centerOffset,innerRadius:s.innerRadius,outerRadius:s.outerRadius,selectedRadiusChange:s.selectedRadiusChange,fromAngle:s.fromAngle,toAngle:s.toAngle},s}if(-1!==u.type.indexOf("column")||-1!==u.type.indexOf("waterfall")){var _=this._getColumnSerieWidthAndOffset(e,t);s.height=a(s.y.to-s.y.from),s.y=o(s.y.to,s.y.from),s.x+=_.offset,s.width=_.width}else if(-1!==u.type.indexOf("ohlc")||-1!==u.type.indexOf("candlestick")){var _=this._getColumnSerieWidthAndOffset(e,t);let i=s.y;var b=o(i.Open,i.Close,i.Low,i.High),v=Math.max(i.Open,i.Close,i.Low,i.High);s.height=a(v-b),s.y=b,s.x+=_.offset,s.width=_.width}else if(-1!==u.type.indexOf("line")||-1!==u.type.indexOf("area"))s.width=s.height=0,s.y=s.y.to;else if(-1!==u.type.indexOf("bubble")||-1!==u.type.indexOf("scatter")){s.center={x:s.x,y:s.y.to};var y=s.y.radius;"circle"!==g.symbolType&&void 0!==g.symbolType&&null!==g.symbolType&&(y/=2),s.y=s.y.to,s.radius=y,s.width=2*y,s.height=2*y}if(s=this._fixCoords(s,e),u.polar||u.spider){var A=this._toPolarCoord(this._renderData[e].polarCoords,this._plotRect,s.x,s.y);s.x=A.x,s.y=A.y,s.center&&(s.center=this._toPolarCoord(this._renderData[e].polarCoords,this._plotRect,s.center.x,s.center.y))}return(-1!==u.type.indexOf("bubble")||-1!==u.type.indexOf("scatter"))&&(s.x-=y,s.y-=y),s}_getItemCoord(e,t,i){let r=this.seriesGroups[e],n,s;if(!r||!this._renderData)return{x:NaN,y:NaN};let a=r.series[t];if(!a)return{x:NaN,y:NaN};let l=this._plotRect;if(this._isPieGroup(e)){let r=this._renderData[e].offsets[t][i];if(!r)return{x:NaN,y:NaN};let a=(r.fromAngle+r.toAngle)/2*(Math.PI/180);return n=l.x+r.x+Math.cos(a)*r.outerRadius,s=l.y+r.y-Math.sin(a)*r.outerRadius,{x:n,y:s,center:{x:r.x,y:r.y},centerOffset:r.centerOffset,innerRadius:r.innerRadius,outerRadius:r.outerRadius,selectedRadiusChange:r.selectedRadiusChange,fromAngle:r.fromAngle,toAngle:r.toAngle}}if(n=l.x+this._renderData[e].xoffsets.data[i],s=this._renderData[e].offsets[t][i],isNaN(n)||!s)return{x:NaN,y:NaN};let o={};for(let r in s)o[r]=s[r];return{x:n,y:o}}getXAxisValue(e,t){var i=Math.PI,r=this.seriesGroups[t];if(r){var n=this._getXAxis(t),s=this._plotRect,a=0,l=NaN,o=this._renderData[0].xoffsets.axisStats,d=0,g=0;if(r.polar||r.spider){if(isNaN(e.x)||isNaN(e.y))return NaN;var u=this._getPolarAxisCoords(t,s),p=this.renderer._ptdist(e.x,e.y,u.x,u.y);if(p>u.r)return NaN;var h=Math.atan2(u.y-e.y,e.x-u.x);h=i/2-h,0>h&&(h=2*i+h),l=h*u.r;var y=u.startAngle+i/2,m=u.endAngle+i/2;d=y*u.r,g=m*u.r,a=(m-y)*u.r;var c=this._getPaddingSize(o,n,n.valuesOnTicks,a,!0,u.isClosedCircle,this._hasColumnSeries());u.isClosedCircle?(a-=c.left+c.right,g-=c.left+c.right):!n.valuesOnTicks&&(d+=c.left,g-=c.right)}else{if("horizontal"!==r.orientation){if(e<s.x||e>s.x+s.width)return NaN;l=e-s.x,a=s.width}else{if(e<s.y||e>s.y+s.height)return NaN;l=e-s.y,a=s.height}if(this._renderData[t]&&this._renderData[t].xoffsets){var c=this._renderData[t].xoffsets.padding;a-=c.left+c.right,l-=c.left}g=a}var f=this._smartPlot.scale(l,{min:d,max:g},{min:o.min.valueOf(),max:o.max.valueOf(),type:o.logAxis.enabled?"logarithmic":"linear",base:o.logAxis.base,flip:n.flip});return f}}getValueAxisValue(e,t){let i=this.seriesGroups[t];if(!i)return;let r=this._getValueAxis(t),n=this._plotRect,s=0,a=NaN;if(i.polar||i.spider){if(isNaN(e.x)||isNaN(e.y))return NaN;let i=this._getPolarAxisCoords(t,n);a=this.renderer._ptdist(e.x,e.y,i.x,i.y),s=i.r,a=s-a}else if("horizontal"===i.orientation){if(e<n.x||e>n.x+n.width)return NaN;a=e-n.x,s=n.width}else{if(e<n.y||e>n.y+n.height)return NaN;a=e-n.y,s=n.height}let l=this._stats.seriesGroups[t],o=this._smartPlot.scale(a,{min:0,max:s},{min:l.min.valueOf(),max:l.max.valueOf(),type:l.logarithmic?"logarithmic":"linear",base:l.logBase,flip:!r.flip});return o}_detectDateFormat(e,t){let i={en_US_d:"M/d/yyyy",en_US_D:"dddd, MMMM dd, yyyy",en_US_t:"h:mm tt",en_US_T:"h:mm:ss tt",en_US_f:"dddd, MMMM dd, yyyy h:mm tt",en_US_F:"dddd, MMMM dd, yyyy h:mm:ss tt",en_US_M:"MMMM dd",en_US_Y:"yyyy MMMM",en_US_S:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",en_CA_d:"dd/MM/yyyy",en_CA_D:"MMMM-dd-yy",en_CA_f:"MMMM-dd-yy h:mm tt",en_CA_F:"MMMM-dd-yy h:mm:ss tt",ISO:"yyyy-MM-dd hh:mm:ss",ISO2:"yyyy-MM-dd HH:mm:ss",d1:"dd.MM.yyyy",d2:"dd-MM-yyyy",zone1:"yyyy-MM-ddTHH:mm:ss-HH:mm",zone2:"yyyy-MM-ddTHH:mm:ss+HH:mm",custom:"yyyy-MM-ddTHH:mm:ss.fff",custom2:"yyyy-MM-dd HH:mm:ss.fff",de_DE_d:"dd.MM.yyyy",de_DE_D:"dddd, d. MMMM yyyy",de_DE_t:"HH:mm",de_DE_T:"HH:mm:ss",de_DE_f:"dddd, d. MMMM yyyy HH:mm",de_DE_F:"dddd, d. MMMM yyyy HH:mm:ss",de_DE_M:"dd MMMM",de_DE_Y:"MMMM yyyy",fr_FR_d:"dd/MM/yyyy",fr_FR_D:"dddd d MMMM yyyy",fr_FR_t:"HH:mm",fr_FR_T:"HH:mm:ss",fr_FR_f:"dddd d MMMM yyyy HH:mm",fr_FR_F:"dddd d MMMM yyyy HH:mm:ss",fr_FR_M:"d MMMM",fr_FR_Y:"MMMM yyyy",it_IT_d:"dd/MM/yyyy",it_IT_D:"dddd d MMMM yyyy",it_IT_t:"HH:mm",it_IT_T:"HH:mm:ss",it_IT_f:"dddd d MMMM yyyy HH:mm",it_IT_F:"dddd d MMMM yyyy HH:mm:ss",it_IT_M:"dd MMMM",it_IT_Y:"MMMM yyyy",ru_RU_d:"dd.MM.yyyy",ru_RU_D:"d MMMM yyyy '?.'",ru_RU_t:"H:mm",ru_RU_T:"H:mm:ss",ru_RU_f:"d MMMM yyyy '?.' H:mm",ru_RU_F:"d MMMM yyyy '?.' H:mm:ss",ru_RU_Y:"MMMM yyyy",cs_CZ_d:"d.M.yyyy",cs_CZ_D:"d. MMMM yyyy",cs_CZ_t:"H:mm",cs_CZ_T:"H:mm:ss",cs_CZ_f:"d. MMMM yyyy H:mm",cs_CZ_F:"d. MMMM yyyy H:mm:ss",cs_CZ_M:"dd MMMM",cs_CZ_Y:"MMMM yyyy",he_IL_d:"dd MMMM yyyy",he_IL_D:"dddd dd MMMM yyyy",he_IL_t:"HH:mm",he_IL_T:"HH:mm:ss",he_IL_f:"dddd dd MMMM yyyy HH:mm",he_IL_F:"dddd dd MMMM yyyy HH:mm:ss",he_IL_M:"dd MMMM",he_IL_Y:"MMMM yyyy",hr_HR_d:"d.M.yyyy.",hr_HR_D:"d. MMMM yyyy.",hr_HR_t:"H:mm",hr_HR_T:"H:mm:ss",hr_HR_f:"d. MMMM yyyy. H:mm",hr_HR_F:"d. MMMM yyyy. H:mm:ss",hr_HR_M:"d. MMMM",hu_HU_d:"yyyy.MM.dd.",hu_HU_D:"yyyy. MMMM d.",hu_HU_t:"H:mm",hu_HU_T:"H:mm:ss",hu_HU_f:"yyyy. MMMM d. H:mm",hu_HU_F:"yyyy. MMMM d. H:mm:ss",hu_HU_M:"MMMM d.",hu_HU_Y:"yyyy. MMMM",jp_JP_d:"gg y/M/d",jp_JP_D:"gg y'?'M'?'d'?'",jp_JP_t:"H:mm",jp_JP_T:"H:mm:ss",jp_JP_f:"gg y'?'M'?'d'?' H:mm",jp_JP_F:"gg y'?'M'?'d'?' H:mm:ss",jp_JP_M:"M'?'d'?'",jp_JP_Y:"gg y'?'M'?'",lt_LT_d:"yyyy.MM.dd",lt_LT_D:"yyyy 'm.' MMMM d 'd.'",lt_LT_t:"HH:mm",lt_LT_T:"HH:mm:ss",lt_LT_f:"yyyy 'm.' MMMM d 'd.' HH:mm",lt_LT_F:"yyyy 'm.' MMMM d 'd.' HH:mm:ss",lt_LT_M:"MMMM d 'd.'",lt_LT_Y:"yyyy 'm.' MMMM",sa_IN_d:"dd-MM-yyyy",sa_IN_D:"dd MMMM yyyy dddd",sa_IN_t:"HH:mm",sa_IN_T:"HH:mm:ss",sa_IN_f:"dd MMMM yyyy dddd HH:mm",sa_IN_F:"dd MMMM yyyy dddd HH:mm:ss",sa_IN_M:"dd MMMM",basic_y:"yyyy",basic_ym:"yyyy-MM",basic_d:"yyyy-MM-dd",basic_dhm:"yyyy-MM-dd hh:mm",basic_bhms:"yyyy-MM-dd hh:mm:ss",basic2_ym:"MM-yyyy",basic2_d:"MM-dd-yyyy",basic2_dhm:"MM-dd-yyyy hh:mm",basic2_dhms:"MM-dd-yyyy hh:mm:ss",basic3_ym:"yyyy/MM",basic3_d:"yyyy/MM/dd",basic3_dhm:"yyyy/MM/dd hh:mm",basic3_bhms:"yyyy/MM/dd hh:mm:ss",basic4_ym:"MM/yyyy",basic4_d:"MM/dd/yyyy",basic4_dhm:"MM/dd/yyyy hh:mm",basic4_dhms:"MM/dd/yyyy hh:mm:ss"};t&&(i=Object.assign({},i,t));let r=[];for(let n in Array.isArray(e)?r=e:r.push(e),i)i[n]={format:i[n],count:0};for(let n=0;n<r.length;n++){const e=r[n];if(null!==e&&void 0!==e)for(let t in i)try{const r=e instanceof Date||Smart.Utilities.DateTime.parseDateString(e,void 0,i[t].format);r&&i[t].count++}catch(e){}}let n={key:void 0,count:0};for(let r in i)i[r].count>n.count&&(n.key=r,n.count=i[r].count);return n.key?i[n.key].format:""}_testXAxisDateFormat(e){let t=this,r=t._getXAxis(e),n=t._getDataLen(e),i={};if(t.localization.patterns)for(let e in t.localization.patterns)i["local_"+e]=t.localization.patterns[e];let s=[];for(let a=0;a<n&&10>a;a++){const i=t._getDataValue(a,r.dataField,e);null===i||i===void 0||s.push(i)}let a=t._detectDateFormat(s,i);return a}_getThemeColor(e){if("light"===this.theme)switch(e){case"background":return"#FFFFFF";case"line":return"#BCBCBC";case"band":return"#AAAAAA";}return"background"===e?"#2E2E2E":"line"===e?"#707070":"band"===e?"#565656":void 0}});