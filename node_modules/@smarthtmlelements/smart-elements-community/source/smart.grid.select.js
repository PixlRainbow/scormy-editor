
/* Smart HTML Elements v4.6.0 (2019-Oct) 
Copyright (c) 2011-2019 jQWidgets. 
License: https://htmlelements.com/license/ */

Smart.Utilities.Assign("Grid.Select",class{_refreshSelection(){const e=this;if(e.selection.enabled){const l=e._selectionColumn;l.refresh()}e._refreshCellSelectionRect()}_toggleColumnSelection(e){const l=this;if(!l.selection.enabled||"none"===l.selection.checkBoxes.selectAllMode)return void(l._inputOverlay&&l._inputOverlay.parentNode&&l._inputOverlay.parentNode.removeChild(l._inputOverlay));let t=e.element.getAttribute("selected");t="indeterminate"===t||""!==t;let n=l._recyclingRows;l._selectionColumn._selecting=!0,l.beginUpdate();for(let l=0;l<n.length;l++){const e=n[l];e.selected=t}if(l._selectionColumn._selecting=!1,l.endUpdate(!1),l._recycle(!1),l.selection.enabled&&l.selection.checkBoxes.enabled&&"none"!==l.selection.checkBoxes.selectAllMode){const t=e.element,n=t.querySelector(".smart-input");l._inputOverlay?l._inputOverlay.parentNode!==l.$.columnHeader&&(l._inputOverlay.parentNode&&l._inputOverlay.parentNode.removeChild(l._inputOverlay),l._inputOverlay=document.createElement("div"),l.$.columnHeader.appendChild(l._inputOverlay)):(l._inputOverlay=document.createElement("div"),l.$.columnHeader.appendChild(l._inputOverlay)),l._inputOverlay.column=e,l._inputOverlay.onpointerdown=function(){l._inputOverlay||(l._inputOverlay.onpointerdown=null);const e=l._inputOverlay.column;l._inputOverlay.classList.remove("smart-animate"),l._selectionColumn._selecting=!0,l.beginUpdate();let t=e.element.hasAttribute("selected"),n=l._recyclingRows;for(let e=0;e<n.length;e++){const l=n[e];l.selected=!t}l._selectionColumn._selecting=!1;const o=l._inputOverlay;return l.endUpdate(!1),l._recycle(),l.$.columnHeader.appendChild(o),l._inputOverlay=o,l._inputOverlay.classList.add("smart-animate"),!1},l._inputOverlay.classList.add("smart-input-overlay"),l._inputOverlay.classList.add("smart-input-overlay-column"),l.appearance.allowCheckBoxesSelectionAnimation&&l._inputOverlay.classList.add("smart-animate"),l._inputOverlay.style.top=(t.offsetHeight-n.offsetHeight)/4+1+"px";const o=l._selectionColumn.element.parentElement.offsetLeft+l._selectionColumn.element.offsetLeft;l._inputOverlay.style.left=o+"px",l._inputOverlay.style.height=t.offsetWidth+"px",l._inputOverlay.style.width=t.offsetWidth+"px",l._inputOverlay.onmousedown=null,l._inputOverlay.classList.add("smart-input-overlay-on"),l._selectionColumn.refresh()}}_refreshCheckBoxColumnSelection(){const e=this;if(e.selection.enabled&&e.selection.checkBoxes.enabled){const l=e._selectionColumn.element;"none"===e.selection.checkBoxes.selectAllMode?(l.removeAttribute("checkbox"),l.label.classList.remove("smart-input")):(l.setAttribute("checkbox",""),l.label.classList.add("smart-input")),e._selectionColumn.refresh()}}_handleExtendedRowSelection(e,l){const t=this;if(!e)return;let n=t._recyclingRows;if(t.paging.enabled&&"page"===t.selection.selectAllMode&&(n=n.slice(t.paging.pageIndex*t.paging.pageSize,(t.paging.pageIndex+1)*t.paging.pageSize)),l&&!l.ctrlKey&&(t._selection.rows=[]),l&&!l.shiftKey&&(t._rangeSelectionStartRow=e,t._rangeSelectionEndRow=e),l&&l.shiftKey){t._rangeSelectionEndRow=e;const l=n.indexOf(t._rangeSelectionStartRow),o=n.indexOf(t._rangeSelectionEndRow),d=Math.min(l,o),a=Math.max(l,o);if(-1===l||-1===o)return;for(let e=d;e<=a;e++){const l=n[e];l.setProperty("selected",!0)}}else l&&l.ctrlKey?null===e.selected?e.setProperty("selected",!0):e.setProperty("selected",!e.selected):e.setProperty("selected",!0)}_setSelection(e,l,t){const n=this;if(n.selection.enabled){if(n._lastColumnSelectionRange=null,n._lastRowSelectionRange=null,n.closeMenu(),null===e&&null===l)return void n.clearSelection();const o=function(){if(t&&!t.ctrlKey&&!t.shiftKey||"one"===n.selection.mode){if("many"!==n.selection.mode){for(let e in n._selection.rows){const l=n.rowById[e];l.canNotify=!1,l.selected=!1,l.canNotify=!0}n._selection.rows=[],n._selection.columns=[],n._selection.cells=[]}n._selection.focusedCell=null}if(n._selection.selectionRect){const e=n._selection.selectionRect;e.parentNode.removeChild(e);const l={down:"pointerdown",move:"pointermove",up:"pointerup"};Smart.Utilities.Core.isMobile&&(l.down="touchstart",l.move="touchmove",l.up="touchend"),document.removeEventListener(l.move,e.onMove),document.removeEventListener(l.up,e.onUp),document.removeEventListener(l.down,e.onDown),n._selection.selectionRect=null}};n.beginUpdate();const i=n.columnByDataField[l];if(n.selection.allowCellSelection&&void 0!==e&&null!==e&&i&&!i.autoGenerated){const i=n.rowById[e];let d=i.getCell(l);const a=n._getParentCell(i,l);a&&(d=a.row.getCell(a.column.dataField)),o(),t&&!t.ctrlKey&&(n._selection.rows=[],n._selection.columns=[],"many"!==n.selection.mode&&(n._selection.cells=[])),d.selected="extended"===n.selection.mode?!(t&&t.ctrlKey)||!d.selected:"one"===n.selection.mode||!d.selected,(!t||t.shiftKey)&&n._selection.focusedCell||(n._selection.focusedCell=d),t&&(t.shiftKey||n._selection.focusedCell===d)&&"extended"===n.selection.mode&&(a?n._renderCellSelectionRect(d.row,d.column,a.endRow,a.endColumn):n._renderCellSelectionRect(d.row,d.column,d.row,d.column))}else n.selection.allowRowHeaderSelection&&void 0!==e&&null!==e&&void 0===n.columnByDataField[l]?(o(),n._selectRow(e,t)):n.selection.checkBoxes.enabled&&void 0!==e&&null!==e&&"_checkBoxColumn"===l&&void 0===n.columnByDataField[l]?(o(),n._selectRow(e,t)):void 0!==e&&null!==e&&(void 0===l||void 0!==n.columnByDataField[l])&&n.selection.allowRowSelection?(o(),n._selectRow(e,t)):n.selection.allowColumnHeaderSelection&&i&&(o(),n._selectColumn(l,t));n.endUpdate(!1),n._recycle(),void 0===e||null===e||i||n._renderInputOverlay(e,t)}}_renderCellSelectionRect(e,l,t,n){const o=this;let i=o._recyclingRows;const d=i.indexOf(e),a=i.indexOf(t);if(0<=d&&0<=a){if(!o._selection.selectionRect){const e=o._selection.selectionRect=function(e){const l=document.createElement("div"),t=document.createElement("div"),n=document.createElement("div");return n.classList.add("smart-selection-overlay"),n.appendChild(t),t.appendChild(l),l.classList.add("smart-selection-overlay-content"),t.classList.add("smart-selection-overlay-border-content"),o.selection.allowCellDragSelectionHandle&&e&&t.classList.add("handle"),o.$.scrollView.appendChild(n),n}(!0);if(o.selection.allowCellDragSelectionHandle){let l=null,t=null,n=null;e.onMove=function(e){var d=Math.abs;const a=o._selection.selectionRect;let c=e.clientX,r=e.clientY;e.touches&&(c=e.touches[0].clientX,r=e.touches[0].clientY);const s=function(e){const l=(o.enableShadowDOM?o.shadowRoot:o.getRootNode()).elementsFromPoint(e.clientX,e.clientY);let t=null;for(let n=0;n<l.length;n++){const e=l[n];if(e.getAttribute("data-field")){t=e.getAttribute("data-field");break}}let n=null;for(let t=0;t<l.length;t++){const e=l[t];if(e.getAttribute("data-id")){n=e.row;break}}return{column:o.columnByDataField[t],row:n}};if(a.capturedDrag){const l={clientX:c,clientY:r};let t=s(l),n=s({clientX:c,clientY:r+a.top}).row,d=s({clientX:c+a.left,clientY:r}).column;n||(n=i[i.length-1]),d||(d=t.column),n&&d&&t.row&&t.column&&(a.row=t.row,a.column=t.column,a.endDragRow=a.endRow=n,a.endDragColumn=a.endColumn=d,o._dragSelectionStartDataField=a.column.dataField,o._dragSelectionStartRow=a.row,o._selection.focusedCell=a.row.getCell(a.column.dataField)),o._resizeSelectionRect(),e.preventDefault()}else if(a.captured)if(o._dragSelectionStartDataField=o._selection.focusedCell.column.dataField,o._dragSelectionStartRow=o._selection.focusedCell.row,null===t&&null===n&&(30<=d(c-l.left)?t=!0:30<=d(r-l.top)&&(n=!0)),a.lastPoint&&40<=d(a.lastPoint.top-r)?(t=null,n=!0):a.lastPoint&&40<=d(a.lastPoint.left-c)&&(n=null,t=!0),t){const e=a.endDragColumn.dataField,t={clientX:c,clientY:l.top-5},n=s(t);n.row&&n.column&&(a.endDragRow=a.endRow,a.endDragColumn=n.column,a.endDragColumn.dataField!==e&&(a.lastPoint={left:c,top:r}),o._resizeSelectionRect())}else if(n){const e=a.endDragRow,t={clientX:l.left-5,clientY:r},n=s(t);n.row&&n.column&&(a.endDragRow=n.row,a.endDragColumn=a.endColumn,a.endDragRow.id&&a.endDragRow.id!==e.id&&(a.lastPoint={left:c,top:r}),o._resizeSelectionRect())}a.captured&&o.selection.allowDragSelectionAutoScroll&&(o._autoScrollSelectionDragInterval&&clearInterval(o._autoScrollSelectionDragInterval),o.selection.isDragging=!0,o._autoScrollSelectionDragInterval=setInterval(function(){const e=o.$.scrollView.getBoundingClientRect();c<=e.left+20?(o.scrollLeft-=15,o._resizeSelectionRect()):c>=e.left+e.width-20&&(o.scrollLeft+=15,o._resizeSelectionRect()),r<=e.top+20?(o.scrollTop-=15,o._resizeSelectionRect()):r>=e.top+e.height-20&&(o.scrollTop+=15,o._resizeSelectionRect())},5))},e.onUp=function(){if(e.captured){o._autoScrollSelectionDragInterval&&clearInterval(o._autoScrollSelectionDragInterval),o.editing.editCell||o.editing.editRow||o.focus(),e.capturedDrag=!1,e.captured=!1,t=null,n=null,l=null,e.lastPoint=null;const i=e.cellValues;e.minRow&&e.maxRow&&e.maxRow&&e.maxColumn&&(o._selectCellsRange(e.minRow,e.maxRow,e.minColumn.dataField,e.maxColumn.dataField),e.row=e.minRow,e.column=e.minColumn,e.endColumn=e.maxColumn,e.endRow=e.maxRow,e.cellValues=i,o._resizeSelectionRect(),o.selection.allowCellDragSelectionAutoFill&&o._pasteSelectedCells({row:e.row,endRow:e.endDragRow,column:e.column,endColumn:e.endColumn},i)),e.endDragColumn=null,e.endDragRow=null,e.minColumn=null,e.minRow=null,e.maxColumn=null,e.maxRow=null}},e.onDown=function(t){if(e.captured&&!l){let e=t.clientX,n=t.clientY;t.touches&&(e=t.touches[0].clientX,n=t.touches[0].clientY),l={left:e,top:n}}};const d={down:"pointerdown",move:"pointermove",up:"pointerup"};Smart.Utilities.Core.isMobile&&(d.down="touchstart",d.move="touchmove",d.up="touchend"),e["on"+d.down]=function(l){const t=e.getBoundingClientRect();let n=l.clientX,i=l.clientY;l.touches&&(n=l.touches[0].clientX,i=l.touches[0].clientY),n>=t.right-5&&i>=t.bottom-5?(e.captured=!0,e.endDragRow=e.endRow,e.endDragColumn=e.endColumn):o.selection.allowCellDragDropSelectionHandle&&i>=t.bottom-5?(e.captured=!0,e.capturedDrag=!0,e.endDragRow=e.endRow,e.endDragColumn=e.endColumn,e.left=e.endColumn.left-e.column.left,e.top=e.endRow.top-e.row.top):!e.captured&&o._rowDownHandler(l)},document.addEventListener(d.move,e.onMove,{passive:!1}),document.addEventListener(d.up,e.onUp,{passive:!1}),document.addEventListener(d.down,e.onDown,{passive:!1})}}const e=o._selection.selectionRect;e.row=o._selection.focusedCell.row,e.column=o._selection.focusedCell.column,e.endRow=t,e.endDragRow=t,e.endColumn=n,e.endDragColumn=n,o._refreshCellSelectionRect()}}_resizeSelectionRect(){var e=Math.max,l=Math.min;const t=this,n=t._selection.selectionRect;if(!n)return;let o=t._recyclingRows,i=n.row,d=n.endDragRow,a=n.column,c=n.endDragColumn;const r=o.indexOf(i),s=o.indexOf(d),u=o.indexOf(n.endRow),m=t.columns.indexOf(a),g=t.columns.indexOf(c),w=t.columns.indexOf(n.endColumn),_=l(u,l(r,s)),p=e(u,e(r,s)),f=l(w,l(m,g)),h=e(w,e(m,g));n.minRow=u<=l(r,s)?n.endRow:r<=s?i:d,n.maxRow=u>=e(r,s)?n.endRow:r>=s?i:d,n.minColumn=w<=l(m,g)?n.endColumn:m<=g?a:c,n.maxColumn=w>=e(m,g)?n.endColumn:m>=g?a:c;let y=0,S=0,R=0,x=0;for(let e=_;e<=p;e++){const l=o[e];e===_&&(y=l.top),e===p&&(S=l.top+l.height-y);for(let e=f;e<=h;e++){const n=t.columns[e].dataField,o=l.getCell(n);e===f&&(R=o.column.left),e===h&&(x=o.column.left+o.column.computedWidth-R)}}n.style.top=y-t.scrollTop-1+"px",n.style.left=R-t.scrollLeft+"px",n.style.height=S+1+"px",n.style.width=x+1+"px"}_getPatternValue(e,l,t){let n=[],o=0,d=[],a=[],c=[],r=[];const i={names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],namesAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],namesShort:["Su","Mo","Tu","We","Th","Fr","Sa"]},s={names:["January","February","March","April","May","June","July","August","September","October","November","December",""],namesAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""]},u=function(e){if(void 0!==e&&!(0<=e.toString().indexOf("GMT+")||0<=e.toString().indexOf("GMT-"))){if(isNaN(parseFloat(e))){if(0<=i.names.indexOf(e))return r=i.names,i.names.indexOf(e);if(0<=i.namesAbbr.indexOf(e))return r=i.namesAbbr,i.namesAbbr.indexOf(e);if(0<=i.namesShort.indexOf(e))return r=i.namesShort,i.namesShort.indexOf(e);if(0<=s.names.indexOf(e))return r=s.names,s.names.indexOf(e);if(0<=s.namesAbbr.indexOf(e))return r=s.namesAbbr,s.namesAbbr.indexOf(e);if(void 0!==e){null===e&&(e="");const l=/\d+/.test(e.toString());if(l){c.push(e.toString().replace(/[0-9]/,"#")),c[c.length-1]=c[c.length-1].replace(/[0-9]/g,"");const l=parseFloat(e.toString().replace(/\D/g,""));return isNaN(l)?0:l}}return}const l=/[A-Za-z]/.test(e.toString());return l?void 0:parseFloat(e)}};let m=0;for(let i in t){let e=t[i];for(let l in n[o]=[],m=0,e){let t=u(e[l]);void 0!==t&&(n[o].push(t),m++)}if(0===n[o].length)continue;let l=n[o][0],a=0;for(let e=0;e<n[o].length;e++){let t=u(n[o][e-1]),i=u(n[o][e]);0==e&&(t=i),l+=i,a+=i-t}l/=n[o].length,l-=n[o][0],l+=n[o][n[o].length-1],0!==a&&(a/=n[o].length-1),(0<r.length||0<c.length)&&(a=1,l=n[o][0]),2>=n[o].length&&(l=n[o][n[o].length-1]+a),d.push({step:a,stepStart:l}),o++}for(let o=0;o<m;o++){let e=n[0][o],l=0;for(let t=1;t<n.length;t++){const i=u(n[t-1][o]),d=u(n[t][o]);e+=d,l+=d-i}e/=n.length,e-=n[0][o],e+=n[n.length-1][o],0!==l&&(l/=n.length-1),(0<r.length||0<c.length)&&(l=1,e=n[0][o]),2>=n.length&&(e=n[n.length-1][o]+l),a.push({step:l,stepStart:e})}if(!n[e]){let t=n.length;for(let o=t;o<=e;o++){n[o]=[];for(let e=0;e<=l;e++)(a[e]||(a[e]=a[e-1]),!!a[e])&&(o===t?n[o][e]=a[e].stepStart:(n[o][e]=n[o-1][e]+a[e].step,1<r.length&&n[o][e]>=r.length&&(n[o][e]=0)))}if(0<r.length)return r[n[e][l]];return 0<c.length?c[e%c.length].replace("#",n[e][l]):n[e][l]}if(!n[e][l]){let t=m;for(let o=t;o<=l;o++)d[e]&&(o==t?n[e].push(d[e].stepStart):(n[e][o]=n[e][o-1]+d[e].step,1<r.length&&n[e][o]>=r.length&&(n[e][o]=0)));return 0<r.length?r[n[e][l]]:0<c.length?c[e%c.length].replace("#",n[e][l]):n[e][l]}return n[e]&&n[e][l]?0<c.length?c[e%c.length].replace("#",n[e][l]):n[e][l]:0}_pasteDataType(e){const l=this,t=l.dataSource&&"number"==typeof l.dataSource.dataSource,n=e.cell,o=e.value;let i=n.column.dataType;return(!i||t)&&(isNaN(parseFloat(o))?i="string":o instanceof Date?i="date":"true"===o||"false"===o?i="boolean":i="number"),i}_pasteModeCopy(e){const l=this,t=l.dataSource&&"number"==typeof l.dataSource.dataSource,n=l._pasteDataType(e),o=e.cell,i=e.value,d=e.dataField;if("string"===n)o.value=i;else if("bool"===n||"boolean"===n)(1===i||"1"===i||!0===i||"true"===i||"TRUE"===i||"True"===i)&&(o.value=!0);else if("date"===n||"time"===n||"dateTime"===n){const e=l.columnByDataField[d];o.value=t?i:e&&e.dataType!==n?null:i}else if("number"===n||"float"===n||"int"===n){const e=l.columnByDataField[d];o.value=t?i:e&&e.dataType!==n?null:null===i?null:"int"===n||"integer"===n?parseInt(i):parseFloat(i)}}_pasteModeFill(e){const l=this,t=l.dataSource&&"number"==typeof l.dataSource.dataSource,n=l._pasteDataType(e),o=e.cell,i=e.selectedValues,d=e.minRowIndex,a=e.minColumnIndex,c=e.currentRowIndex,r=e.currentColumnIndex,s=e.dataField;let u=e.value;if("string"===n){const t=/\d+/.test(u.toString());t?(u=l._getPatternValue(c-d,r-a,i),u===void 0&&i[c-d]&&i[c-d][r-a]&&(u=i[c-d][r-a])):(u=l._getPatternValue(c-d,r-a,i),u=void 0===u?i[c-d]?i[c-d][r-a]:e.value:e.value),u!==void 0&&(o.value=u)}else if("bool"===n||"boolean"===n)(1===u||"1"===u||!0===u||"true"===u||"TRUE"===u||"True"===u)&&(o.value=!0);else if("date"===n||"time"===n||"dateTime"===n){const e=l.columnByDataField[s];t?o.value=u:e&&e.dataType!==n&&(o.value=null),i[c-d]&&(u=i[c-d][r-a],u!==void 0&&(o.value=u))}else if("number"===n||"float"===n||"int"===n){u=l._getPatternValue(c-d,r-a,i);const e=l.columnByDataField[s];o.value=t?u:e&&e.dataType!==n?null:null===u?null:"int"===n||"integer"===n?parseInt(u):parseFloat(u)}}_pasteSelectedCells(e,l){var t=Math.max,n=Math.min;const o=this;o.beginUpdate();let d=o._recyclingRows,i=e.row,a=e.endRow,c=e.column,r=e.endColumn;const s=d.indexOf(i),u=d.indexOf(a),m=d.indexOf(e.endRow),g=o.columns.indexOf(c),w=o.columns.indexOf(r),_=o.columns.indexOf(e.endColumn),p=n(m,n(s,u)),f=t(m,t(s,u)),h=n(_,n(g,w)),y=t(_,t(g,w));let S=0,R=0,x=0,C=0;for(let t in l)0==S&&(R+=Object.keys(l[t]).length),S++;for(let t=p;t<=f;t++){const e=d[t];x=0;for(let n=h;n<=y;n++){const i=o.columns[n].dataField,d=e.getCell(i);let a=0;for(let c in l){if(a===C){let a=0,r=l[c];for(let s in r){if(x===a){let a=r[s],u=!0;if(l[e.id]&&l[e.id][i]&&(u=!1),u&&"none"!==o.clipboard.autoFillMode){const e={value:a,oldValue:d.value,dataField:s,id:c};o.clipboard.onPasteValue?(o.clipboard.onPasteValue(e),d.value=e.value):(e.cell=d,e.selectedValues=l,e.minRowIndex=p,e.maxRowIndex=f,e.minColumnIndex=h,e.maxColumnIndex=y,e.currentColumnIndex=n,e.currentRowIndex=t,"copy"===o.clipboard.autoFillMode?o._pasteModeCopy(e):"fillSeries"===o.clipboard.autoFillMode&&o._pasteModeFill(e))}}a++}}a++}x++,x>=R&&(x=0)}C++,C>=S&&(C=0)}o.endUpdate(!1),o._recycle(!1)}_refreshCellSelectionRect(){var e=Math.max,l=Math.min;const t=this,n=t._selection.selectionRect;if(!n||n&&n.captured)return;let o=t._recyclingRows,i=n.row,d=n.endRow,a=n.column,c=n.endColumn;const r=o.indexOf(i),s=o.indexOf(d),u=t.columns.indexOf(a),m=t.columns.indexOf(c);let g=l(r,s),w=e(r,s),_=l(u,m),p=e(u,m);_=e(0,_),g=e(0,g);const f=function(n){const i=o.indexOf(n.row),d=o.indexOf(n.endRow),a=t.columns.indexOf(n.column),c=t.columns.indexOf(n.endColumn);g=l(g,i),g=l(g,d),g=e(0,g),w=e(w,i),w=e(w,d),_=l(_,a),_=l(_,c),_=e(0,_),p=e(p,a),p=e(p,c)},h=t._getParentCell(i,a.dataField),y=t._getParentCell(i,c.dataField),S=t._getParentCell(d,c.dataField),R=t._getParentCell(d,a.dataField);h&&f(h),y&&f(y),S&&f(S),R&&f(R);let x=0,C=0,F=0,v=0;n.cellValues=[];for(let e=g;e<=w;e++){const l=o[e];if(e===g&&(x=l.top,!0!==l.freeze&&"near"!==l.freeze&&(x+=t.__frozenNearHeight),"far"===l.freeze&&(x=l.top+t.__scrollHeight+t.scrollTop-t._scrollView.hScrollBar.offsetHeight)),e===w){let e=l.top;"far"===l.freeze&&(e=l.top+t.__scrollHeight+t.scrollTop-t._scrollView.hScrollBar.offsetHeight),C=e+l.height-x,!0!==l.freeze&&"near"!==l.freeze&&(C+=t.__frozenNearHeight)}n.cellValues[l.id]=[];for(let e=_;e<=p;e++){const o=t.columns[e].dataField,i=l.getCell(o);if(n.cellValues[l.id][o]=i.value,e===_&&(F=i.column.left,i.column.freeze&&"far"===i.column.freeze&&(F=t.__clientSize.width-t.__frozenFarWidth+F+t.scrollLeft-t._scrollView.vScrollBar.offsetWidth)),e===p){let e=i.column.left;i.column.freeze&&"far"===i.column.freeze&&(e=t.__clientSize.width-t.__frozenFarWidth+e+t.scrollLeft-t._scrollView.vScrollBar.offsetWidth),v=e+i.column.computedWidth-F}i.selected=!0}}n.style.top=x-t.scrollTop-1+"px",n.style.left=F-t.scrollLeft+"px",n.style.height=C+1+"px",n.style.width=v+1+"px"}_renderInputOverlay(e,l,t){const n=this,o=n.rowById[e];if(o&&o.allowSelect&&!o.label&&l&&n.selection.checkBoxes.enabled){n._inputOverlay&&n._inputOverlay.classList.contains("smart-input-overlay-column")&&(n._inputOverlay.parentNode&&n._inputOverlay.parentNode.removeChild(n._inputOverlay),n._inputOverlay=null),n._inputOverlay||(n._inputOverlay=document.createElement("div"),n.$.scrollView.appendChild(n._inputOverlay),n._inputOverlay.classList.add("smart-input-overlay"));let e=o.freeze?o.top:n.__frozenNearHeight+o.top;const i=Math.round((o.cellHeight-n._selectionColumn.computedWidth)/2),d=n._selectionColumn.element.parentElement.offsetLeft+n._selectionColumn.element.offsetLeft;n._inputOverlay.style.left=d+"px",n._inputOverlay.style.height=n._selectionColumn.computedWidth+"px",n._inputOverlay.style.width=n._selectionColumn.computedWidth+"px",n._inputOverlay.style.top=e+i-n.scrollTop+"px",n._inputOverlay.row=o,n._inputOverlay.onpointerdown=function(){n._inputOverlay||(n._inputOverlay.onpointerdown=null);const e=n._inputOverlay.row;n.beginUpdate(),e.selected=!e.selected,n.endUpdate(!1),n._recycle(),n._renderInputOverlay(e.id,l,!0)},n.appearance.allowCheckBoxesSelectionAnimation&&void 0===t&&n._inputOverlay.classList.add("smart-animate"),requestAnimationFrame(()=>{n._inputOverlay&&n._inputOverlay.classList.add("smart-input-overlay-on")})}}_selectRow(e,l){const t=this,n=t.rowById[e];n&&t.selection.enabled&&(!n.header||"row-resize"!==n.header.style.cursor)&&(l&&(!l.shiftKey||!t._selection.focusedCell)&&(t._selection.focusedCell=n.getCell(t.columns[0].dataField)),t._lastRowsSelectionRange=null,"extended"===t.selection.mode?t._handleExtendedRowSelection(n,l):"one"===t.selection.mode?n.selected=!0:n.selected=!n.selected)}_getParentCell(e,l){const t=this;let n=t._recyclingRows;for(let o=0;o<t._cellsMerge.length;o++){const i=t._cellsMerge[o];let d=[],a=[];if(d.push(i.row),1<i.rowSpan){const e=n.indexOf(i.row);if(0<=e)for(let l=e;l<e+i.rowSpan;l++)n[l]&&-1===d.indexOf(n[l])&&d.push(n[l])}if(a.push(i.column.dataField),1<i.colSpan){const e=t.columns.indexOf(t.columnByDataField[i.column.dataField]);for(let l=e;l<e+i.colSpan;l++)t.columns[l]&&-1===a.indexOf(t.columns[l].dataField)&&a.push(t.columns[l].dataField)}if(0<=d.indexOf(e)&&0<=a.indexOf(l))return{row:i.row,column:i.column,endRow:d[d.length-1],endColumn:t.columnByDataField[a[a.length-1]]}}return null}_selectCellsRange(e,l,t,n){var o=Math.max,i=Math.min;const d=this,a=d._selection.selectionRect;if(d._lastRowsSelectionRange&&d._lastRowsSelectionRange.id===e.id&&d._lastRowsSelectionRange.endId===l.id&&d._lastColumnSelectionRange&&d._lastColumnSelectionRange.dataField===t&&d._lastColumnSelectionRange.endDataField===n)return;d.beginUpdate(),d._clearSelection(),d._lastRowsSelectionRange={id:e.id,endId:l.id},d._lastColumnSelectionRange={dataField:t,endDataField:n},(!a||a&&!a.captured)&&d._selection.focusedCell&&d._renderCellSelectionRect(d._selection.focusedCell.row,d._selection.focusedCell.column,d.rowById[d._lastRowsSelectionRange.endId],d.columnByDataField[d._lastColumnSelectionRange.endDataField]);let c=d._recyclingRows,r=-1,s=d.columns.length,u=c.indexOf(e),m=c.indexOf(l);for(let o=0;o<d.columns.length;o++){const e=d.columns[o];e.allowSelect&&(e.dataField===t&&(r=o),e.dataField===n&&(s=o))}let g=i(u,m),w=o(u,m),_=i(r,s),p=o(r,s);const f=function(e){const l=c.indexOf(e.row),t=c.indexOf(e.endRow),n=d.columns.indexOf(e.column),a=d.columns.indexOf(e.endColumn);g=i(g,l),g=i(g,t),w=o(w,l),w=o(w,t),_=i(_,n),_=i(_,a),p=o(p,n),p=o(p,a)},h=d._getParentCell(e,t),y=d._getParentCell(l,n);if(h&&f(h),y&&f(y),0>w||0>g)return d.endUpdate(!1),void d._recycle();for(let o=g;o<=w;o++){const e=c[o];if(e.allowSelect)for(let l=0;l<d.columns.length;l++){const t=d.columns[l];if(t.allowSelect&&l>=_&&l<=p){const l=e.getCell(t.dataField);l.selected=!0}}}d.endUpdate(!1),d._recycle()}_selectRowsRange(e,l){const t=this;if(t._lastRowsSelectionRange&&t._lastRowsSelectionRange.id===e.id&&t._lastRowsSelectionRange.endId===l.id)return;t.beginUpdate(),t._clearSelection(),t._lastRowsSelectionRange={id:e.id,endId:l.id};let n=t._recyclingRows;const o=n.indexOf(e),i=n.indexOf(l),d=Math.min(o,i),a=Math.max(o,i);if(0>a)return t.endUpdate(!1),void t._recycle();for(let t=d;t<=a;t++){const e=n[t];e&&e.allowSelect&&(e.selected=!0)}t.endUpdate(!1),t._recycle()}_selectColumnsRange(e,l){const t=this;if(t._lastColumnSelectionRange&&t._lastColumnSelectionRange.dataField===e&&t._lastColumnSelectionRange.endDataField===l)return;t.beginUpdate(),t._clearSelection(),t._lastColumnSelectionRange={dataField:e,endDataField:l};let n=-1,o=t.columns.length;for(let d=0;d<t.columns.length;d++){const i=t.columns[d];i.allowSelect&&(i.dataField===e&&(n=d),i.dataField===l&&(o=d))}const d=Math.min(n,o),a=Math.max(n,o);for(let n=0;n<t.columns.length;n++){const e=t.columns[n];e.allowSelect&&n>=d&&n<=a&&(e.selected=!0)}t.endUpdate(!1),t._recycle()}_selectColumn(e,l){const t=this,n=t.columnByDataField[e];if(n&&t.selection.enabled&&n.allowSelect&&t.selection.allowColumnHeaderSelection&&!(n&&"col-resize"===n.element.style.cursor)&&l)if("extended"!==t.selection.mode)n.selected="one"===t.selection.mode||null===n.selected||!n.selected;else if(l.ctrlKey||l.shiftKey||(t._rangeSelectionStartColumn=n,t._rangeSelectionEndColumn=n),n.selected=!0,l&&l.shiftKey){t._rangeSelectionStartColumn||(t._rangeSelectionStartColumn=n),t._rangeSelectionEndColumn=n,t._selection.columns=[];const e=t.columns.indexOf(t._rangeSelectionStartColumn),l=t.columns.indexOf(t._rangeSelectionEndColumn),o=Math.min(e,l),d=Math.max(e,l);for(let e=o;e<=d;e++){const l=t.columns[e];l.selected=!0}}}_getSelectedRows(e,l){const t=this,n=[];let o=t.rows;t.rows.canNotify=!1,e&&(o=t.getVisibleRows()),t.paging.enabled&&l&&(o=o.slice(t.paging.pageIndex*t.paging.pageSize,(t.paging.pageIndex+1)*t.paging.pageSize));for(let t=0;t<o.length;t++){const e=o[t];e.getProperty("selected")?n.push(e):(e.canNotify=!1,e.selected=!1,e.canNotify=!0)}return t.rows.canNotify=!0,n}_dragSelectionEnd(){const e=this;e._dragSelectionStartDataField=null,e._dragSelectionStartRow=null;e.selection.allowDragSelection&&e.selection.isDragging&&(e.selection.isDragging=!1,e._autoScrollSelectionDragInterval&&(clearInterval(e._autoScrollSelectionDragInterval),!e.editing.isEditing&&e._recycle()))}_dragSelection(e){const l=this;if("extended"===l.selection.mode&&!1!==l.selection.allowDragSelection&&(l._dragSelectionStartDataField||l._dragSelectionStartRow)){if(l.selection.allowCellSelection&&l._dragSelectionStartDataField&&!l._columnResizeLine&&!l._dragSelectionStartDataField.startsWith("_")&&l._dragSelectionStartRow&&!l._rowResizeLine){const t=(l.enableShadowDOM?l.shadowRoot:l.getRootNode()).elementsFromPoint(e.clientX,e.clientY);let n=null;for(let e=0;e<t.length;e++){const l=t[e];if(l.getAttribute("data-field")){n=l.getAttribute("data-field");break}}let o=null;for(let e=0;e<t.length;e++){const l=t[e];if(l.getAttribute("data-id")){o=l.row;break}}return n&&o&&l._selectCellsRange(l._dragSelectionStartRow,o,l._dragSelectionStartDataField,n),void(l.selection.allowDragSelectionAutoScroll&&(l._autoScrollSelectionDragInterval&&clearInterval(l._autoScrollSelectionDragInterval),l.selection.isDragging=!0,l._autoScrollSelectionDragInterval=setInterval(function(){const t=l.$.scrollView.getBoundingClientRect();e.clientX<=t.left+20?l.scrollLeft-=15:e.clientX>=t.left+t.width-20&&(l.scrollLeft+=15),e.clientY<=t.top+20?l.scrollTop-=15:e.clientY>=t.top+t.height-20&&(l.scrollTop+=15)},5)))}if(l._dragSelectionStartRow&&!l._rowResizeLine&&(l.selection.allowRowSelection&&!l._dragSelectionStartDataField.startsWith("_")||l.selection.allowRowHeaderSelection&&l._dragSelectionStartDataField.startsWith("_"))){const t=(l.enableShadowDOM?l.shadowRoot:l.getRootNode()).elementsFromPoint(e.clientX,e.clientY);let n=null;for(let e=0;e<t.length;e++){const l=t[e];if(l.getAttribute("data-id")){n=l.row,!n&&l.cell&&(n=l.cell.row);break}}n&&l._selectRowsRange(l._dragSelectionStartRow,n),l._autoScrollSelectionDragInterval&&clearInterval(l._autoScrollSelectionDragInterval),l.selection.isDragging=!0,l._autoScrollSelectionDragInterval=setInterval(function(){const t=l.$.scrollView.getBoundingClientRect();e.clientY<=t.top+20?l.scrollTop-=15:e.clientY>=t.top+t.height-20&&(l.scrollTop+=15)},5)}else if(l._dragSelectionStartDataField&&!l._columnResizeLine&&!l._dragSelectionStartDataField.startsWith("_")&&l.selection.allowColumnHeaderSelection){const t=(l.enableShadowDOM?l.shadowRoot:l.getRootNode()).elementsFromPoint(e.clientX,e.clientY);let n=null;for(let e=0;e<t.length;e++){const l=t[e];if(l.getAttribute("data-field")){n=l.getAttribute("data-field");break}}n&&l._selectColumnsRange(l._dragSelectionStartDataField,n),l._autoScrollSelectionDragInterval&&clearInterval(l._autoScrollSelectionDragInterval),l.selection.isDragging=!0,l._autoScrollSelectionDragInterval=setInterval(function(){const t=l.$.scrollView.getBoundingClientRect();e.clientX<=t.left+20?l.scrollLeft-=15:e.clientX>=t.left+t.width-20&&(l.scrollLeft+=15)},5)}}}select(e,l){const t=this;t._setSelection(e,l)}unselect(e,l){const t=this;t._selection&&(t._selection.rows&&t._selection.rows[e]&&delete t._selection.rows[e],t._selection.columns&&t._selection.columns[l]&&delete t._selection.columns[l],t._selection.cells&&(t._selection.cells["row"+e]&&(delete t._selection.cells["row"+e][l],1===Object.getOwnPropertyNames(t._selection.cells["row"+e]).length&&delete t._selection.cells["row"+e]),t._selection.cells["column"+l]&&(delete t._selection.cells["column"+l][e],1===Object.getOwnPropertyNames(t._selection.cells["column"+l]).length&&delete t._selection.cells["column"+l])))}getSelection(){const e=this;let l=null,t=null,n=null,o=null;if(e._selection.rows&&0<Object.keys(e._selection.rows).length){const t=Object.keys(e._selection.rows);l=[];for(let n=0;n<t.length;n++){const o=t[n];l.push({id:o,row:e.rowById[o]})}}if(e._selection.columns&&0<Object.keys(e._selection.columns).length){const l=Object.keys(e._selection.columns);t=[];for(let n=0;n<l.length;n++){const o=l[n];t.push({dataField:o,column:e.columnByDataField[o]})}}if(e._selection.cells)for(let l in e._selection.cells)if(l.startsWith("row")){let t=l.replace("row",""),o=null;for(let i in e._selection.cells[l])o=i.replace("column",""),n||(n=[]),n.push({id:t,dataField:o,column:e.columnByDataField[o],row:e.rowById[t]})}return e._selection.focusedCell&&(o={id:e._selection.focusedCell.row.id,dataField:e._selection.focusedCell.column.dataField}),{rows:l,columns:t,cells:n,focused:o}}_clearSelection(e){const l=this;if(l._selection.rows=[],l._selection.columns=[],l._selection.cells=[],e&&(l._selection.focusedCell=null,l._selection.selectionRect)){const e=l._selection.selectionRect;e.parentNode.removeChild(e);const t={down:"pointerdown",move:"pointermove",up:"pointerup"};Smart.Utilities.Core.isMobile&&(t.down="touchstart",t.move="touchmove",t.up="touchend"),document.removeEventListener(t.move,e.onMove),document.removeEventListener(t.up,e.onUp),document.removeEventListener(t.down,e.onDown),l._selection.selectionRect=null}l._recycle();const t=l._selectionColumn;t.refresh()}_getSelectionCellValues(){const e=this;if(e._selection.selectionRect)return e._selection.selectionRect.cellValues;if(0<e._selection.rows.length){let l=[];for(let t in e._selection.rows){const n=e.rowById[t];for(let o=0;o<e.columns.length;o++){const i=e.columns[o];i&&(l[t]||(l[t]=[]),l[t][i.dataField]=n.data[i.dataField])}}return l}if(0<e._selection.columns.length){let l=[];for(let t in e._selection.columns){const n=e.columnByDataField[t];if(n)for(let t=0;t<e._recyclingRows.length;t++){const o=e._recyclingRows[t];o&&(l[o.id]||(l[o.id]=[]),l[o.id][n.dataField]=o.data[n.dataField])}}return l}}_clipboardHandler(e,l){const t=this;if(t.clipboard.enabled){if(l.ctrlKey&&("c"===e||"x"===e)){const l=t._getSelectionCellValues();let n="",o=Object.keys(l).length,i=0;for(let t in l){let d="",a=Object.keys(l[t]).length,c=0;for(let e in l[t]){const n=l[t][e];d+=n,c++,c<a&&(d+="\t")}n+=d,i++,i<o&&(n+="\r\n"),"x"===e}navigator.clipboard.writeText(n).then(function(){},function(){})}l.ctrlKey&&"v"===e&&navigator.clipboard.readText().then(e=>{const l=[],n=e.split("\r");for(let t=0;t<n.length;t++){const e=n[t],o=e.split("\t");let i={};for(let e=0;e<o.length;e++)i[e]=o[e].trim();l[t]=i}const o=t._selection.selectionRect;if(o)t._pasteSelectedCells({row:o.row,endRow:o.endDragRow,column:o.column,endColumn:o.endColumn},l);else{let e=null,n=null;for(let l in t._selection.rows){const o=t.rowById[l];e||(e=o),n||(n=o),e.visibleIndex>o.visibleIndex&&(e=o),n.visibleIndex<o.visibleIndex&&(n=o)}e&&n&&t._pasteSelectedCells({row:e,endRow:n,column:t.columns[0],endColumn:t.columns[t.columns.length-1]},l)}})}}_keyDownHandler(e){const l=this;if(l.onKey&&(l.onKey(e),e.defaultPrevented))return;let t=e.key;if(!l.disabled&&!(0===l.dataSource.length||l.disabled||l.displayLoadingIndicator)){l._refreshCellSelectionRect();const n=l.getSelection();let o=n.focused;if(!n.focused){if(l.editing.enabled&&!0!==l.editing.isEditing&&("F2"===t||"Enter"===t)&&n.columns&&0<n.columns.length){const e=n.columns[n.columns.length-1];e.column.allowHeaderEdit&&l._beginColumnEdit(e.column)}return}const i=l._getParentCell(l.rowById[o.id],o.dataField);if(i&&("ArrowLeft"===t?(o.id=i.row.id,o.dataField=i.column.dataField):"ArrowRight"===t?(o.id=i.row.id,o.dataField=i.endColumn.dataField):"ArrowUp"===t?(o.id=i.row.id,o.dataField=i.column.dataField):"ArrowDown"===t&&(o.id=i.endRow.id,o.dataField=i.column.dataField)),l._selection.selectionRect&&e.shiftKey&&!e.ctrlKey?(l._selection.selectionRect.endRow&&(o.id=l._selection.selectionRect.endRow.id),l._selection.selectionRect.endColumn&&(o.dataField=l._selection.selectionRect.endColumn.dataField)):l.selection.allowRowSelection&&!l.selection.allowCellSelection&&void 0!==l._rangeSelectionEndRow&&(o.id=l._rangeSelectionEndRow.id),l._clipboardHandler(t,e),(e.ctrlKey&&"x"!==t&&"c"!==t&&"v"!==t&&"Control"!==t||"Tab"===t)&&(l._selection.rows=[],l._selection.columns=[],l._selection.cells=[]),"Escape"===t)return l.closeMenu(),l.cancelEdit(),void l._setSelection(o.id,o.dataField,e);if(!l.hasMenu()){if(e.altKey){if("ArrowDown"===t){const t=l.columnByDataField[o.dataField];t&&l.hasColumnMenu(t)&&(t.showActionButton=!0,t.onAction(),l.menu&&(l.menu.querySelector("smart-menu").focus(),l.menu.querySelector("smart-menu").$.dispatch(e)))}else"ArrowUp"===t&&l.closeMenu();if("s"===t.toLowerCase()){const e=l.columnByDataField[o.dataField];e&&(e.sorted?"asc"===e.sortOrder?l.sortBy(e.dataField,"desc"):l.sortBy(e.dataField,null):l.sortBy(e.dataField,"asc"))}if("g"===t.toLowerCase()){const e=l.columnByDataField[o.dataField];e&&(e.group=!e.group)}return}const d=function(t,n){requestAnimationFrame(()=>{"extended"!==l.selection.mode&&l._clearSelection(),l.beginUpdate(),l._setSelection(t,n,e),l.ensureVisible(t,n),l.endUpdate(!1),l._recycle()}),e.stopPropagation(),e.preventDefault()};switch(t){case"Tab":{const t=e.shiftKey?l.prevColumn(o.dataField):l.nextColumn(o.dataField);if(t)l._selection.focusedCell=l.rowById[o.id].getCell(t.dataField),l._setSelection(o.id,t.dataField,e),l.focus(),e.stopPropagation(),e.preventDefault();else{let t=e.shiftKey?l.prevRow(o.id):l.nextRow(o.id),n=e.shiftKey?l.lastColumn().dataField:l.firstColumn().dataField;if(l.editing.addNewRow.autoCreate&&!e.shiftKey&&o.id===l.lastRow().id&&(l.addUnboundRow(1),t=l.lastRow()),!t)return;e.shiftKey&&(l._selection.focusedCell=null),d(t.id,n)}break}case" ":case"F2":{const e=l.rowById[o.id];if(!e||l.editing.editCell)return;" "===t&&l.dataSource.boundHierarchy&&(e.checked=!e.checked),l.editing.enabled&&l._beginEdit(e,o.dataField);break}case"Delete":case"Backspace":{const e=l.rowById[o.id];if(!e||l.editing.editCell)return;const i=e.getCell(o.dataField),d=i.value;if(n.cells){l.beginUpdate();for(let e=0;e<n.cells.length;e++){const t=n.cells[e],o=l.rowById[t.id];if(o){const e=o.getCell(t.dataField);e.value=null}}l.endUpdate(!1),l._recycle()}"Backspace"===t&&(l._beginEdit(e,o.dataField),i.canNotify=!1,i.value=d,i.canNotify=!0);break}default:{if(l.editing.enabled&&!l.editing.editCell&&!e.ctrlKey&&!e.altKey){const e=l.rowById[o.id];if(!e)return;if(0<=["F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","Shift","Up","Down","Left","Right","Control","F2","Esc"," ","Home","End","PageUp","PageDown"].indexOf(t))return;l._beginEdit(e,o.dataField),setTimeout(function(){l.editing.editCell&&l.editing.editCell.editor.instance.setValue(t)},50)}break}case"Home":{const e=l.firstRow();if(!e)return;d(e.id,o.dataField);break}case"End":{const e=l.lastRow();if(!e)return;d(e.id,o.dataField);break}case"PageUp":{const e=l._recyclingRows,t=l.rowById[o.id],n=e.indexOf(t);for(let a=n;0<=a;a--){const n=e[a];if(t.top-n.top>=l.$.scrollView.offsetHeight)return void d(n.id,o.dataField)}d(l.firstRow().id,o.dataField);break}case"PageDown":{const e=l._recyclingRows,t=l.rowById[o.id],n=e.indexOf(t);for(let a=n;a<e.length;a++){const n=e[a];if(n.top-t.top>=l.$.scrollView.offsetHeight)return void d(n.id,o.dataField)}d(l.lastRow().id,o.dataField);break}case"ArrowDown":case"Enter":{let n=e.ctrlKey?l.lastRow():l.nextRow(o.id);if(l.editing.addNewRow.autoCreate&&"Enter"===t&&o.id===l.lastRow().id&&(l.addUnboundRow(1),n=l.lastRow()),!n)return;d(n.id,o.dataField);break}case"ArrowUp":{const t=e.ctrlKey?l.firstRow():l.prevRow(o.id);if(!t)return;d(t.id,o.dataField);break}case"ArrowRight":{const t=l.rowById[o.id];if(!1===t.leaf)if(!t.expanded)return void t.expand();else{const e=l.nextRow(o.id);if(e)return void d(e.id,o.dataField)}const n=e.ctrlKey?l.lastColumn():l.nextColumn(o.dataField);if(!n)return;d(o.id,n.dataField);break}case"ArrowLeft":{const t=l.rowById[o.id];if(!1===t.leaf)return void(t.expanded?t.collapse():t.parent&&d(t.parent.id,o.dataField));if(!0===t.leaf&&t.parent)return void d(t.parent.id,o.dataField);const n=e.ctrlKey?l.firstColumn():l.prevColumn(o.dataField);if(!n)return;d(o.id,n.dataField);break}}0>["Shift","Up","Down","Left","Right","Control","F2","Esc"," ","Home","End","PageUp","PageDown"].indexOf(t)||(e.stopPropagation(),e.preventDefault())}}}_keyUpHandler(){const e=this;!e._focused}firstRow(){const e=this,l=e._recyclingRows;if(l&&0<l.length){if(!l[0].autoGenerated)return l[0];for(let e=0;e<l.length;e++)if(!l[e].autoGenerated)return l[e]}return null}lastRow(){const e=this,l=e._recyclingRows;if(l&&0<l.length){const e=l[l.length-1];if(!e.autoGenerated)return e;for(let e=l.length-1;0<=e;e--)if(!l[e].autoGenerated)return l[e]}return null}nextRow(e){const l=this,t=l._recyclingRows,n=l.rowById[e],o=t.indexOf(n);return 0<=o&&t[o+1]&&!t[o+1].autoGenerated?t[o+1]:null}prevRow(e){const l=this,t=l._recyclingRows,n=l.rowById[e],o=t.indexOf(n);return 0<=o&&t[o-1]&&!t[o-1].autoGenerated?t[o-1]:null}firstColumn(){const e=this,l=e.columns;return l&&0<l.length?l[0]:null}lastColumn(){const e=this,l=e.columns;return l&&0<l.length?l[l.length-1]:null}nextColumn(e){const l=this,t=l.columns,n=l.columnByDataField[e],o=t.indexOf(n);return t[o+1]?t[o+1]:null}prevColumn(e){const l=this,t=l.columns,n=l.columnByDataField[e],o=t.indexOf(n);return t[o-1]?t[o-1]:null}isVisible(e,l){const t=this,n=t._scrollView.vScrollBar,o=t._scrollView.hScrollBar,i=t.rowById[e],d=t.columnByDataField[l],a=function(e){if(!e)return!1;const l=e.visibleIndex;return-1!==l&&!(e.top+e.height+o.offsetHeight+t.__frozenNearHeight>=t._scrollView.scrollTop+t.$.scrollView.offsetHeight-t.__frozenFarHeight)&&!(e.top<=t._scrollView.scrollTop)}(i),c=function(e){if(!l)return!1;const o=e.visibleIndex;return-1!==o&&!(e.left+e.computedWidth+n.offsetWidth>=t._scrollView.scrollLeft+t._clientSize.width)&&!(e.left<=t._scrollView.scrollLeft)}(d);return{row:a,column:c}}ensureVisible(e,l){const t=this,n=t._scrollView.vScrollBar,o=t._scrollView.hScrollBar,i=t.rowById[e],d=t.columnByDataField[l];(function(e){if(e){const l=e.visibleIndex;-1===l||(e.top+e.height+o.offsetHeight+t.__frozenNearHeight>=t._scrollView.scrollTop+t.$.scrollView.offsetHeight-t.__frozenFarHeight&&(t._scrollView.scrollTop=e.top+e.height),e.top<=t._scrollView.scrollTop&&(t._scrollView.scrollTop=e.top),0===l?t._scrollView.scrollTop=0:l===t.dataSource.length-1&&(t._scrollView.scrollTop=t._scrollView.scrollHeight))}})(i);(function(e){if(l){const l=e.visibleIndex;-1===l||(e.left+e.computedWidth+n.offsetWidth>=t._scrollView.scrollLeft+t._clientSize.width&&(t._scrollView.scrollLeft+=e.computedWidth),e.left<=t._scrollView.scrollLeft&&(t._scrollView.scrollLeft=e.left),0===l?t._scrollView.scrollLeft=0:l===t.columns.length-1&&(t._scrollView.scrollLeft=t._scrollView.scrollWidth))}})(d)}clearSelection(){const e=this;e._clearSelection(!0)}});